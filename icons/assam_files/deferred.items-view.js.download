(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([["deferred.items-view"],{1603:function(e,t,n){"use strict";n.r(t);n.d(t,"DropTargetHook",function(){return d});n.d(t,"DragSourceHook",function(){return v});n.d(t,"DragDropHook",function(){return b});var r=n(0),i=n("react-lib"),s=n(1332),o=n(1219),u=n(851),a=n(1460),f=n(4357),l=n(611),c=n(102),h=n(153),p=n(1443);var d=function(e){return i.createElement(s.e,null,i.createElement(o.e,Object(r.__assign)({},e)))};var v=function(e){var t=e.dragSourceKey,n=e.type,o=i.useState(),a=o[0],f=o[1],l=Object(h.e)(function(t){var n;e.hookCallback(t);f(null===(n=t.collectedProps)||void 0===n?void 0:n.isDragging)});return i.createElement(s.e,null,i.createElement(u.t,Object(r.__assign)({},e,{hookCallback:l})),e.showDefaultDragPreview||!a?null:i.createElement(u.e,{dragSourceKey:t,type:n},function(e){return i.createElement(y,{draggedItem:e.draggedItem,dropEffect:e.dropEffect})}))};function m(e){var t=e.resolve,n=Object(r.__rest)(e,["resolve"]);i.useEffect(function(){return function(){t()}},[]);return i.createElement(a.e,Object(r.__assign)({},n))}function g(e){var t,n,r=e.draggedItem,o=e.resolve;return i.createElement(s.e,null,i.createElement(u.e,{dragSourceKey:null===(t=r)||void 0===t?void 0:t.dragSourceKey,type:null===(n=r)||void 0===n?void 0:n.type,as:p.e,getItemStyles:p.n},function(e){return i.createElement(m,{draggedItem:e.draggedItem,dropEffect:e.dropEffect,resolve:o})}))}function y(e){var t=Object(l.i)({scope:"global"});i.useEffect(function(){if(e.draggedItem&&t){var n=new c.e,r=n.reject,s=n.resolve,o=n.promise,u=i.createElement(g,{draggedItem:e.draggedItem,reject:r,resolve:s});t.enqueue({content:u,promise:o,scope:"global"})}},[e.draggedItem]);return null}var b=i.memo(function(e){var t=e.dragDropKey,n=e.dragType,o=i.useState(),a=o[0],l=o[1],c=Object(h.e)(function(t){var n;e.hookCallback(t);l(null===(n=t.collectedDragProps)||void 0===n?void 0:n.isDragging)});return i.createElement(s.e,null,i.createElement(f.e,Object(r.__assign)({},e,{hookCallback:c})),e.showDefaultDragPreview||!a?null:i.createElement(u.e,{dragSourceKey:t,type:n},function(e){return i.createElement(y,{draggedItem:e.draggedItem,dropEffect:e.dropEffect})}))})},1661:function(e,t,n){"use strict";n.r(t);n.d(t,"ConfirmationDialog",function(){return c});var r=n("react-lib"),i=n(3489),s=n(2536),o=n(2855),u=n(1662),a=n(1161),f=n(2683),l=n(1701),c=function(e){var t=e.onConfirm,n=e.onCancel,c=e.defaultToYes,h=void 0!==c&&c,p=e.defaultFocusToYes,d=void 0!==p&&p,v=e.yesText,m=void 0===v?l.t:v,g=e.noText,y=void 0===g?l.e:g,b=function(e){e&&e.focus()},w=h?u.e:a.e,E=h?a.e:u.e,S=d?void 0:b,x=d?b:void 0;return r.createElement(f.e,null,r.createElement(i.e,{dialogContentProps:{type:s.e.close,subText:e.prompt?e.prompt:""},onDismiss:n,hidden:!1,title:e.title,maxWidth:e.maxWidth},r.createElement(o.e,null,r.createElement(w,{"data-automationid":"confirmbutton",onClick:t,componentRef:x},m),r.createElement(E,{"data-automationid":"cancelbutton",onClick:n,componentRef:S},y))))}},2627:function(e,t,n){"use strict";n.d(t,"r",function(){return r});n.d(t,"n",function(){return i});n.d(t,"e",function(){return s});n.d(t,"t",function(){return o});var r="root",i="me",s="/drive/root:",o=30},2628:function(e,t,n){"use strict";n.d(t,"e",function(){return P});n.d(t,"t",function(){return B});var r=n(0),i=n(135),s=n(5),o=n(9),u=n(113),a=n(1162),f=n(3410),l=n(3097),c=n(2863),h=n(643),p=n(1186),d=n(2348),v=n(149),m=n(59),g=n(849),y=n(3103),b=n(840),w=n(2883),E=n(3915),S=n(3914),x=n(3102),T=n(3412),N=n(3413),C=n(3411),k=n(243),L=n(3917),A=n(3916),O=n(1330),M=n(3586),_=n(3918),D=n(213);function P(e){var t=e.itemKey,n=e.driveItemKey,j=e.driveItem,F=e.endpoint,I=e.parentFolderItemKey,q=e.shouldReturnShareFacets,R=void 0===q||q,U=j.coverImage,z=j.file,W=j.fileSystemInfo,X=j.name,V=j.remoteItem,$=j.root,J=j.size,K=j.thumbnails,Q=j.image,G=j.video,Y=j.eTag,Z=j.tags,ee=j.photo,te=j.specialFolder;return function(e){var q,ne,re,ie,se,oe,ue,ae,fe,le,ce,he=j.lastModifiedDateTime,pe=void 0===he?W&&W.lastModifiedDateTime||V&&V.lastModifiedDateTime:he,de=j.createdDateTime||W&&W.createdDateTime||V&&V.createdDateTime,ve=Object(x.e)(j),me=null===(re=ve)||void 0===re?void 0:re.driveId,ge=null===(ie=ve)||void 0===ie?void 0:ie.driveType,ye="personal"===ge,be=W&&W.lastAccessedDateTime||V&&V.fileSystemInfo&&V.fileSystemInfo.lastAccessedDateTime,we=null===(se=ee)||void 0===se?void 0:se.takenDateTime,Ee=j.package||V&&V.package,Se=Object(S.e)(K)||Object(S.e)(null===(oe=V)||void 0===oe?void 0:oe.thumbnails),xe=Q||V&&V.image,Te=G||V&&V.video,Ne=j.shared||V&&V.shared,Ce={itemId:j.id,driveId:me,endpoint:F},ke=W&&W.systemPath,Le=n||V&&V.parentReference&&{itemId:V.id,driveId:V.parentReference.driveId,endpoint:F}||Ce,Ae=u.e.serialize(Le),Oe=j.webDavUrl||V&&V.webDavUrl;ce="business"!==ge&&"documentLibrary"!==ge&&"personal"!==ge||!$?X||V&&V.name||"":d.t;var Me=j.bundle||(null===(ue=V)||void 0===ue?void 0:ue.bundle),_e=j.folder||(null===(ae=V)||void 0===ae?void 0:ae.folder)||Me,De=null!=J?J:null===(fe=V)||void 0===fe?void 0:fe.size,Pe=null===(le=_e)||void 0===le?void 0:le.childCount,He=B(ce,!!_e),Be=He.extension||j.package&&j.package.type,je=Be&&Object(E.e)(Be),Fe=j.sharepointIds||V&&V.sharepointIds,Ie=j.localItem,qe=j.webUrl||V&&V.webUrl,Re=new D.e({publisher:P});Re.resolveItems({items:(q={},q[t]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},u.e.pack(Le)),s.h.pack(ce)),void 0!==De?s.v.pack(De):{}),s.m.pack(_e?{}:void 0)),qe?s.O.pack(qe):{}),b.n.pack(ke)),Oe?s.i.pack(decodeURIComponent(Oe)):{}),s.f.pack(pe?new Date(pe).getTime():void 0)),s.u.pack(de?new Date(de).getTime():void 0)),v.u.pack(we?new Date(we).getTime():void 0)),be?Object(r.__assign)({},s.o.pack(new Date(be).getTime())):{}),i.i.pack(Ee&&"oneNote"===Ee.type?{}:void 0)),Se?Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},f.e.pack(Se)),C.e.pack(!0)),A.e.pack(Object(O.t)(He.extension))):{}),Object(k.e)().forFacet(v.v).thenInvalidate(Ae,f.e).pack()),l.e.pack(j)),Y?s.p.pack(Y):{}),xe&&xe.width&&xe.height?v.a.pack({width:xe.width,height:xe.height}):{}),xe&&!Te?v.p.pack({}):{}),Te?v.g.pack({}):{}),o.t.pack({itemKey:a.e.serialize({driveItemKey:Le,sortBy:"",isAscending:!0})})),s.n.pack({itemKey:h.e.serialize({driveItemKey:Le})})),s.M.pack(I?{itemKey:I}:void 0)),!ye&&Oe?Object(r.__assign)({},s._.pack(H(Oe))):{}),g.e.pack(ge)),ye?Object(r.__assign)({},y.e.pack(j.vault)):{}),ye&&j.restricted?Object(r.__assign)({},M.e.pack(j.restricted)):{}),s.d.pack(He)),R?Object(r.__assign)(Object(r.__assign)({},s.x.pack(!!Ne)),p.e.pack(Ne)):{}),Ie?b.e.pack(Ie):{}),"number"==typeof Pe?m.e.pack(Pe):{}),L.e.pack(U)),_.e.pack(Z)),b.t.pack(z&&z.mimeType)),je?w.e.pack(je):{}),Fe?T.e.pack(Fe):{}),te?N.e.pack(te.name):{}),q)});Re.resolveItems({items:(ne={},ne[t]=Object(r.__assign)({},Me?c.e.pack(Me):{}),ne)});return{itemResolver:Re}}}function H(e){var t=e.split("/");return t.length>2?decodeURIComponent(t[t.length-2]):void 0}function B(e,t){var n=e.lastIndexOf(".");return t||n<0?{name:e,extension:""}:{name:e.substring(0,n),extension:e.substring(n)}}},2683:function(e,t,n){"use strict";n.d(t,"e",function(){return a});n.d(t,"t",function(){return f});var r=n("react-lib"),i=n(1289),s=n(141),o=n(100),u=0;function a(e){var t=e.isDefault,n=void 0!==t&&t,o=r.useState(""+ ++u)[0],a=r.useContext(i.e),f=r.useRef(),c=f.current||n&&a.keyboardManager||(f.current=new i.t({isDefault:!1,id:o,parent:a.keyboardManager})),h=l(c),p=h.isActive,d=h.isChildActive;r.useEffect(function(){return function(){if(!n){c.setIsActive(!1);c.dispose()}}},[]);var v=r.useMemo(function(){return{keyboardManager:c}},[c]);return r.createElement("div",{"data-keyboard-zone-id":o},r.createElement(i.e.Provider,{value:v},Object(s.t)(e.children,{isActive:p,isChildActive:d})))}function f(){return l(r.useContext(i.e).keyboardManager)}function l(e){var t=r.useState(function(){return e.getIsActive()}),n=t[0],i=t[1],s=r.useState(function(){return e.hasActiveChildren()}),u=s[0],a=s[1];r.useEffect(function(){var t=new o.e(null);t.on(e,"change",function(){i(e.getIsActive());a(e.hasActiveChildren())});return function(){t.dispose()}},[]);return{isActive:n,isChildActive:u}}},2768:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(353),i=Object(r.e)(function(e){return{}})},2862:function(e,t,n){"use strict";n.d(t,"t",function(){return i});n.d(t,"e",function(){return s});var r=n(6),i=new r.e("uploadProgress",{sourceEntryKey:Object(r.s)()});function s(e){return i.serialize({sourceEntryKey:e})}},2863:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("bundle")},2883:function(e,t,n){"use strict";n.d(t,"e",function(){return i});n.d(t,"t",function(){return s});var r=n(2),i=new r.e("officeApp"),s=new r.e("officeLens")},3034:function(e,t,n){"use strict";n.d(t,"e",function(){return y});var r=n(201),i=n("react-lib"),s=n(1470),o=n(5),u=n(18),a=n(554),f=n(158),l=n(203);var c=n(218),h=n(74),p=n(926),d=n(927),v=n(905),m=n(906),g=n(903),y=Object(p.e)({key:c.s,name:r.f,fieldName:"",isCollapsible:!1,minWidth:445,maxWidth:445,sortProps:h.r},[d.e,g.e,function(e,t){var n=t.itemKey,r=t.renderer,c=e.demandItemFacet(o.M,n),h=c&&e.demandItemFacet(o.O,c.itemKey)||"",p=h?(function(e){for(var t=[],n=new f.e(e),r=0,i=n.segments.slice(1);r<i.length;r++){var s=i[r];try{t.push(decodeURIComponent(s))}catch(e){t.push(s)}}return t})(h):[],d=c&&h?Object(l.r)(e,i.createElement(a.e,{itemKey:c.itemKey})):null;return{renderer:function(e,t,n){var o=r?r(e,t,n):null;return i.createElement(i.Fragment,null,o?i.createElement(i.Fragment,{key:"content"},o):null,d?i.createElement(u.n,{key:"path",action:d},function(e){var t=e.execute,n=e.isAvailable?function(e){t({event:e}).catch(function(){});e.preventDefault();e.stopPropagation()}:void 0;return i.createElement(s.e,{displayPathSegments:p,parentLink:h,onClick:n})}):null)}}},v.e,m.e])},3097:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("driveItemResponse")},3102:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(36);function i(e){var t;return r.t.isActivated("70112978-C401-4C01-AC5E-CFB577601CD6","","")?e.parentReference:(null===(t=e.remoteItem)||void 0===t?void 0:t.parentReference)||e.parentReference}},3103:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("vault")},3104:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(6),i=new r.e("userByEmail",{email:Object(r.s)(),endpoint:Object(r.s)()})},3105:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(20).e)("itemsViewSearchControl")},3106:function(e,t,n){"use strict";n.r(t);n.d(t,"sharePointItemByFullUrlAddon",function(){return O});var r=n(0),i=n(12),s=n(262),o=n(213),u=n(158),a=n(281),f=n(520),l=n(931),c=n(1514),h=n(104),p=n(126),d=n(321),v=n(717),m=n(55),g=n(92),y=n(1),b=n(5),w=n(9),E=n(315),S=n(317),x=n(386),T=n(108),N=n(228),C=n(562),k=n(367),L=n(419),A=n(475),O=Object(i.t)(function(){return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(t){e(Object(p.t)({keyFacet:c.e,facets:[m.e,b.h,b.d,y.Tn,b.m,y.pe,w.t,y.Ge,N.e,N.t,y.dt,b.i]}));e(Object(s.r)(c.e,d.e)(Object(i.i)({maxParallelOperationCount:8})(M)));return[2]})})}});function M(e){var t=this,n=e.itemKey,i=c.e.deserialize(n);return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,s,p,d,b,N,O,_,D,P,H,B,j,F,I,q,R,U,z,W,X;return Object(r.__generator)(this,function(V){switch(V.label){case 0:t=new o.e({publisher:M});s=!1;p=new u.e(i.itemFullUrl);d=e((function(e,t,n){return function(r){var i,s=e.itemFullUrl,o=["File_x0020_Type","FileRef","FileLeafRef","_ip_UnifiedCompliancePolicyUIAction","_ComplianceFlags","CheckoutUser","CheckedOutUserId","Created_x0020_Date.ifnew"];i=[new u.e(s).path];var a=r(Object(T.e)({contentTypeId:y.p},c.e.serialize(e)));if(t&&t.length>0&&a&&a.contentTypeId)for(var f=0,l=t;f<l.length;f++){var h=l[f];if(h.contentTypeId===a.contentTypeId&&h.Fields)for(var p=0,d=h.Fields.split(",");p<d.length;p++){var v=d[p];"Modified_x0020_By"===v?o.push("Editor"):"Created_x0020_By"===v?o.push("Author"):o.push(v)}}var m=Object(x.r)({itemRefs:i,recurseInFolders:!0,pageSize:1,fieldNames:o});return{webAbsoluteUrl:"",listFullUrl:s,currentPageContext:void 0,qosName:n,viewXml:m,rootFolder:void 0,postDataContext:{needUpdatePageContext:!0,needsSchema:!0}}}})(i,void 0,"getSPItemByFullUrl"));V.label=1;case 1:V.trys.push([1,3,,4]);return[4,e(Object(E.e)({getItemContext:d}))];case 2:b=V.sent();N=b.WebUrl||v.i(decodeURIComponent(b.HttpRoot||""))||p.authority;O=""+new u.e(N).authority+(b.ListUrl||decodeURIComponent(b.listUrlDir||""));_={webAbsoluteUrl:N,listFullUrl:O,rootFolder:""};D=e(Object(S.t)({serverData:b,itemSetKey:_,currentPageContext:d.currentPageContext,contentTypes:void 0,isItemSetRequest:s})),P=D.itemResolver,H=D.childKeys,B=D.pageContext;j=H[0];F=g.e.serialize(_);j&&t.mapKeys({mappings:(W={},W[j]=c.e.serialize(i),W)});B&&e(Object(f.t)({pageContext:B,spPageContextKey:{webAbsoluteUrl:N,listFullUrl:O}}));t.merge(P);if(m.e.matches(j)){I=m.e.deserialize(j);(q=e(Object(C.t)({webAbsoluteUrl:I.webAbsoluteUrl,listFullUrl:I.listFullUrl,serverData:b,pageContext:B})))&&t.merge(q.itemResolver)}R=h.e.serialize({webAbsoluteUrl:N,listFullUrl:O});t.resolveItems({items:(X={},X[m.e.serialize(_)]=Object(r.__assign)({},w.t.pack({itemKey:F})),X[n]=Object(r.__assign)({},a.n.pack(m.e)),X[R]=Object(r.__assign)({},Object(l.e)(b,B)),X)});e(t.execute());e(Object(k.e)({itemSetKey:F,serverData:b,isItemSetRequest:s}));return[3,4];case 3:U=V.sent();z=Object(A.e)(U);throw new L.e({facets:z,innerError:U});case 4:return[2]}})})}}},3125:function(e,t,n){"use strict";n.r(t);n.d(t,"ItemSwitchViewAction",function(){return b});n.d(t,"SwitchViewExecutor",function(){return w});var r=n(0),i=n("react-lib"),s=n(14),o=n(22),u=n(126),a=n(9),f=n(55),l=n(92),c=n(249),h=n(1),p=n(263),d=n(18),v=n(363),m=n(880),g=n(29),y=n(41),b=Object(y.t)(function(e,t){var n=t.itemKey,s=t.itemSetKey,y=t.viewId,b=t.currentDerivedView,w=e.demandItemFacet(f.e,n);if(!w)return null;var E=w.webAbsoluteUrl,S=w.listFullUrl,x=e.demandItemFacet(l.e,s),T=l.e.serialize({webAbsoluteUrl:E,listFullUrl:S,rootFolder:x&&x.rootFolder||"",viewKey:{viewId:y}}),N=b&&c.e.serialize({viewId:b.id}),C=e.isItemFacetResolved(h._t,N)?e.demandItemFacet(h._t,N):void 0,k=Object(g.t)(e,{itemKey:n,engagement:{name:"SwitchView",isIntentional:!0}}),L=e.dispatch,A=Object(d.i)(e,i.createElement(v.e,{itemKey:T}));return i.createElement(d.n,{action:A},function(e){var t=e.isAvailable,s=e.execute;return i.createElement(o.e,Object(r.__assign)({isAvailable:t,isToggled:b?y===b.id:""===y,onExecute:function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var t,i,o;return Object(r.__generator)(this,function(f){switch(f.label){case 0:L(Object(u.e)({items:Object(r.__assign)(Object(r.__assign)({},N?(t={},t[N]=Object(r.__assign)(Object(r.__assign)({},h.Ht.pack(!1)),C&&b&&b.isDirty()?Object(r.__assign)({},h.v.pack(new p.e(C))):{}),t):{}),n?(i={},i[T]=Object(r.__assign)({},a.s.pack({itemKey:n})),i):{})}));N&&b&&b.isDirty()&&L(Object(m.e)({items:(o={},o[N]=[h._t,h.v],o)}));return[4,s(e)];case 1:f.sent();return[2]}})})}},k))})}),w=Object(s.e)()(b)},3378:function(e,t,n){"use strict";n.d(t,"t",function(){return i});n.d(t,"e",function(){return s});var r=n(20),i=new r.e("progressListGroupControl",{}),s=new r.e("progressListControl",{groupControlHandler:Object(r.n)(i)})},3392:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("thumbnailAccessToken")},3410:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("graphThumbnailSet")},3411:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("hasThumbnailAuthTokenFacet")},3412:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("sharepointIds")},3413:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("specialFolder")},3418:function(e,t,n){"use strict";n.r(t);n.d(t,"hasManageListsPermission",function(){return m});n.d(t,"modifyColumn",function(){return g});var r=n(0),i=n(92),s=n(249),o=n(1640),u=n(12),a=n(108),f=n(1),l=n(9),c=n(213),h=n(118),p=n(1151),d=n(85),v=n(104);function m(e,t){var n=t.itemSetKey;if(n){var r=e.demandItemFacet(f.Ue,v.e.serialize({webAbsoluteUrl:n.webAbsoluteUrl,listFullUrl:n.listFullUrl}));return!!(r&&r.permissions&&r.permissions.manageLists)}return!1}var g=Object(u.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options.columnModifyTypeMap;return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var u,v,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_;return Object(r.__generator)(this,function(D){switch(D.label){case 0:if(!(u=e(Object(a.e)({setKey:i.e},t)).setKey))return[3,3];v=Object.keys(n)[0];g=n[v],y=g.modifyType,b=g.targetIndex;if(!(w=u.viewKey?s.e.serialize(u.viewKey):void 0))return[3,3];if(!(E=e(Object(a.e)({currentDerivedView:f.v},w)).currentDerivedView))return[3,3];S=E.getEffectiveFieldNames();if(!(x=e(Object(a.e)({internalName:f.Te},v)).internalName))return[3,3];if((T=S.indexOf(x))<0||1===y&&0===T||2===y&&T===S.length-1)return[2];N=E.isDirty();switch(y){case 0:E.updateField(x);break;case 1:E.updateField(x,T-1);break;case 2:E.updateField(x,T+1);break;case 3:E.updateField(x,b)}C=e(Object(h.e)(function(e){return m(e,{itemSetKey:u})}));k=!1;return C?[4,e(Object(p.e)({items:(A={},A[o.e.serialize({webAbsoluteUrl:u.webAbsoluteUrl,listFullUrl:u.listFullUrl})]={views:(O={},O[w]={shouldSaveViewFieldsOnly:!0},O),qosName:"autoSaveModifyColumn"},A)})).then(function(){N||(E.baseViewXml=E.getEffectiveViewXml());k=!0},function(e){d.e.logError(e,{eventName:"ModifyColumn",feature:"ColumnFieldsAutoSave",columnFieldName:x,modifyType:y,errorCode:e.errorData.code,correlationId:e.errorData.correlationId,status:e.errorData.status});throw e})]:[3,2];case 1:D.sent();D.label=2;case 2:L=new c.e;k||L.resolveItems({items:(M={},M[w]=Object(r.__assign)({},f.Ht.pack(!0)),M)});L.invalidateItems({items:(_={},_[t]=[l.e],_[w]=[f.v],_)});e(L.execute());D.label=3;case 3:return[2]}})})}})},3538:function(e,t,n){"use strict";n.d(t,"e",function(){return c});var r=n(0),i=n(72),s=n(9),o=n(92),u=n(294),a=n(53),f=n(389),l=n(52);var c=Object(i.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([584],4015)];case 1:return[2,e.sent().SortActionExecutor]}})})},function(e,t){var n=t.sortFieldKey,i=t.itemSetKey,s=t.isAscending,u=e.demandItemFacet(o.e,i);if(!u)return!1;var c=Object(a.e)(e).itemsScopeItemKey;if(!c)return!1;var h=o.e.serialize(Object(r.__assign)(Object(r.__assign)({},u),{sortFieldKey:n,sortAscending:s})),p=e.demandItemFacet(f.e,h),d=f.e.evaluate(p)(e,{itemKey:h,itemsScopeItemKey:c,isAvailable:!0}),v=d.itemKey;if(!d.isAvailable)return!1;var m=e.demandItemFacet(l.n,c),g=m&&m.itemKey;return!!v&&v!==g},function(e,t){var n=t.sortFieldKey,r=t.itemSetKey,i=t.isAscending,a=e.demandItemFacet(o.e,r);if(!a)return!1;var f=e.demandItemFacet(s.u,r),l=f&&e.demandItemFacet(u.e,f.columnKey),c=l&&l.internalName||a.sortFieldKey,h=f?f.isAscending:a.sortAscending;return c===n&&h===i})},3585:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=n(212).e.isFeatureEnabled({ODC:"EnableDefaultSortOrderFromBackend"})},3586:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("restricted")},3600:function(e,t,n){"use strict";n.r(t);n.d(t,"CreateViewAction",function(){return w});var r=n(0),i=n("react-lib"),s=n(41),o=n(92),u=n(104),a=n(403),f=n(1),l=n(42),c=n(1081),h=n(29),p=n(18),d=n(22),v=n(80),m=n(53),g=n(459),y=n(558),b=Object(v.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee(66,4175)];case 1:return[2,e.sent().FreshViewCreator]}})})}),w=Object(s.t)(function(e,t){var n,s=t.isEditing,v=t.currentViewKey,w=Object(l.e)(e),E=Object(m.e)(e).itemsScopeItemKey,S=e.demandItemFacet(o.e,w),x=e.demandItemFacet(c.e,w),T=e.demandItemFacet(f.v,v),N=c.e.evaluate(x)(e,{viewKey:v}).onViewSaved;if(!w||!E)return null;var C=!1;if(S&&T){var k=u.e.serialize({webAbsoluteUrl:S.webAbsoluteUrl,listFullUrl:S.listFullUrl}),L=e.demandItemFacet(f.Ue,k);C=!!(L&&T&&"POWER"!==T.viewType&&L.permissions&&(L.permissions.managePersonalViews||L.permissions.manageLists))}var A=S?e.demandItemFacet(f.hn,a.e.serialize({webAbsoluteUrl:S.webAbsoluteUrl,listFullUrl:S.listFullUrl})):void 0,O=Object(y.t)(e,{mapping:{fieldData:f.ue},itemSetKey:w}).map(function(e){return e.fieldData}),M=e.demandItemFacet(f.ve,w),_=Number(null===(n=M)||void 0===n?void 0:n.ListTemplateType),D=Object(p.o)(function(e){return i.createElement(g.e,{itemsScopeItemKey:E},i.createElement(b,Object(r.__assign)({},e,t,{pageContext:A,itemSetKey:w,currentViewFields:O,listTemplateType:_,onViewSaved:N})))},{scope:"global"});return i.createElement(d.e,Object(r.__assign)({isAvailable:C,onExecute:D},Object(h.t)(e,{itemKey:w,engagement:{name:s?"EditView":"CreateNewView",isIntentional:!0}})))})},3827:function(e,t,n){"use strict";n.d(t,"e",function(){return v});var r=n(0),i=n("react-lib"),s=n(92),o=n(249),u=n(41),a=n(156),f=n(22),l=n(18),c=n(29),h=new(n(20).e)("filterActionControl"),p=n(80),d=Object(p.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([581,"deferred.odsp-common","deferred.odsp-datasources","ondemand.resx-ondemand"],4931)];case 1:return[2,e.sent().FilterPanel]}})})}),v=Object(u.t)(function(e,t){var n=t.columnKey,u=t.itemSetKey,p=t.isToggled,v=e.demandItemFacet(h,u),m=e.demandItemFacet(s.e,u),g=m&&m.viewKey&&o.e.serialize(m.viewKey),y=h.evaluate(v)(e,{viewKey:g,isAvailable:!0}).isAvailable,b=Object(l.o)(function(e){return i.createElement(d,{onClose:function(){e.reject(new a.e)},onComplete:function(){e.resolve()},columnKey:n,itemSetKey:u})});return i.createElement(f.e,Object(r.__assign)({isAvailable:y,isToggled:p,onExecute:b},Object(c.t)(e,{itemKey:u,engagement:{name:"LaunchFilterPanel",isIntentional:!0}})))})},3860:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(20).e)("itemAutoRefreshControl")},3865:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(20).e)("openSyncIssuesActionControl")},3914:function(e,t,n){"use strict";n.d(t,"e",function(){return r});function r(e){return Array.isArray(e)?e.length?e:void 0:e||void 0}},3915:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(628),i=function(e){var t=e.replace(".",""),n=Object.keys(r.e);for(var i in n)if(r.e.hasOwnProperty(n[i])){var s=n[i];if(r.e[s].indexOf(t)>-1)return s}}},3916:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("hasPdfFacet")},3917:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("coverImage")},3918:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("tags")},3919:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r,i;(function(e){e[e.MalwareDetected=0]="MalwareDetected";e[e.ThisFileIsCheckedOut=1]="ThisFileIsCheckedOut";e[e.DLPBlocked=2]="DLPBlocked";e[e.MissingMetaData=3]="MissingMetaData";e[e.DLPWarning=4]="DLPWarning";e[e.AwaitingApproval=5]="AwaitingApproval";e[e.Trending=6]="Trending";e[e.New=7]="New";e[e.NeedsRepublishing=8]="NeedsRepublishing"})(r||(r={}));(function(e){e[e.Mail=0]="Mail";e[e.CalendarEvent=1]="CalendarEvent";e[e.Teams=2]="Teams"})(i||(i={}))},3923:function(e,t,n){"use strict";n.d(t,"e",function(){return b});var r=n(0),i=n("react-lib"),s=n(41),o=n(29),u=n(22),a=n(14),f=n(155),l=n(200),c=n(2768),h=n(100),p=n(2767),d=n(45),v=n(44),m={ODB:1024},g=function(e){var t=e.undoRedoActionType,n=e.dispatch,s=e.isAvailable,o=i.useState(0),a=o[0],f=o[1],l=i.useState(0),d=l[0],v=l[1],m=i.useRef(new h.e({})),g=s&&("undo"===t&&a>0||"redo"===t&&d>0);i.useEffect(function(){var e=n(c.e);m.current.on(e,p.e.undoRealCmdCountChangeEventName,function(e){f(e.undoRealCmdCount)});m.current.on(e,p.e.redoRealCmdCountChangeEventName,function(e){v(e.redoRealCmdCount)});return function(){m.current.dispose()}},[]);return i.createElement(u.e,Object(r.__assign)({},e,{isAvailable:g}))},y=Object(s.t)(function(e,t){var n=t.itemKey,s=t.undoRedoActionType,u="undo"===s,a=Object(v.e)(e,n),y=Object(d.e)(e,{feature:m,pageContext:a});if(y){y=Object(f.e)(e)===l.e}var b=e.dispatch;return i.createElement(g,Object(r.__assign)({undoRedoActionType:s,dispatch:b,isAvailable:y,onExecute:function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var e;return Object(r.__generator)(this,function(t){e=b(c.e);h.e.raise(e,u?p.e.undoChangeEventName:p.e.redoChangeEventName);return[2]})})}},Object(o.t)(e,{itemKey:n,engagement:{name:u?"QuickEditUndoAction":"QuickEditRedoAction",isIntentional:!0}})))}),b=Object(a.n)()(y)},3924:function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n(0),i=n("react-lib"),s=n(22),o=n(41),u=Object(o.t)(function(e,t){return i.createElement(s.e,{onExecute:function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var e;return Object(r.__generator)(this,function(n){e=null;t.selector?e=document.querySelector(t.selector):t.elementId&&(e=document.getElementById(t.elementId));if(e){e.focus();t.shouldClick&&e.click&&e.click()}return[2]})})},engagement:{name:"SetFocus",isIntentional:!0}})})},3926:function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n("react-lib"),i=n(57),s=n(62),o=n(3928),u={key:n(3927).e,automationId:"launchMovePickerCommand",name:i.m,ariaLabel:i.m,action:r.createElement(s.t,null,r.createElement(o.t,null)),iconProps:{iconName:"FabricMoveToFolder"}}},3927:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(2),i=Object(r.t)("launchMovePickerCommand")},3928:function(e,t,n){"use strict";n.d(t,"t",function(){return g});n.d(t,"e",function(){return y});var r=n(0),i=n("react-lib"),s=n(14),o=n(22),u=n(18),a=n(41),f=n(144),l=n(68),c=n(80),h=n(29),p=n(883),d=Object(l.e)()(Object(c.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee(4,4531)];case 1:return[2,e.sent().LaunchMoveCopyPickerWizard]}})})})),v=Object(a.t)(function(e,t){var n=t.itemKeys,s=t.isMove,a=void 0!==s&&s;if(0===n.length)return null;var l=Object(f.e)(e);if(!l)return null;var c=e.demandItemFacet(p.e,n[0]),v=p.e.evaluate(c)(e,{entryItemKey:l,sourceItemKeys:n,isMove:a,isAvailable:!1,moveCopyPickerWizard:d}),m=v.isAvailable,g=v.moveCopyPickerWizard;if(!m||!g)return null;var y=Object(u.o)(function(e){return i.createElement(g,Object(r.__assign)({isMove:a,entryItemKey:l,sourceItemKeys:n},e))},{scope:"global"});return i.createElement(o.e,Object(r.__assign)({onExecute:y},Object(h.t)(e,{itemKey:n[0],engagement:{name:a?"MoveTo":"CopyTo"}})))}),m=Object(s.s)()(v),g=Object(a.e)(function(){return{isMove:!0}})(m),y=Object(a.e)(function(){return{isMove:!1}})(m)},3929:function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n("react-lib"),i=n(57),s=n(62),o=n(3928),u={key:n(3930).e,automationId:"launchCopyPickerCommand",name:i.t,ariaLabel:i.t,action:r.createElement(s.t,null,r.createElement(o.e,null)),iconProps:{iconName:"Copy"}}},3930:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(2),i=Object(r.t)("launchCopyPickerCommand")},3938:function(e,t,n){"use strict";n.r(t);n.d(t,"GroupByActionExecutor",function(){return y});var r=n(0),i=n("react-lib"),s=n(92),o=n(55),u=n(249),a=n(22),f=n(9),l=n(1),c=n(363),h=n(18),p=n(29),d=n(41),v=n(203),m=n(213),g=n(2150),y=Object(d.t)(function(e,t){var n=t.groupByFieldKey,d=t.itemSetKey,y=e.demandItemFacet(s.e,d);if(!y)return i.createElement(h.n,null);var b=e.demandItemFacet(l.y,d),w=!y.groupByFieldKey&&!!b&&-1!==b.indexOf(n),E=y.groupByFieldKey===n||w,S=s.e.serialize(Object(r.__assign)(Object(r.__assign)({},y),{groupByFieldKey:E?void 0:n})),x=o.e.serialize(y),T=y.viewKey&&u.e.serialize(y.viewKey),N=e.demandItemFacet(l.v,T),C=Object(p.t)(e,{itemKey:d,engagement:{name:"GroupBy",isIntentional:!0}}),k=e.dispatch,L=Object(v.r)(e,i.createElement(c.e,{itemKey:S}));return i.createElement(h.n,{action:L},function(e){var t=e.execute,s=function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var i,o,u,a,c,h,p,d;return Object(r.__generator)(this,function(v){switch(v.label){case 0:i=new m.e({publisher:s});if(T&&w&&N&&(o=N.getDomParts())&&o.groupBy){u=Object(g.n)(o.groupBy);a=void 0;u.group1.fieldName===n?u.group2&&(a={isCollapsed:u.isCollapsed,group1:u.group2}):(null===(d=u.group2)||void 0===d?void 0:d.fieldName)===n&&(a={isCollapsed:u.isCollapsed,group1:u.group1});N.updateGroupBy(a);i.invalidateItems({items:(c={},c[S]=[f.e],c[T]=[l.v],c)})}i.resolveItems({items:Object(r.__assign)((h={},h[S]=Object(r.__assign)({},f.s.pack({itemKey:x})),h),T?(p={},p[T]=Object(r.__assign)({},l.Ht.pack(!0)),p):{})});k(i.execute());return[4,t(e)];case 1:v.sent();return[2]}})})};return i.createElement(a.e,Object(r.__assign)({onExecute:s},C))})})},3940:function(e,t,n){"use strict";n.d(t,"t",function(){return r});n.d(t,"n",function(){return i});n.d(t,"r",function(){return s});n.d(t,"i",function(){return o});n.d(t,"s",function(){return u});n.d(t,"e",function(){return a});var r="socialBarList_36611a00",i="socialBarPanel_36611a00",s="socialBarPanelContent_36611a00",o="socialBarPanelPersona_36611a00",u="socialBarPanelPersonaDescription_36611a00",a="analyticsStatsLink_36611a00"},4170:function(e,t,n){"use strict";n.d(t,"e",function(){return p});var r=n(12),i=n(379),s=n(55),o=n(0),u=n("react-lib"),a=n(8),f=n(80),l=Object(f.e)(function(){return Object(o.__awaiter)(void 0,void 0,void 0,function(){return Object(o.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([37,"deferred.odsp-datasources","ondemand.resx-ondemand"],3457)];case 1:return[2,e.sent().PropertiesForm]}})})}),c=Object(a.t)()(function(){return function(e){return function(e,t){return{getPropertiesForm:function(e){return u.createElement(l,Object(o.__assign)({},e))}}}}});var h=n(1078),p=Object(r.t)(function(){return function(e){e(Object(i.e)(s.e,h.e)(c))}})},4172:function(e,t,n){"use strict";n.d(t,"e",function(){return l});var r=n(0),i=n("react-lib"),s=n(1673),o=n(3489),u=n(2536),a=n(1664),f=n(416),l=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._onClose=function(){n.setState({isOpen:!1})};n._iframeOnLoad=function(){var e=n.props.heightOffset;if(n._iframeElement&&n._iframeElement.contentDocument){var t=n._iframeElement.contentDocument.body.clientHeight;t<=0&&e&&(t=document.body.clientHeight*e);n._iframeElement.style.height=t+"px"}n.setState({isIFrameLoaded:!0});n.props.onLoad&&n._iframeElement&&n.props.onLoad(n._iframeElement)};n.state={isOpen:!0,isIFrameLoaded:!1};return n}t.prototype.UNSAFE_componentWillReceiveProps=function(e){this.setState({isIFrameLoaded:!1})};t.prototype.render=function(){var e=this,t=this.props,n=t.url,l=(t.heightOffset,Object(r.__rest)(t,["url","heightOffset"])),c=this.state.isIFrameLoaded;return i.createElement(o.e,Object(r.__assign)({className:"IFrameDialog_d45656a1",hidden:!this.state.isOpen,type:u.e.close},l),i.createElement(s.e,null,!c&&i.createElement(a.e,{size:f.e.large}),i.createElement("iframe",{ref:function(t){return e._setupIFrameElementFunctions(t)},src:n,style:{display:c?"block":"none"},onLoad:this._iframeOnLoad})))};t.prototype._setupIFrameElementFunctions=function(e){if(e){var t=e;t.cancelPopUp=this._onClose;t.commitPopup=this._onClose}this._iframeElement=e};return t})(i.Component)},4305:function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n("react-lib"),i=n(274),s=n(2),o=n(3924),u={key:new s.e("GetNPSSurveyFocusShortcut").id,automationId:"GetNPSSurveyFocusShortcut",shortcutProps:{keySequences:["AltDown"],content:i.o},action:r.createElement(o.e,{elementId:"obf-TPromptContainer"})}},4529:function(e,t,n){"use strict";n.r(t);n.d(t,"OpenAsHyperLinkExecutor",function(){return u});n.d(t,"OpenAsShortcutExecutor",function(){return a});n.d(t,"NewItemInOfficeClientAction",function(){return f.t});n.d(t,"ItemOpenInOfficeClientAction",function(){return f.e});n.d(t,"OpenInOfficeClientAction",function(){return f.n});n.d(t,"ItemOpenInOfficeOnlineAction",function(){return l.e});n.d(t,"OpenInOfficeOnlineAction",function(){return l.t});n.d(t,"OpenInBFileAction",function(){return x});n.d(t,"ItemSwitchViewAction",function(){return T.ItemSwitchViewAction});n.d(t,"SwitchViewExecutor",function(){return T.SwitchViewExecutor});n.d(t,"SetDefaultViewAction",function(){return N.e});n.d(t,"ViewCreator",function(){return ce});n.d(t,"LaunchFilterPanelAction",function(){return pe.e});n.d(t,"SortAction",function(){return de.e});n.d(t,"GroupByAction",function(){return be});n.d(t,"GroupByActionExecutor",function(){return we.GroupByActionExecutor});n.d(t,"ModifyColumnAction",function(){return Ne});n.d(t,"ModifyColumnAggregateTypeAction",function(){return Le});n.d(t,"ApproveRejectAction",function(){return Ae.e});n.d(t,"ItemFileHandlerOpenAction",function(){return Oe.t});n.d(t,"FileHandlerOpenAction",function(){return Oe.e});var r,i=n(0),s=n("react-lib"),o=n(4172),u=(function(e){Object(i.__extends)(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._onDismiss=function(){t.props.resolve()};return t}t.prototype.render=function(){var e=this.props,t=e.title,n=e.linkLocation,r=e.launchBehaviorType;if(n&&void 0!==r){if("dialog"===r)return s.createElement(o.e,{url:n,heightOffset:.7,dialogContentProps:{title:t},onDismiss:this._onDismiss});"inPageNavigation"===r?window.open(n,"_self"):window.open(n,"_blank")}this.props.resolve();return null};return t})(s.PureComponent),a=(function(e){Object(i.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props.targetUrl;e&&window.open(e,"_blank");this.props.resolve();return null};return t})(s.PureComponent),f=n(876),l=n(890),c=n(41),h=n(22),p=n(29),d=n(55),v=n(104),m=n(1),g=n(577),y=n(5),b=n(919),w=n(113),E=n(36),S=n(44),x=Object(c.e)(function(e,t){var n,r,s,o=t.itemKey,u=e.demandItem({key:d.e,itemUrl:y.I,driveItem:w.e,fileName:y.d},o),a=u.key,f=u.itemUrl,l=u.driveItem,c=u.fileName,h=Object(S.e)(e,o),x="",T="",N="",C=!1;if(E.t.isActivated("3deefa50-273b-494f-81c7-72a6f9f4876a","09/21/2021","Use drive item to get driveId and itemId")&&a&&f){var k=v.e.serialize({webAbsoluteUrl:a.webAbsoluteUrl,listFullUrl:a.listFullUrl}),L=e.demandItem({driveUrl:m.S},k).driveUrl;if(L){var A=Object(g.e)(L);if(A){x=A.driveId||"";if(c){N=c.extension;(A=Object(g.e)(f))&&(C=!!(T=A.itemId||""))}}}}else if(l){x=l.driveId||"";C=!!(T=l.itemId||"");N=(null===(n=c)||void 0===n?void 0:n.extension)||""}var O,M=a?Object(b.e)("spo:"+a.webAbsoluteUrl):void 0,_=encodeURIComponent(null!=M?M:""),D=encodeURIComponent(x),P=encodeURIComponent(T),H=N.toLowerCase();if(".note"===H)O="https://www.onenote.com/meetingnotes/"+_+"/"+D+"/"+P;else if(".whiteboard"===H)if(!E.t.isActivated("A1AE7AB1-F5D8-49BE-AB01-4CC90527BADD","09/12/2021","Whiteboard GCCH support")&&h){var B="https://whiteboard.office.com";"gcch"===(null===(r=h)||void 0===r?void 0:r.cloudType)?B="https://whiteboard.office365.us":"dod"===(null===(s=h)||void 0===s?void 0:s.cloudType)&&(B="https://whiteboard.apps.mil");O=B+"/me/whiteboards/p/"+_+"/"+D+"/"+P}else O="https://whiteboard.office.com/me/whiteboards/p/"+_+"/"+D+"/"+P;else{var j=e.demandItemFacet(y.i,o)||"",F=a?a.webAbsoluteUrl:"";O="https://www.office.com/launch/fluid/content?drive="+x+"&item="+T+"&file="+encodeURIComponent(j)+"&siteUrl="+encodeURIComponent(F)}return Object(i.__assign)({isAvailable:C,onExecute:C?function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){window.open(O);return[2]})})}:void 0},Object(p.t)(e,{itemKey:o,engagement:{name:"OpenInBFile",isIntentional:!0}}))})(h.e),T=n(3125),N=n(1327),C=n(1416),k=n(156),L=n(1272),A=n(3419),O=n(16),M=n(378),_=n(108),D=n(269),P=n(92),H=n(249),B=n(80),j=n(153),F=n(252),I=n(53),q=n(9),R=n(1151),U=n(780),z=n(12),W=n(379),X=n(8),V=n(312),$=n(458),J=n(96),K=n(65),Q=new(n(260).e)("saveView",function(e,t){return Object.keys(t.views)[0]}),G=((r={})[K.r.started]=A.a,r[K.r.completed]=A.o,r[K.r.failed]=A.u,r),Y=Object(z.t)(function(){return function(e){e(Object(W.e)(Q,$.e)(Object(X.t)()(Z)));e(Object(W.e)(Q,V.n)(Object(X.t)()(te)))}});function Z(){return function(e){return ee}}function ee(e,t){var n,r=t.itemKey,s=t.format,o=Object(J.r)(e,t).phase,u=void 0,a=e.demandItemFacet(q.e,r),f=a&&a.itemKeys;if(f&&f.length>0)n=(u=G)&&u[o];else if("item"===s){var l=e.demandItemFacet(Q,r),c=l&&l.taskKey;if(c){var h=e.demandItemFacet(m.v,c);n=h&&h.title}}return Object(i.__assign)({},n?{title:n}:{})}function te(){return function(e){return function(e,t){return{reportMode:V.e.pin}}}}var ne=Object(U.e)({operationTypeFacet:R.t,progressKeyFacet:Q,initializeBatch:function(){return Y}}),re=n(1625),ie=n(213),se=n(880),oe=new M.e("saveViewProgressBatch"),ue=Object(B.e)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([29,"ondemand.resx-ondemand"],5026)];case 1:return[2,e.sent().SaveViewDialog]}})})});function ae(){return oe.serializeNext()}var fe=Object(D.t)()(T.SwitchViewExecutor);function le(e){var t=this,n=e.viewTitle,r=e.isPublicView,o=e.onViewSaved,u=e.currentViewKey,a=e.itemSetKey,f=e.itemsScopeItemKey,l=e.listViewSetKey,c=e.reject,h=e.resolve,p=e.currentDerivedView,d=e.saveViewOperation,v=s.useState(!0),m=v[0],g=v[1],y=s.useState(ae)[0],b=s.useState(),w=b[0],E=b[1],S=s.useState(),x=S[0],T=S[1],N=Object(F.t)(),M=Object(j.e)(function(){T(!0);o&&o();h()}),D=Object(j.e)(function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,n,r,s,o,h,v,m,b;return Object(i.__generator)(this,function(i){switch(i.label){case 0:t=e.viewTitle,n=e.isPublicView;r=p&&p.title!==t;s=N(Object(_.e)({deserializedSetKey:P.e},a)).deserializedSetKey;if(!(r&&s&&p))return[3,3];if(!(o=t.trim()))throw new Error(A.e);return[4,N(Object(L.t)({webAbsoluteUrl:s.webAbsoluteUrl,listFullUrl:s.listFullUrl}))];case 1:if(i.sent().some(function(e){return e.serverView.Title===t}))throw new Error(O.format(A.r,t));return[4,N(Object(C.e)({items:(m={},m[l]={views:(b={},b[o]={itemSetKey:a,isPublic:n,sourceView:p,progressItemKey:y},b)},m)}))];case 2:i.sent();if(h=N(Object(_.e)({createdViewKey:H.e},y)).createdViewKey){E(h.viewId);g(!1)}return[3,5];case 3:if(!f){c(new Error("Cannot save a view without a current ItemsScope"));return[2]}return[4,N(he({itemsScopeItemKey:f,listViewSetKey:l,itemSetKey:a,currentViewKey:u,saveViewOperation:d}))];case 4:i.sent();if(v=N(Object(_.e)({savedViewKey:H.e},u)).savedViewKey){E(v.viewId);g(!1)}i.label=5;case 5:return[2]}})})}),B=Object(j.e)(function(){c(new k.e)});return m?s.createElement(ue,{viewTitle:n,isPublicView:r,onContinue:D,onCancel:B}):!x&&w?s.createElement(fe,{viewId:w,currentDerivedView:p,onComplete:M,itemSetKey:a}):null}var ce=Object(c.t)(function(e,t){var n=Object(I.e)(e).itemsScopeItemKey,r=Object(S.e)(e,t.itemSetKey),o=!!r&&Object(E.n)(r).isActivated("49F1ADD5-332D-4BAF-A4F9-FBEA104C76BE","01/20/21","Use saveViewWithProgress operation"),u=e.demandItemFacet(m.v,t.currentViewKey),a=o?R.e:ne;return s.createElement(le,Object(i.__assign)({},t,{itemsScopeItemKey:n,currentDerivedView:u,saveViewOperation:a}))});function he(e){return function(t){var n,r,s=e.listViewSetKey,o=e.itemSetKey,u=e.currentViewKey,a=e.saveViewOperation,f=t(Object(_.e)({childItems:q.e,parentItem:q.s,deserializedItemSetKey:P.e},o)),l=f.childItems,c=f.parentItem,h=f.deserializedItemSetKey;return t(a({items:(n={},n[s]={views:(r={},r[u]={itemSetKey:o},r)},n)})).then(function(){var e,n;if(h){var r=P.e.serialize(Object(i.__assign)(Object(i.__assign)({},h),{filterParams:void 0,sortFieldKey:void 0,sortAscending:void 0,groupByFieldKey:void 0})),s=t(Object(_.e)({filterOptionSets:q.n},r)).filterOptionSets;if(s&&h.filterParams){var o={};for(var a in s)s.hasOwnProperty(a)&&(o[s[a]]=!0);t(Object(re.e)({items:o}))}var f=new ie.e({publisher:he});f.resolveItems({items:(e={},e[r]=Object(i.__assign)(Object(i.__assign)({},l?q.e.pack(l):{}),c?q.s.pack(c):{}),e[u]=Object(i.__assign)({},m.Ht.pack(!1)),e)});t(f.execute());t(Object(se.e)({items:(n={},n[u]=[m._t,m.v],n[r]=[q.e],n)}))}})}}var pe=n(3827),de=n(3538),ve=n(72),me=new(n(20).e)("groupByActionControl"),ge=n(11),ye=n(25);var be=Object(ve.e)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee(0,3938)];case 1:return[2,e.sent().GroupByActionExecutor]}})})},function(e,t){var n=t.groupByFieldKey,r=t.itemSetKey,s=e.demandItemFacet(P.e,r);if(!s)return!1;var o=v.e.serialize(s),u=e.demandItemFacet(m.Ue,o),a=u&&u.templateType===ge.n.mySiteDocumentLibrary,f=Object(ye.e)(e,{enableGroupByInOneDrive:m.P}).enableGroupByInOneDrive,l=e.demandItemFacet(m.y,r),c=s.groupByFieldKey===n||!!l&&-1!==l.indexOf(n),h=P.e.serialize(Object(i.__assign)(Object(i.__assign)({},s),{groupByFieldKey:c?void 0:n})),p=s.viewKey&&H.e.serialize(s.viewKey),d=e.demandItemFacet(me,r);return me.evaluate(d)(e,{itemSetKey:r,viewKey:p,groupedItemSetKey:h,isAvailable:!a||!!f}).isAvailable},function(e,t){var n=t.groupByFieldKey,r=t.itemSetKey,i=e.demandItemFacet(P.e,r);if(!i)return!1;var s=e.demandItemFacet(m.y,r);return i.groupByFieldKey===n||!!s&&-1!==s.indexOf(n)}),we=n(3938),Ee=n(746),Se=n(3418),xe=n(4562),Te=!1,Ne=Object(c.e)(function(e,t){var n=t.itemSetKey,r=t.modifyType,s=t.columnKey,o=!1,u=e.demandItem({setKey:P.e,canModifySchema:m.f},n),a=u.setKey,f=u.canModifySchema,l=a&&a.viewKey?H.e.serialize(a.viewKey):void 0,c=e.demandItem({currentDerivedView:m.v},l).currentDerivedView,h=e.demandItemFacet(m.Te,s);if(a&&f&&c&&c.baseViewXml&&h)if(1===r||2===r){var d=c.getEffectiveFieldNames();if(d&&d.length){var v=d.indexOf(h),g=a.groupByFieldKey?1:0;o=1===r?v>g+1:v>=g&&v<d.length-1}}else o=!0;Te=!!a&&Object(Se.hasManageListsPermission)(e,{itemSetKey:a});return Object(i.__assign)({isAvailable:o},Object(p.t)(e,{itemKey:n,engagement:{name:"ModifyColumn",isIntentional:!0}}))},function(e,t){var n=t.itemSetKey,r=t.modifyType,s=t.columnKey,o=Te?xe.modifyColumnWithProgress:Ee.e;return{onExecute:function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var t,u;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return[4,e(o({items:(t={},t[n]={columnModifyTypeMap:(u={},u[s]={modifyType:r},u)},t)}))];case 1:i.sent();return[2]}})})}}})(h.e),Ce=n(1420),ke=n(596),Le=Object(c.e)(function(e,t){var n=t.itemSetKey,r=t.columnKey,s=t.aggregateType,o=e.demandItemFacet(m.l,n),u=o&&o[r]&&o[r].aggregateFunctionType||ke.e[0],a=u===ke.e[s]?void 0:ke.e[s];return Object(i.__assign)({isAvailable:!0,isToggled:u===ke.e[s]},a?Object(p.t)(e,{itemKey:n,engagement:{isIntentional:!0,action:"ModifyColumnAggregateType",name:a||"AggregateTypeNone",extraData:{PreviousAggregateType:u||"AggregateTypeNone",component:"ColumnContextMenu"}}}):{})},function(e,t){var n=t.itemSetKey,r=t.columnKey,s=t.aggregateType;return{onExecute:function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var t;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return[4,e(Object(Ce.e)({items:(t={},t[n]={aggregateType:s,columnKey:r},t)}))];case 1:i.sent();return[2]}})})}}})(h.e),Ae=n(1079),Oe=n(1080)},4562:function(e,t,n){"use strict";n.r(t);n.d(t,"modifyColumnWithProgress",function(){return k});var r,i=n(746),s=n(780),o=n(0),u=n(4329),a=n(12),f=n(379),l=n(8),c=n(458),h=n(312),p=n(3378),d=n(96),v=n(9),m=n(65),g=n(260),y=n(6),b=new y.e("modifyColumnProgressItem",{columnKey:Object(y.s)(),modifyType:Object(y.i)(),targetIndex:Object(y.i)()}),w=new g.e("modifyColumnProgress",function(e,t){var n=Object.keys(t.columnModifyTypeMap)[0],r=t.columnModifyTypeMap[n].modifyType,i=t.columnModifyTypeMap[n].targetIndex;return b.serialize({columnKey:n,modifyType:r,targetIndex:i})}),E=n(1),S=((r={})[m.r.started]=u.n,r[m.r.completed]=u.e,r[m.r.failed]=u.t,r),x=Object(a.t)(function(){return function(e){e(Object(f.e)(w,c.e)(Object(l.t)()(T)));e(Object(f.e)(w,h.n)(Object(l.t)()(N)));e(Object(f.e)(w,p.t)(Object(l.t)()(C)))}});function T(){return function(e){return function(e,t){var n,r=t.itemKey,i=t.format,s=Object(d.r)(e,t).phase,u=void 0,a=e.demandItemFacet(v.e,r),f=a&&a.itemKeys;if(f&&f.length>0)n=(u=S)&&u[s];else if("item"===i){var l=e.demandItemFacet(w,r),c=l&&l.taskKey;if(c){var h=e.demandItemFacet(b,c),p=h&&h.columnKey;if(p){n=e.demandItemFacet(E.Te,p)}}}return Object(o.__assign)({},n?{title:n}:{})}}}function N(){return function(e){return function(e,t){return{reportMode:h.e.pin}}}}function C(){return function(e){return function(e,t){return{maxChildItemCount:0}}}}var k=Object(s.e)({operationTypeFacet:i.t,progressKeyFacet:w,initializeBatch:function(){return x}})},4571:function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n("react-lib"),i=n(3923),s=n(58),o=n(2),u={key:Object(o.t)("quickEditUndo"),automationId:"quickEditUndoCommand",name:s.re,iconProps:{iconName:"Undo"},isPermanent:!0,action:r.createElement(i.e,{undoRedoActionType:"undo"})}},4572:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var r=n("react-lib"),i=n(58),s=n(2),o=Object(s.t)("quickEditRedo"),u=n(3923),a={key:o,automationId:"quickEditRedoCommand",name:i.ne,iconProps:{iconName:"Redo"},action:r.createElement(u.e,{undoRedoActionType:"redo"})}},4582:function(e,t,n){"use strict";n.d(t,"e",function(){return m});var r=n(0),i=n("react-lib"),s=n(1850),o=n(2405),u=n(18),a=n(14),f=n(22),l=n(80),c=n(29),h=n(41),p=Object(l.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([78,"ondemand.resx-ondemand"],4766)];case 1:return[2,e.sent().default]}})})}),d=Object(h.t)(function(e,t){var n=t.itemKey,s=Object(u.o)(function(e){return i.createElement(p,Object(r.__assign)({},e,{itemKey:n}))},{scope:"global"});return i.createElement(f.e,Object(r.__assign)({onExecute:s},Object(c.t)(e,{itemKey:n,engagement:{name:"SocialBar",isIntentional:!0}})))}),v=(Object(a.i)()(d),n(3940)),m=(function(e){Object(r.__extends)(t,e);function t(t){return e.call(this,t)||this}t.prototype.render=function(){var e=this.props,t=e.likeLabel,n=e.itemKey,r=i.createElement(o.e,{activityDescription:t,isCompact:!0});return i.createElement(u.n,{action:i.createElement(d,{itemKey:n})},function(e){var t=e.isAvailable,n=e.execute,o=t?function(){n().catch(function(){})}:void 0;return i.createElement(s.e,{disabled:!1,className:v.e,onClick:o},r)})};return t})(i.Component)},4625:function(e,t,n){"use strict";n.r(t);n.d(t,"ItemAutoRefresh",function(){return a});n.d(t,"CurrentItemAutoRefresh",function(){return f});var r=n("react-lib"),i=n(14),s=n(41),o=n(3860);function u(e){var t=e.subscribe;r.useLayoutEffect(function(){return t()},[t]);return null}var a=Object(s.t)(function(e,t){var n=t.itemKey,i=e.demandItemFacet(o.e,n),s=o.e.evaluate(i)(e,{itemKey:n,itemSubscriber:null}),a=s.isAvailable,f=s.itemSubscriber,l=s.subscribe;return a?f||(l?r.createElement(u,{subscribe:l}):null):null}),f=Object(i.n)()(a)},4663:function(e,t,n){"use strict";n.r(t);n.d(t,"sharePointGraphAddon",function(){return S});var r=n(0),i=n(12),s=n(126),o=n(160),u=n(79),a=n(213),f=n(1514),l=n(55),c=n(281),h=n(4664),p=n(2),d=n(3106),v=n(5),m=n(874),g=n(1),y=n(174),b=n(1411),w=n(849);function E(e){var t=e.itemKey,n=e.driveItem;return function(e){var i,s,o,u,d=e(Object(y.e)({enableSharePointItemMapping:g.te})).enableSharePointItemMapping,b=void 0===d||d,S=new a.e({publisher:E}),x=n.webDavUrl||n.remoteItem&&n.remoteItem.webDavUrl||n.webUrl,T=x&&decodeURIComponent(x);if(T){var N={itemFullUrl:T},C=Object(m.e)(T),k={itemFullUrl:C},L=f.e.serialize(N),A=f.e.serialize(k);S.mapKeys({mappings:(i={},i[L]=t,i)});S.resolveItems({items:(s={},s[L]=Object(r.__assign)(Object(r.__assign)({},b?Object(r.__assign)({},Object(p.n)({preferredKeyFacet:c.n},{preferredKeyFacet:new h.e(f.e,function(e){return e===l.e})})):{}),v.M.pack({itemKey:A})),s[A]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},v.m.pack({})),v.i.pack(C)),v.O.pack(encodeURI(C))),w.e.pack(null===(u=null===(o=n.remoteItem)||void 0===o?void 0:o.parentReference)||void 0===u?void 0:u.driveType)),s)})}return{itemResolver:S}}}var S=Object(i.t)(function(){return function(e){var t;e(b.e);e(d.sharePointItemByFullUrlAddon);e(Object(s.e)({items:(t={},t[o.e]=Object(r.__assign)({},u.N.pack({process:E})),t)}))}})},4738:function(e,t,n){"use strict";n.r(t);n.d(t,"driveItemDeleteItemsBatchedOperationHandler",function(){return g});var r,i=n(0),s=n(419),o=n(12),u=n(437),a=n(130),f=n(65),l=n(126),c=n(880),h=n(5),p=n(113),d=n(334),v=n(716),m=n(154);(function(e){e.Completed="completed";e.Failed="failed";e.InProgress="inProgress"})(r||(r={}));var g=Object(o.n)({maxParallelOperationCount:4,timeout:3e5,areSameBatch:function(e,t){var n=p.e.deserialize(e.itemKey).driveId,r=p.e.deserialize(t.itemKey).driveId;return!!n&&!!r&&n===r}})(function(e){var t=this,n=e.items,g=Object.keys(n),y=g.map(function(e){return p.e.deserialize(e)});return function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,p,b,w,E,S,x;return Object(i.__generator)(this,function(T){switch(T.label){case 0:e(Object(l.e)({items:Object(a.t)(n,function(e){e.progressItemKey;return Object(i.__assign)(Object(i.__assign)({},f.y.pack({total:1,current:0})),f.p.pack(!0))},function(e,t){return t.progressItemKey})}));t={value:y.map(function(e){return{id:e.itemId,deleted:{}}})};p="";b=Object(d.n)(y[0]);return[4,e(Object(v.n)({url:b+"/items",method:"PATCH",body:t,qosName:"deleteItems",endpoint:y[0].endpoint,parseResponse:function(e){p=e.getResponseHeader("Location")||""}}))];case 1:T.sent();w=0;E=!1;S=!1;Object(u.t)(3e5).then(function(){return S=!0});x=function(){var t;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return[4,e(Object(v.n)({url:p,qosName:"getOperationStatus",endpoint:y[0].endpoint}))];case 1:t=i.sent();g.forEach(function(){e(Object(l.e)({items:Object(a.t)(n,function(e){e.progressItemKey;return f.y.pack({total:1,current:t.percentageComplete/g.length})},function(e,t){return t.progressItemKey})}))});if(t.status!==r.Completed&&t.status!==r.Failed)return[3,2];E=!0;w=t.summary.failed;return[3,4];case 2:return[4,Object(u.t)(500)];case 3:i.sent();i.label=4;case 4:return[2]}})};T.label=2;case 2:return[5,x()];case 3:T.sent();T.label=4;case 4:if(!E&&!S)return[3,2];T.label=5;case 5:if(S)throw new s.e({facets:Object(i.__assign)({},m.c.pack(408))});e(Object(c.e)({items:Object(a.e)(g,function(){return[h.l]})}));if(w>0)throw new o.e({items:Object(a.e)(g.slice(0,w),function(){return new s.e({facets:Object(i.__assign)({},m.c.pack(500))})})});return[2]}})})}})},4846:function(e,t,n){"use strict";n.r(t);n.d(t,"graphAddon",function(){return Da});var r=n(0),i=n(12),s=n(1415),o=n(1468),u=n(262),a=n(640),f=n(9),l=n(414),c=n(5),h=n(213),p=n(2348),d=Object(i.i)()(function e(t){var n=this,i=t.itemKey,s=a.e.deserialize(i);return function(t){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,o;return Object(r.__generator)(this,function(u){(n=new h.e({publisher:e})).resolveItems({items:(o={},o[i]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},f.t.pack({itemKey:l.e.serialize({driveItemKey:s,sortBy:"",isAscending:!0})})),c.h.pack(p.o)),c.m.pack({})),c.M.pack(void 0)),o)});t(n.execute());return[2]})})}});var v=n(334),m=n(716),g=n(174),y=n(243),b=n(6),w=new b.e("driveItemPage",{endpoint:Object(b.s)(),setItemKey:Object(b.s)(),token:Object(b.s)()}),E=n(247),S=n(365),x=n(79),T=n(332),N=n(37),C=n(158),k=n(2628),L=n(113),A=n(730),O=n(1177),M=new b.e("userById",{id:Object(b.s)(),endpoint:Object(b.s)()}),_=n(198),D=n(2),P=new D.e("sharedBy"),H=n(3104);function B(e){var t=e.itemKey,n=e.driveItemKey,i=e.parentFolderItemKey,s=e.setItemKey,o=e.driveItemResponse,u=e.endpoint,a=e.getDriveItemFacets,l=void 0===a?k.e:a,p=e.shouldInvalidateItemSetOnChildItemRename,d=void 0===p?void 0:p;return function(e){var a,p=new h.e({publisher:B}),v=A.e.serialize({driveItemKey:n}),m=void 0;if(s){var g=Object(y.e)().forFacet(c.l).thenInvalidate(s,f.e).forFacet(c.M).thenInvalidate(s,f.e);d&&!d(u)||(g=g.forFacet(c.h).thenInvalidate(s,f.e));m=g.pack()}p.merge(e(l({itemKey:t,driveItemKey:n,driveItem:o,endpoint:u,parentFolderItemKey:i})).itemResolver);p.resolveItems({items:(a={},a[t]=Object(r.__assign)(Object(r.__assign)({},c.e.pack({itemKey:v})),m),a)});if(o.lastModifiedBy){if(S=o.lastModifiedBy.user){var b=S.id&&M.serialize({id:S.id,endpoint:u});if(b=S.email&&H.e.serialize({email:S.email,endpoint:u})){var w=j({itemKey:t,personFacet:c.A,userKey:b,user:S}).itemResolver;p.merge(w)}}}if(o.createdBy){var E=void 0;if((S=o.createdBy.user)&&S.email&&(E=H.e.serialize({email:S.email,endpoint:u}))){w=j({itemKey:t,personFacet:O.r,userKey:E,user:S}).itemResolver;p.merge(w)}}if(o.remoteItem&&o.remoteItem.shared&&o.remoteItem.shared.sharedBy&&o.remoteItem.shared.sharedBy.user){var S,x=void 0;if((S=o.remoteItem.shared.sharedBy.user).email&&(x=H.e.serialize({email:S.email,endpoint:u}))){w=j({itemKey:t,personFacet:P,userKey:x,user:S}).itemResolver;p.merge(w)}}return{itemResolver:p}}}function j(e){var t,n,i=e.itemKey,s=e.personFacet,o=e.userKey,u=e.user,a=new h.e({publisher:j});a.resolveItems({items:Object(r.__assign)((t={},t[o]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},c.h.pack(u.displayName)),_.e.pack(u.email)),_.i.pack(u.id)),t),s&&(n={},n[i]=Object(r.__assign)({},s.pack({itemKey:o,displayValue:u.displayName})),n))});return{itemResolver:a}}var F=n(2627),I=new b.e("driveItem",{endpoint:Object(b.s)(),driveId:Object(b.s)({shouldNormalizeToEmpty:!0}),canonicalUrl:Object(b.s)()});function q(e){var t=e.driveItemResponse,n=e.endpoint,i=e.getDriveItemFacets,s=void 0===i?k.e:i;return function(i){var o,u,a,f=t.remoteItem,l=f&&f.parentReference,h=t.parentReference,p=h||l,d=p&&p.driveId,v=p&&p.id,m="personal"===(p&&p.driveType),g=!!t.root;if(f){a=f.id;l&&(d=l.driveId)}else a=m&&t.root?F.r:t.id;var y={endpoint:n,driveId:d,itemId:a},b=L.e.serialize(y),w=t&&(t.webDavUrl||t.webUrl),E=m&&p&&p.path===F.e?F.r:v||void 0,S=p&&E?L.e.serialize({endpoint:n,driveId:p.driveId||d,itemId:E}):void 0,x=[],T="";if(!m&&w){var N=new C.e(w);x.push.apply(x,N.path.split("/").slice(1,-1).map(function(e){return decodeURIComponent(e)}));x.unshift(N.authority);T=x.join("/")}p&&!g&&!E&&T&&(S=I.serialize({endpoint:n,driveId:p.driveId,canonicalUrl:T}));var k=i(B(Object(r.__assign)(Object(r.__assign)({},e),{itemKey:b,driveItemKey:y,parentFolderItemKey:S}))).itemResolver;k.resolveItems({items:Object(r.__assign)({},S&&(o={},o[S]=Object(r.__assign)({},T?c.O.pack(T):{}),o))});if(f&&l){var A=L.e.serialize({endpoint:n,driveId:h&&h.driveId,itemId:t.id}),O=L.e.serialize({endpoint:n,driveId:l.driveId,itemId:f.id});k.mapKeys({mappings:(u={},u[A]=O,u)});k.merge(i(s({itemKey:O,driveItem:t,endpoint:n})).itemResolver)}return{itemResolver:k,actualDriveItemKey:y,actualItemKey:b}}}var R=n(118),U=n(59),z=new D.e("itemSetEngagementExtraData"),W=n(135),X=n(1162),V=n(3410),$=n(3097),J=new D.e("mountPoint"),K=n(337),Q=n(643),G=n(1186),Y=n(149),Z=n(849),ee=n(3103),te=n(840),ne=n(2883),re=n(3915),ie=n(3914),se=n(3412),oe=n(3413),ue=n(3411),ae=n(2863),fe=n(3917),le=n(3916),ce=n(1330),he=n(3918),pe=n(333),de=n(3586),ve=n(36),me=!ve.t.isActivated("563DE72A-2756-43DF-A2E8-910F31083778","","");function ge(e){var t=e.itemKey,n=e.driveItemKey,i=e.driveItem,s=e.endpoint,o=e.parentFolderItemKey,u=e.shouldReturnShareFacets,a=void 0===u||u,l=i.coverImage,d=i.file,v=i.fileSystemInfo,m=i.name,g=i.parentReference,b=i.lenses,w=i.remoteItem,E=i.root,S=i.size,x=i.thumbnails,T=i.image,N=i.video,C=i.eTag,k=i.photo,A=i.restricted,O=i.tags,M=i.specialFolder;return function(e){var u,_,D,P,H,B,j,F,I,q,R,z,ve,ye,be,we,Ee=i.lastModifiedDateTime,Se=void 0===Ee?v&&v.lastModifiedDateTime:Ee,xe=i.createdDateTime||v&&v.createdDateTime,Te=(new Date).getTime(),Ne=xe?new Date(xe).getTime():void 0,Ce=Ne?Te-Ne<1728e5:void 0,ke=g&&g.driveId,Le=g&&g.driveType,Ae="personal"===Le,Oe=v&&v.lastAccessedDateTime,Me=null===(P=k)||void 0===P?void 0:P.takenDateTime,_e=i.package,De=Object(ie.e)(x),Pe=T,He=N,Be=i.shared||(null===(H=i.remoteItem)||void 0===H?void 0:H.shared),je={itemId:i.id,driveId:ke,endpoint:s},Fe=v&&v.systemPath,Ie=void 0;if(w){Ie={itemId:w.id,driveId:w.parentReference&&w.parentReference.driveId||"",endpoint:s};we=L.e.serialize({itemId:w.id,driveId:(j=null===(B=w.parentReference)||void 0===B?void 0:B.driveId,null!=j?j:ke),endpoint:s})}var qe,Re=n||je,Ue=L.e.serialize(Re),ze=i.webDavUrl;qe="business"!==Le&&"documentLibrary"!==Le&&"personal"!==Le||!E?m||"":p.t;var We,Xe=i.bundle||(null===(F=w)||void 0===F?void 0:F.bundle),Ve=i.folder||(null===(I=w)||void 0===I?void 0:I.folder)||Xe;Ve&&(We=me?w?12:Be?5:2:Be?w?12:5:2);var $e=(null===(R=null===(q=Ve)||void 0===q?void 0:q.folderView)||void 0===R?void 0:R.sortBy)||"",Je="descending"===(null===(ve=null===(z=Ve)||void 0===z?void 0:z.folderView)||void 0===ve?void 0:ve.sortOrder),Ke=$e&&{columnKey:Object(pe.i)($e),isAscending:!Je},Qe=null!=S?S:null===(ye=w)||void 0===ye?void 0:ye.size,Ge=null===(be=Ve)||void 0===be?void 0:be.childCount,Ye=(function(e,t){var n=e.lastIndexOf(".");if(t||n<0)return{name:e,extension:""};return{name:e.substring(0,n),extension:e.substring(n)}})(qe,!!Ve),Ze=Ye.extension||i.package&&i.package.type,et=Ze&&Object(re.e)(Ze),tt=i.sharepointIds,nt=i.localItem,rt=i.webUrl,it=new h.e({publisher:ge});it.resolveItems({items:(u={},u[t]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},L.e.pack(Re)),c.h.pack(qe)),te.n.pack(Fe)),c.f.pack(Se?new Date(Se).getTime():void 0)),c.u.pack(Ne)),Y.u.pack(Me?new Date(Me).getTime():void 0)),c.S.pack(Ce)),W.i.pack(_e&&"oneNote"===_e.type?{}:void 0)),Object(y.e)().forFacet(Y.v).thenInvalidate(Ue,V.e).pack()),$.e.pack(i)),f.t.pack({itemKey:X.e.serialize({driveItemKey:Re,sortBy:$e,isAscending:!Je})})),c.n.pack({itemKey:Q.e.serialize({driveItemKey:Re})})),c.M.pack(o?{itemKey:o}:void 0)),Z.e.pack(Le)),c.d.pack(Ye)),ae.e.pack(Xe)),fe.e.pack(l)),te.t.pack(d&&d.mimeType)),J.pack(Ie)),ne.t.pack(b&&b.length>0?b:void 0)),he.e.pack(O)),c.m.pack(Ve?{}:void 0)),Oe?Object(r.__assign)({},c.o.pack(new Date(Oe).getTime())):{}),De?Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},V.e.pack(De)),ue.e.pack(!0)),le.e.pack(Object(ce.t)(Ye.extension))):{}),C?c.p.pack(C):{}),Pe&&Pe.width&&Pe.height?Y.a.pack({width:Pe.width,height:Pe.height}):{}),Pe&&!He?Y.p.pack({}):{}),He?Y.g.pack({}):{}),Ae?Object(r.__assign)({},ee.e.pack(i.vault)):{}),a?Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},c.x.pack(!!Be)),G.e.pack(Be)),We?W.e.pack(We):{}):{}),u)});it.resolveItems({items:(_={},_[t]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},void 0!==Qe?c.v.pack(Qe):{}),rt?c.O.pack(rt):{}),Ke?f.u.pack(Ke):{}),ze?c.i.pack(decodeURIComponent(ze)):{}),nt?te.e.pack(nt):{}),"number"==typeof Ge?U.e.pack(Ge):{}),et?ne.e.pack(et):{}),A?de.e.pack(A):{}),tt?se.e.pack(tt):{}),M?oe.e.pack(M.name):{}),_)});it.resolveItems({items:(D={},D[t]=Object(r.__assign)({},me?K.e.pack(we?{itemKey:we}:void 0):we?K.e.pack({itemKey:we}):{}),D)});return{itemResolver:it}}}function ye(e){var t=e.driveItemResponse,n=e.endpoint;return function(i){var s=t.parentReference,o=s&&s.driveId,u=s&&s.id,a=t.id;t.root&&(a=F.r);var f={endpoint:n,driveId:o,itemId:a},l=L.e.serialize(f),c=s&&s.path===F.e?F.r:u||void 0,h=s&&c?L.e.serialize({endpoint:n,driveId:s.driveId,itemId:c}):void 0;return{itemResolver:i(B(Object(r.__assign)(Object(r.__assign)({},e),{itemKey:l,driveItemKey:f,getDriveItemFacets:ge,parentFolderItemKey:h}))).itemResolver,actualDriveItemKey:f,actualItemKey:l}}}function be(e){return function(t){var n,i,s,o,u,a=e.itemKey,l=e.parentItemKey,c=e.itemSetKeyFacet,p=e.filterChildItems,d=e.onProcessResponse,v=e.groupChildItems,m=e.response,b=e.skip,k=void 0===b?0:b,L=e.enableRandomAccess,A=void 0!==L&&L,O=e.disableRemoteItem,M=e.totalChildCount,_=e.getDriveItemFacets,D=c.deserialize(a),P=D.driveItemKey.endpoint,H=new h.e({publisher:be}),B=t(Object(T.e)({name:"remoteItemsMissingParentRef"})),j="number"==typeof m["@odata.count"]?m["@odata.count"]:M||m.value.length,F=m["@odata.nextLink"],I=!!F,W=t(Object(R.e)(function(e){return{childItemsFacetResolved:e.isItemFacetResolved(f.e,a),prevChildKeys:e.demandItemFacet(f.e,a)}})),X=W.childItemsFacetResolved,V=W.prevChildKeys,$=V&&V.itemKeys,J=0,K=0;A&&(X&&$?u=$.slice(0):"number"==typeof j&&(u=new Array(j+(I&&j<=m.value.length?1:0))));u||(u=new Array(m.value.length+(I?1:0)));for(var Q=k,G=0,Y=0,Z=m.value;Y<Z.length;Y++){var ee=Z[Y],te=p&&p(ee),ne=ee.remoteItem,re=!(ee.remoteItem&&ee.remoteItem.parentReference&&ee.remoteItem.parentReference.driveId),ie=ne&&re;ie&&G++;if(te||ie){u.splice(Q,1);j--}else{var se=t(Object(g.e)({graphEndpoint:x.m,graphRecentEndpoint:x.b,processDriveItemSet:x.C,allowDisableRemoteItemInPlace:x.i})),oe=se.graphEndpoint,ue=se.graphRecentEndpoint,ae=se.processDriveItemSet,fe=se.allowDisableRemoteItemInPlace&&O,le=fe?ye:q,ce=ee.webDavUrl||!fe&&ee.remoteItem&&ee.remoteItem.webDavUrl||ee.webUrl,he=P.indexOf("/_api/v2.0")>-1||P.indexOf("/_api/v2.1")>-1,pe=oe||ue;if(ce&&he){var de=ce&&decodeURIComponent(ce);P=pe?new C.e(de).authority+"/_api/v2.0":""+new C.e(de).authority+new C.e(P).path}var ve=t(le({shouldInvalidateItemSetOnChildItemRename:ae&&ae.shouldInvalidateItemSetOnChildItemRename,setItemKey:a,driveItemResponse:ee,endpoint:P,getDriveItemFacets:_})),me=ve.itemResolver,ge=ve.actualItemKey,we=ve.actualDriveItemKey,Ee=ee.thumbnails,Se=ee.remoteItem;J++;(Ee||!fe&&Se&&Se.thumbnails)&&K++;u[Q]=ge;H.merge(me);if(d){var xe=d({itemKey:a,driveItemKey:we,item:ee});xe&&H.merge(xe.itemResolver)}var Te=t(Object(g.e)({processDriveItemFromSharePoint:x.N})).processDriveItemFromSharePoint;if(Te&&(he||pe)){var Ne=t(Te.process({itemKey:ge,driveItem:ee})).itemResolver;H.merge(Ne)}Q++}}t(B(Object(r.__assign)({resultType:G<1?N.e.Success:N.e.Failure},G>0?{extraData:{count:G}}:{})));if(I){var Ce=w.serialize({setItemKey:a,endpoint:P,token:F});H.merge(Object(E.t)({itemKey:Ce}).itemResolver);u[Q]=Ce}if(v){var ke=v(D);ke&&H.merge(ke.itemResolver)}else H.resolveItems({items:(n={},n[a]=Object(r.__assign)({},f.e.pack({itemKeys:u})),n)});H.resolveItems({items:(i={},i[a]=Object(r.__assign)({},z.pack({childCount:J,childCount_withThumbnail:K})),i)});j!==M&&H.resolveItems({items:(s={},s[l]=Object(r.__assign)({},U.e.pack(j)),s)});H.resolveItems({items:(o={},o[a]=Object(r.__assign)(Object(r.__assign)({},f.s.pack({itemKey:l})),Object(y.e)().forFacet(f.e).thenInvalidate(S.e).pack()),o)});return{itemResolver:H}}}var we=n(397),Ee=n(223);function Se(e){var t=e.itemKey,n=e.itemSetKeyFacet,i=e.parentItemKeyFacet,s=e.childItemsResponse,o=e.disableRemoteItem,u=e.parentItemResponse,a=e.mapItemSetKey,l=n.deserialize(t),c=i.serialize(l.driveItemKey),h=l.driveItemKey.endpoint;return function(n){var i,l;Ee.t(we.e.processData.start);var p=n(be(Object(r.__assign)(Object(r.__assign)({},e),{response:s,disableRemoteItem:o,parentItemKey:c}))).itemResolver;if(a){var d=a().itemResolver;p.merge(d)}var v=n(Object(g.e)({allowDisableRemoteItemInPlace:x.i})).allowDisableRemoteItemInPlace;if(u){var m=n((v&&o?ye:q)({setItemKey:t,driveItemResponse:u,endpoint:h})),b=m.itemResolver,w=m.actualItemKey;p.mapKeys({mappings:(i={},i[w]=c,i)});p.merge(b)}p.resolveItems({items:(l={},l[c]=Object(r.__assign)({},Object(y.e)().forFacet(f.t).thenInvalidate(e.itemKey,f.e).pack()),l)});Ee.t(we.e.processData.end);return{itemResolver:p}}}var xe=n(419),Te=ve.t.isActivated("cade488d-480a-444f-a1ea-d3d121529bb7","11/01/2021","Set one minute timeout for API requests");function Ne(e){var t=this,n=e.itemKey,i=e.itemSetKeyFacet,s=e.getUrl,o=e.sortChildItems,u=e.qosName,a=e.preprocessResponse,f=e.expectedErrors,l=e.disableRemoteItem,c=void 0!==l&&l,h=i.deserialize(n),p=h.driveItemKey.endpoint;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,l,d,g,y;return Object(r.__generator)(this,function(b){switch(b.label){case 0:t=Object(v.n)(h.driveItemKey);b.label=1;case 1:b.trys.push([1,4,,5]);return[4,n(Object(m.r)({url:s(h),driveUrl:t,qosName:"getChildren"+(u?"."+u:""),endpoint:p,headers:e.additionalHeaders,expectedErrors:f,timeout:Te?void 0:6e4}))];case 2:i=b.sent();l=Object(r.__spreadArrays)(i.value);d=a&&a(l)||i.value;g=o&&o(d)||d;return[4,n(Se(Object(r.__assign)(Object(r.__assign)({},e),{disableRemoteItem:c,childItemsResponse:Object(r.__assign)(Object(r.__assign)({},i),{value:g})})))];case 3:return[2,{itemResolver:b.sent().itemResolver}];case 4:y=b.sent();throw new xe.e(Object(r.__assign)({code:"UnknownError"},y instanceof Error?{innerError:y}:{message:JSON.stringify(y)}));case 5:return[2]}})})}}var Ce=n(111),ke=n(555),Le=n(823),Ae=n(253);function Oe(e,t){var n=new Date(e.valueOf());n.setDate(n.getDate()-t);return n}var Me=n(2078),_e="fileName",De="sharedByName",Pe="dateModified";var He=new Map([["code",Ce.e.text],["csv",Ce.e.excel],["docx",Ce.e.word],["dotx",Ce.e.word],["one",Ce.e.onenote],["onepkg",Ce.e.onenote],["onetoc",Ce.e.onenote],["pdf",Ce.e.pdf],["photo",Ce.e.media],["potx",Ce.e.powerpoint],["ppsx",Ce.e.powerpoint],["pptx",Ce.e.powerpoint],["rtf",Ce.e.text],["txt",Ce.e.text],["video",Ce.e.media],["xlsx",Ce.e.excel],["xltx",Ce.e.excel],["zip",Ce.e.zip]]);function Be(e,t){var n,r,i=(n=e,r=Object(ke.t)(n,!0),Object(Le.t)(r)),s=He.get(i);return!!s&&Object(Ce.t)(t.filters,s)}function je(e,t){void 0===t&&(t=[]);return t.every(function(t){var n,r=!(t.type===De)||(function(e,t){var n=e.remoteItem&&e.remoteItem.shared&&e.remoteItem.shared.sharedBy&&e.remoteItem.shared.sharedBy.user&&e.remoteItem.shared.sharedBy.user.displayName;return!!n&&t.indexOf(n)>-1})(e,t.values),i=!(t.type===_e)||(function(e,t){return!!e.name&&Be(e.name,t)})(e,Object(Ae.t)(t.values)),s=!(t.type===Pe)||(function(e,t){var n=e.lastModifiedDateTime||"";return(n&&new Date(n))>=t})(e,(function(e){var t=new Date,n=new Date(t.getFullYear(),t.getMonth(),t.getDate());switch(e){case Me.e.today:return n;case Me.e.yesterday:return Oe(n,1);case Me.e.last7Days:return Oe(n,7);case Me.e.last30Days:return Oe(n,30);case Me.e.last3Months:return Oe(n,90);default:return new Date(0)}})((n=t.values).length<1||-1===Object.keys(Me.e).indexOf(n[0])?Me.e.none:Me.e[n[0]]));return r&&i&&s})}var Fe=n(218);function Ie(e,t,n){var r=e.lastModifiedDateTime,i=t.lastModifiedDateTime,s=r&&i&&new Date(r).getTime()-new Date(i).getTime()||0,o=r&&i&&new Date(i).getTime()-new Date(r).getTime()||0;return n?s:o}function qe(e,t,n){var r=e&&e.remoteItem&&e.remoteItem.shared&&e.remoteItem.shared.sharedDateTime,i=t&&t.remoteItem&&t.remoteItem.shared&&t.remoteItem.shared.sharedDateTime,s=r&&i&&new Date(r).getTime()-new Date(i).getTime()||0,o=r&&i&&new Date(i).getTime()-new Date(r).getTime()||0;return n?s:o}function Re(e,t,n){var r=e.name,i=t.name,s=r&&i&&r.localeCompare(i)||0,o=r&&i&&i.localeCompare(r)||0;return n?s:o}function Ue(e,t,n){var r=e.remoteItem&&e.remoteItem.shared&&e.remoteItem.shared.sharedBy&&e.remoteItem.shared.sharedBy.user&&e.remoteItem.shared.sharedBy.user.displayName,i=t.remoteItem&&t.remoteItem.shared&&t.remoteItem.shared.sharedBy&&t.remoteItem.shared.sharedBy.user&&t.remoteItem.shared.sharedBy.user.displayName,s=r&&i&&r.localeCompare(i)||0,o=r&&i&&i.localeCompare(r)||0;return n?s:o}function ze(e,t,n,i){return(function(e,t){return Object(r.__spreadArrays)(e).sort(t)})(e,function(e,r){var s=e.folder,o=r.folder;return n&&s&&!o?-1:n&&!s&&o?1:i(e,r,t)})}var We=new b.e("SharedByPersonKeyFacet",{displayName:Object(b.s)(),email:Object(b.s)(),id:Object(b.s)()}),Xe=new b.e("dateSharedGroupKeyFacet",{relativeTime:Object(b.s)(),sharedDateTime:Object(b.s)()}),Ve=new b.e("relativeTimeGroupKeyFacet",{relativeTime:Object(b.s)()}),$e=n(4299),Je=n(573),Ke=n(16),Qe=n(52),Ge=n(3920);function Ye(e){if(l.e.matches(e)){var t=l.e.deserialize(e).groupBy;if(t===pe.t[pe.r])return(function(e){var t={},n=function(i){for(var s,o,u=new h.e({publisher:n}),a=(function(e){for(var t=[],n=0,r=e;n<r.length;n++){var i=r[n];if(!We.matches(i))return e;var s=We.deserialize(i);t.push(s)}return t.sort(function(e,t){return e&&t&&e.displayName.localeCompare(t.displayName)}).map(function(e){return We.serialize(e)})})(Object.keys(t)),l=[],p=0,d=a;p<d.length;p++){var v=d[p];if(We.matches(v)){var m=We.deserialize(v);u.resolveItems({items:(s={},s[v]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},c.h.pack(m.displayName)),U.s.pack(!0)),f.e.pack({itemKeys:t[v]})),s)});l.push(v)}}u.resolveItems({items:(o={},o[e]=Object(r.__assign)(Object(r.__assign)({},f.e.pack({itemKeys:l})),Qe.e.pack(!0)),o)});return{itemResolver:u}};return{onProcessResponse:function(e){var n,r,i=e.driveItemKey,s=e.item;if(s&&i){var o=s.remoteItem,u=o&&o.shared&&(null!=(n=o.shared.sharedBy)?n:o.shared.owner),a=u&&u.user,f=L.e.serialize(i);if(a&&(a.email||a.id)){var l=We.serialize({displayName:a.displayName,email:a.email||"",id:a.id||""});if(r=l,t.hasOwnProperty(r))t[l].push(f);else{t[l]=[];t[l].push(f)}}}},groupChildItems:n}})(e);if(t===pe.t[pe.e])return(function(e){var t={},n=function(i){for(var s,o,u=new h.e({publisher:n}),a=(function(e){for(var t={},n=(function(e){for(var t=[],n=0,r=e;n<r.length;n++){var i=r[n];if(!Xe.matches(i))return e;var s=Xe.deserialize(i);t.push(s)}return t.sort(function(e,t){return e&&t&&new Date(t.sharedDateTime).getTime()-new Date(e.sharedDateTime).getTime()}).map(function(e){return Xe.serialize(e)})})(Object.keys(e)),r=function(e){return t.hasOwnProperty(e)},i=0,s=n;i<s.length;i++){var o=s[i];if(Xe.matches(o)){var u=Xe.deserialize(o).relativeTime,a=Ve.serialize({relativeTime:u});if(r(a))for(var f=e[o],l=0,c=f;l<c.length;l++){var h=c[l];t[a].push(h)}else{t[a]=[];f=e[o];for(var p=0,d=f;p<d.length;p++){h=d[p];t[a].push(h)}}}}return t})(t),l=[],p=0,d=Object.keys(a);p<d.length;p++){var v=d[p];if(Ve.matches(v)){var m=Ve.deserialize(v).relativeTime;u.resolveItems({items:(s={},s[v]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},c.h.pack(m)),U.s.pack(!0)),f.e.pack({itemKeys:a[v]})),s)});l.push(v)}}u.resolveItems({items:(o={},o[e]=Object(r.__assign)(Object(r.__assign)({},f.e.pack({itemKeys:l})),Qe.e.pack(!0)),o)});return{itemResolver:u}};return{onProcessResponse:function(e){var n,r=e.driveItemKey,i=e.item;if(i&&r){var s=i.remoteItem,o=s&&s.shared&&s.shared.sharedDateTime,u=L.e.serialize(r);if(o){var a=(function(e,t){if(!e)return $e.n;var n=new Date(t.getFullYear(),t.getMonth(),t.getDate());if(e>=n)return Je.today;n.setDate(n.getDate()-1);if(e>=n)return Je.yesterday;n.setDate(t.getDate()-t.getDay());if(e>=n)return $e.i;n.setDate(n.getDate()-7);if(e>n)return $e.t;var r=new Date(t.getFullYear(),t.getMonth(),1),i=new Date(t.getFullYear(),t.getMonth()-1,1);if(e>=i&&e<r)return $e.e;n.setDate(n.getDate()-7);if(e>n)return $e.o;n.setDate(n.getDate()-7);if(e>n)return $e.s;if(e>=r)return $e.r;var s=t.getFullYear()===e.getFullYear(),o=Ge.e[e.getMonth()];if(s)return o;return Ke.format(Je.MonthAndYear,o,e.getFullYear())})(new Date(o),new Date),f=Xe.serialize({relativeTime:a,sharedDateTime:o});if(n=f,t.hasOwnProperty(n))t[f].push(u);else{t[f]=[];t[f].push(u)}}}},groupChildItems:n}})(e)}return{onProcessResponse:void 0,groupChildItems:void 0}}var Ze=Object(i.i)()(function(e){var t=this,n=l.e.deserialize(e.itemKey),i=n.filters,s=n.sortBy,o=n.isAscending;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,u,f,c,h,p,d,v;return Object(r.__generator)(this,function(y){switch(y.label){case 0:t=Ye(e.itemKey),u=t.onProcessResponse,f=t.groupChildItems;c=l.e.deserialize(e.itemKey);h=c.driveItemKey.endpoint;p=n(Object(g.e)({graphSharedWithMeEndpoint:x.w})).graphSharedWithMeEndpoint;h=p||h;d=n(Object(m.s)(h));return[4,n(Ne(Object(r.__assign)(Object(r.__assign)({},e),{qosName:"sharedWithMe",itemSetKeyFacet:l.e,parentItemKeyFacet:a.e,getUrl:function(e){return d?h+"/drive/oneDrive.sharedWithMe":h+"/me/drive/sharedWithMe?expand=formats&allowExternal=true&$top=500"},filterChildItems:function(e){return!je(e,i)},sortChildItems:function(e){return(function(e,t,n,r){void 0===r&&(r=!1);var i=pe.t[pe.e],s=pe.t[pe.r],o=pe.t[Fe.t],u=pe.t[pe.n],a=pe.t[Fe.s];switch(t){case i:return ze(e,n,r,qe);case s:return ze(e,n,r,Ue);case o:case a:return ze(e,n,r,Re);case u:return ze(e,n,r,Ie);default:return e}})(e,s,o,!0)},onProcessResponse:u,groupChildItems:f})))];case 1:v=y.sent().itemResolver;n(v.execute());return[2]}})})}});var et=n(126),tt=n(321),nt=Object(i.t)(function(){return function(e){e(Object(et.t)({keyFacet:a.e,facets:[a.e,c.h,c.v,c.m,c.O,c.i,c.f,f.t,c.M,te.n]}));e(Object(et.t)({keyFacet:l.e,facets:[l.e,f.e]}));e(Object(u.r)(a.e,tt.e)(d));e(Object(u.r)(l.e,tt.e)(Ze))}}),rt=new b.e("sharedByMeRootItem",{endpoint:Object(b.s)()}),it=new b.e("sharedByMeItemSet",{driveItemKey:Object(b.o)(L.e)}),st=Object(i.i)()(function e(t){var n=this,i=t.itemKey,s=rt.deserialize(i);return function(t){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,o;return Object(r.__generator)(this,function(u){(n=new h.e({publisher:e})).resolveItems({items:(o={},o[i]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},f.t.pack({itemKey:it.serialize({driveItemKey:s})})),c.h.pack(p.s)),c.m.pack({})),c.M.pack(void 0)),o)});t(n.execute());return[2]})})}});var ot=Object(i.i)()(function(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,s,o;return Object(r.__generator)(this,function(u){switch(u.label){case 0:t=e.itemKey;i=it.deserialize(t).driveItemKey.endpoint;s=n(Object(m.s)(i));return[4,n(Ne(Object(r.__assign)(Object(r.__assign)({},e),{qosName:"sharedByMe",itemSetKeyFacet:it,parentItemKeyFacet:rt,getUrl:function(e){if(!s)throw new Error("Shared By You API is only supported on Consumer endpoints");return i+"/drive/shared"+"?$expand=thumbnails&$select=*,fileSystemInfo,folder,reactions,bundle"}})))];case 1:o=u.sent().itemResolver;n(o.execute());return[2]}})})}});var ut=Object(i.t)(function(){return function(e){e(Object(et.t)({keyFacet:rt,facets:[rt,c.h,c.v,c.m,c.O,c.i,c.f,f.t,c.M,te.n]}));e(Object(et.t)({keyFacet:it,facets:[it,f.e]}));e(Object(u.r)(rt,tt.e)(st));e(Object(u.r)(it,tt.e)(ot))}}),at=n(647),ft=n(421),lt=Object(i.i)()(function e(t){var n=this,i=t.itemKey,s=ft.e.deserialize(i);return function(t){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,o;return Object(r.__generator)(this,function(u){(n=new h.e({publisher:e})).resolveItems({items:(o={},o[i]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},f.t.pack({itemKey:at.e.serialize({driveItemKey:s,sortBy:"",isAscending:!0})})),c.h.pack(p.r)),c.m.pack({})),c.M.pack(void 0)),o)});t(n.execute());return[2]})})}});var ct=n(509);function ht(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,s,o,u;return Object(r.__generator)(this,function(r){switch(r.label){case 0:t=e.endpoint;i=n(Object(g.e)({getUserOneDriveEndpoint:x.v,graphEndpoint:x.m})),s=i.getUserOneDriveEndpoint;return(o=i.graphEndpoint)&&t!==o&&s?[4,n(s({endpoint:t}))]:[3,2];case 1:u=r.sent();t=u;r.label=2;case 2:return[2,t]}})})}}function pt(e){var t,n,r=e.name&&(t=e.name,n=".aspx",t.substr(t.length-n.length)===n),i=e.package||e.remoteItem&&e.remoteItem.package,s=i&&"oneNote"===i.type;return r||s||!1}var dt=Object(i.i)()(function e(t){var n=this;return function(i){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,s,o,u,a,l;return Object(r.__generator)(this,function(p){switch(p.label){case 0:n=i(Object(g.e)({saveForLaterGraphEndpoint:x.A})).saveForLaterGraphEndpoint;s=at.e.deserialize(t.itemKey);if(!n||n===s.driveItemKey.endpoint)return[3,1];s=Object(r.__assign)(Object(r.__assign)({},s),{driveItemKey:Object(r.__assign)(Object(r.__assign)({},s.driveItemKey),{endpoint:n})});return[3,3];case 1:return[4,i(ht({endpoint:s.driveItemKey.endpoint}))];case 2:(o=p.sent())!==s.driveItemKey.endpoint&&(s=Object(r.__assign)(Object(r.__assign)({},s),{driveItemKey:Object(r.__assign)(Object(r.__assign)({},s.driveItemKey),{endpoint:o})}));p.label=3;case 3:u=at.e.serialize(s);a=[{code:"provisioningNotAllowed",message:"You do not have permission to create this personal site or you do not have a valid license"},{code:"BadRequest",message:"Unable to retrieve user's mysite URL."},{code:"InvalidAuthenticationToken",message:"Access token has expired."},{code:"resourceBeingProvisioned",message:"The requested resource is being automatically provisioned. Please try again in a few minutes."}];return[4,i(Ne(Object(r.__assign)(Object(r.__assign)({},t),{itemKey:u,qosName:"savedForLater",itemSetKeyFacet:at.e,parentItemKeyFacet:ft.e,getUrl:function(e){if(e.driveItemKey.endpoint===n){return e.driveItemKey.endpoint+"/me/drive/following?top=5000&select="+["followed","name","parentReference","webDavUrl","webUrl","id","size","lastModifiedBy","lastModifiedDateTime","sharepointIds"].join(",")}return e.driveItemKey.endpoint+"/drives/me/followed?top=5000&select=*,webDavUrl"},onProcessResponse:function(t){var n,i,s=t.itemKey,o=t.driveItemKey,u=t.item,a=new h.e({publisher:e});if(o&&u){var l=L.e.serialize(o),p=ct.e.serialize({driveItemKey:o}),d=u&&(u.webDavUrl||u.webUrl);a.resolveItems({items:(n={},n[l]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},c.g.pack({itemKey:p})),c.i.pack(d)),c.v.pack(u.size)),n[p]=Object(r.__assign)(Object(r.__assign)({},c.E.pack(!0)),Object(y.e)().forFacet(c.E).thenInvalidate(s,f.e).pack()),n)});a.invalidateItems({items:(i={},i[s]=[f.e],i)})}return{itemResolver:a}},filterChildItems:pt,getDriveItemFacets:vt,mapItemSetKey:function(){var n,r=new h.e({publisher:e});r.mapKeys({mappings:(n={},n[u]=t.itemKey,n)});return{itemResolver:r}},expectedErrors:a})))];case 4:l=p.sent().itemResolver;i(l.execute());return[2]}})})}});function vt(e){var t=e.driveItem;return function(n){var i,s=t.root,o=t.remoteItem,u=t.name,a=s?p.t:u||o&&o.name||"",f=!t.webDavUrl,l=t.followed&&t.followed.followedDateTime,d=new h.e({publisher:vt});d.merge(n(Object(k.e)(Object(r.__assign)(Object(r.__assign)({},e),{shouldReturnShareFacets:!1}))).itemResolver);d.resolveItems({items:(i={},i[e.itemKey]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},c.d.pack(Object(k.t)(a,f))),l?c.a.pack(new Date(l).getTime()):{}),c.m.pack(f?{}:void 0)),i)});return{itemResolver:d}}}var mt=Object(i.t)(function(){return function(e){e(Object(et.t)({keyFacet:ft.e,facets:[ft.e,c.h,c.v,c.m,c.O,c.f,f.t,c.M]}));e(Object(u.r)(ft.e,tt.e)(lt));e(Object(u.r)(at.e,tt.e)(dt))}}),gt=n(379),yt=n(572),bt=n(1179),wt=n(422),Et=n(8),St=n(1195),xt=n(468),Tt=Object(Et.t)()(function(){return function(e){return Nt}});function Nt(e,t){var n=t.handlers,i=t.itemKey,s=e.demandItemFacet(wt.e,i);if(n&&s){for(var o=[],u=0,a=n;u<a.length;u++){var f=a[u];if(f.key===xt.o.key)o.push("photo");else if(f.key===xt.u.key)o.push("video");else if(f.key===xt.e.key)o.push("folder");else if(f.key===xt.s.key)o.push("onenote");else if(f.key===xt.r.key)o.push("!photo");else if(f.key===xt.i.key)o.push("!video");else if(f.key===xt.t.key)o.push("!folder");else if(f.key===xt.n.key)o.push("!onenote");else{var l=Object(St.e)(f);l&&o.push(l)}}return{itemKey:wt.e.serialize(Object(r.__assign)(Object(r.__assign)({},s),{filters:o}))}}return{}}var Ct=n(576),kt=n(248),Lt=n(150),At=Object(Et.t)()(Mt),Ot=Object(Et.t)()(Mt);function Mt(){return function(e){return function(e,t){var n=t.itemKey;if(n){var r=e.demandItemFacet(wt.e,n);if(r&&r.filters&&Object(Ae.e)({extFilters:Object(Ae.t)(r.filters),allowedMediaTypes:[Ce.e.photo,Ce.e.video],fileTypeIconMap:Lt.e}))return{defaultLayout:kt.e,isLayoutResolved:!0}}return{}}}}var _t=n(420),Dt=Object(i.i)()(function e(t){var n=this,i=t.itemKey,s=_t.e.deserialize(i);return function(t){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,o,u;return Object(r.__generator)(this,function(a){n=t(Object(g.e)({groupBy:x.L})).groupBy;(o=new h.e({publisher:e})).resolveItems({items:(u={},u[i]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},f.t.pack({itemKey:wt.e.serialize({driveItemKey:s,sortBy:"",isAscending:!0,groupBy:n||""})})),c.h.pack(p.n)),c.m.pack({})),c.M.pack(void 0)),u)});t(o.execute());return[2]})})}});var Pt,Ht=new b.e("recentGroup",{recentItemSet:Object(b.o)(wt.e),relativeTime:Object(b.r)({today:"today",yesterday:"yesterday",thisWeek:"thisWeek",lastWeek:"lastWeek",twoWeeksAgo:"twoWeeksAgo",threeWeeksAgo:"threeWeeksAgo",thisMonth:"thisMonth",lastMonth:"thisMonth",twoMonthsAgo:"twoMonthsAgo",older:"older"})});(function(e){e.today="today";e.yesterday="testerday";e.thisWeek="thisWeek";e.lastWeek="lastWeek";e.twoWeeksAgo="twoWeeksAgo";e.threeWeeksAgo="threeWeeksAgo";e.thisMonth="thisMonth";e.lastMonth="lastMonth";e.twoMonthsAgo="twoMonthsAgo";e.older="older"})(Pt||(Pt={}));function Bt(e){var t=new Date;return(function(e,t){return jt(t,e)})(e,t)?Pt.today:(function(e,t){return jt(new Date(t.getTime()-864e5),e)})(e,t)?Pt.yesterday:(function(e,t){var n=t.setHours(0,0,0,0)-864e5*t.getDay();return e.getTime()>n})(e,t)?Pt.thisWeek:(function(e,t){var n=t.setHours(0,0,0,0)-864e5*(t.getDay()+7);return e.getTime()>n})(e,t)?Pt.lastWeek:(function(e,t){var n=t.setHours(0,0,0,0)-12096e5;return e.getTime()>n})(e,t)?Pt.twoWeeksAgo:(function(e,t){var n=t.setHours(0,0,0,0)-18144e5;return e.getTime()>n})(e,t)?Pt.threeWeeksAgo:(function(e,t){return t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()})(e,t)?Pt.thisMonth:(function(e,t){var n=t.getMonth(),r=e.getMonth();return n-r==11||t.getFullYear()===e.getFullYear()&&t.getMonth()-e.getMonth()==1})(e,t)?Pt.lastMonth:(function(e,t){var n=t.getFullYear(),r=e.getFullYear(),i=t.getMonth(),s=e.getMonth(),o=n-r==1&&i-s==-10;return n===r&&i-s==2||o})(e,t)?Pt.twoMonthsAgo:Pt.older}function jt(e,t){return e.toDateString()===t.toDateString()}var Ft=new D.e("convergenceConfigurationFacet");function It(e){return e.reduce(function(e,t){return e&&t?"("+e+" or "+t+")":t||e})}function qt(e){return e.reduce(function(e,t){return e&&t?"("+e+" and "+t+")":t||e})}function Rt(e){return function(t){for(var n=void 0,r=void 0,i=0;i<e.length;i++){var s=e[i],o=!1,u=s;if("!"===s[0]){u=s.slice(1);o=!0}if("."===u[0])if(t.name){var a=new RegExp(u.toLocaleLowerCase()+"$"),f=t.name.toLocaleLowerCase().split(a),l=2===f.length&&""===f[1]||!1;o?n=void 0!==n?n&&!l:l:r=r||l}else{n=!1;r=!1}else if("folder"===u){var c=void 0!==t.folder||void 0!==t.remoteItem&&void 0!==t.remoteItem.folder||!1;o?n=void 0!==n?n&&!c:c:r=r||c}else if("onenote"===u){var h=t.package&&"oneNote"===t.package.type||t.remoteItem&&t.remoteItem.package&&"oneNote"===t.remoteItem.package.type||!1;o?n=void 0!==n?n&&!h:h:r=r||h}}return void 0===r?void 0!==n&&n:(void 0===n||n)&&!r}}var Ut=n(4298),zt=!ve.t.isActivated("2477F975-39B5-47B9-AA5F-C02028225BCB","10/27/2021","Updates ODC itemsscope Recent to use prefer APIVersion 2.0 header (instead of 2.1) in the case the user has been migrated.");var Wt=function(e,t){var n=new RegExp("^"+t+"\\/","i");return e.filter(function(e){var t=e&&e.remoteItem||e;return!(!t||!t.file)&&n.test(t.file.mimeType)})},Xt=Object(i.i)()(function(e){var t=this,n=wt.e.deserialize(e.itemKey),i=n.filters,s=void 0===i?[]:i,o=n.groupBy,u=void 0===o?"":o,a=n,l=Object(Ae.e)({extFilters:Object(Ae.t)(s),allowedMediaTypes:[Ce.e.photo,Ce.e.video],fileTypeIconMap:Lt.e}),p=Object(Ae.e)({extFilters:Object(Ae.t)(s),allowedMediaTypes:[Ce.e.photo],fileTypeIconMap:Lt.e}),d=Object(Ae.e)({extFilters:Object(Ae.t)(s),allowedMediaTypes:[Ce.e.video],fileTypeIconMap:Lt.e});return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,o,y,b,w,E,S,T,N,C,k,A,O,M,_,D,P,H,B,j,F,I,q,R,z,W,X,V,$,J,K,Q,G,Y;return Object(r.__generator)(this,function(Z){switch(Z.label){case 0:t=n(Object(g.e)({graphRecentEndpoint:x.b,enableOverflowRecentGroup:x.c,convergenceConfiguration:Ft})),i=t.graphRecentEndpoint,o=t.enableOverflowRecentGroup,y=t.convergenceConfiguration;if(!i)return[3,1];a=Object(r.__assign)(Object(r.__assign)({},a),{driveItemKey:Object(r.__assign)(Object(r.__assign)({},a.driveItemKey),{endpoint:i})});return[3,3];case 1:return[4,n(ht({endpoint:a.driveItemKey.endpoint}))];case 2:(b=Z.sent())!==a.driveItemKey.endpoint&&(a=Object(r.__assign)(Object(r.__assign)({},a),{driveItemKey:Object(r.__assign)(Object(r.__assign)({},a.driveItemKey),{endpoint:b})}));Z.label=3;case 3:w=wt.e.serialize(a);E=Ht.serialize({recentItemSet:a,relativeTime:"today"});S=Ht.serialize({recentItemSet:a,relativeTime:"yesterday"});T=Ht.serialize({recentItemSet:a,relativeTime:"thisWeek"});N=Ht.serialize({recentItemSet:a,relativeTime:"lastWeek"});C=Ht.serialize({recentItemSet:a,relativeTime:"twoWeeksAgo"});k=Ht.serialize({recentItemSet:a,relativeTime:"threeWeeksAgo"});A=Ht.serialize({recentItemSet:a,relativeTime:"lastMonth"});O=Ht.serialize({recentItemSet:a,relativeTime:"twoMonthsAgo"});M=Ht.serialize({recentItemSet:a,relativeTime:"older"});_=[];D=[];P=[];H=[];B=[];j=[];F=[];I=[];q=[];R="";z="date"===u;W=function(e){var t,n=e.driveItemKey,i=e.item,s=new h.e({publisher:W});if(i&&n){var o=i.remoteItem,u=o&&o.fileSystemInfo,a=u&&u.lastAccessedDateTime,f=L.e.serialize(n);if(z&&a){var l=new Date(a);switch(Bt(l)){case Pt.today:_.push(f);break;case Pt.yesterday:D.push(f);break;case Pt.thisWeek:P.push(f);break;case Pt.lastWeek:H.push(f);break;case Pt.twoWeeksAgo:B.push(f);break;case Pt.threeWeeksAgo:j.push(f);break;case Pt.lastMonth:F.push(f);break;case Pt.twoMonthsAgo:I.push(f);R=Ge.e[l.getMonth()];break;case Pt.older:default:q.push(f)}}s.resolveItems({items:(t={},t[f]=Object(r.__assign)({},c.m.pack(void 0)),t)});return{itemResolver:s}}};X=!l&&z?function(t){var n,i,s=new h.e({publisher:X});s.resolveItems({items:(n={},n[E]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},c.h.pack(Ut.s)),U.s.pack(!0)),f.e.pack({itemKeys:_})),n[S]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},c.h.pack(Ut.u)),U.s.pack(!0)),f.e.pack({itemKeys:D})),n[T]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},c.h.pack(Ut.r)),U.s.pack(!0)),f.e.pack({itemKeys:P})),n[N]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},c.h.pack(Ut.t)),U.s.pack(!0)),f.e.pack({itemKeys:H})),n[C]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},c.h.pack(Ut.o)),U.s.pack(!0)),f.e.pack({itemKeys:B})),n[k]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},c.h.pack(Ut.i)),U.s.pack(!0)),f.e.pack({itemKeys:j})),n[A]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},c.h.pack(Ut.e)),U.s.pack(!0)),f.e.pack({itemKeys:F})),n[O]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},c.h.pack(R)),U.s.pack(!0)),f.e.pack({itemKeys:I})),n[M]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},c.h.pack(Ut.n)),U.s.pack(!0)),f.e.pack({itemKeys:q})),n)});var u=[];_.length>0&&u.push(E);D.length>0&&u.push(S);P.length>0&&u.push(T);H.length>0&&u.push(N);B.length>0&&u.push(C);j.length>0&&u.push(k);F.length>0&&u.push(A);I.length>0&&u.push(O);q.length>0&&o&&u.push(M);s.resolveItems({items:(i={},i[e.itemKey]=Object(r.__assign)({},f.e.pack({itemKeys:u})),i)});return{itemResolver:s}}:void 0;V=n(Object(m.s)(a.driveItemKey.endpoint));$=[{code:"notAllowed",message:"You do not have permission to create this personal site or you do not have a valid license"},{code:"notAllowed",message:"Access to this site has been blocked. Please contact the administrator to resolve this problem."},{code:"notAllowed",message:"Operation not allowed"},{code:"BadRequest",message:"Tenant does not have a SPO license."},{code:"AccessDenied",message:"Access to this site has been blocked. Please contact the administrator to resolve this problem."},{code:"UnknownError",message:"401 UNAUTHORIZED"},{code:"503"},{code:"ItemNotFound"},{code:"activityLimitReached"},{code:"serviceNotAvailable"}];J=zt&&(null===(Y=y)||void 0===Y?void 0:Y.isUserMigrated)?"ApiVersion=2.0":"ApiVersion=2.1";return[4,n(Ne(Object(r.__assign)(Object(r.__assign)({},e),{qosName:l?"recentMedia":V?"ODC-recent":"recent",itemKey:w,itemSetKeyFacet:wt.e,parentItemKeyFacet:_t.e,getUrl:function(e){var t=Object(v.n)({endpoint:e.driveItemKey.endpoint,driveId:"me"})+"/recent?",n=ve.e.isActivated("022299AD-ACC7-4C1F-B2E8-010FBC126277","1/7/2022","Narrow filters for media queries");if(V)t=e.driveItemKey.endpoint+"/drive/view.recent?";else{if(p&&!n){return t=""+t+"$filter=(remoteItem/image ne null)"+"&"+"$expand=thumbnails"}if(d&&!n){return t=""+t+"$filter=(remoteItem/video ne null)"+"&"+"$expand=thumbnails"}if(l){return t=""+t+"$filter=(remoteItem/image ne null or remoteItem/video ne null)"+"&"+"$expand=thumbnails"}}return""+t+(function(e){if(!e||0===e.length)return"";for(var t=[],n=[],i=0;i<e.length;i++){var s=e[i],o=!1,u=s;if("!"===s[0]){u=s.slice(1);o=!0}"folder"===u?!o&&t.push("folder ne null"):"onenote"===u?o?n.push("(remoteItem/package/type ne 'oneNote' and package/type ne 'oneNote')"):t.push("(remoteItem/package/type eq 'oneNote' or package/type eq 'oneNote')"):"."!==u[0]||!o&&t.push("(endsWith(name, '"+u.toLowerCase()+"') or endsWith(remoteItem/name, '"+u.toLowerCase()+"'))")}return t.length>0||n.length>0?"&$filter="+(0===n.length?It(t):0===t.length?qt(n):qt(Object(r.__spreadArrays)([It(t)],n))):""})(s)},getDriveItemFacets:Vt,expectedErrors:$,preprocessResponse:function(e){p?e=Wt(e,"image"):d&&(e=Wt(e,"video"));return(function(e){if(!e)return e;return e.filter(function(e,t,n){return n.map(function(e){return e.id}).indexOf(e.id)===t})})(e.sort(function(e,t){var n=e.remoteItem&&e.remoteItem.fileSystemInfo&&e.remoteItem.fileSystemInfo.lastAccessedDateTime,r=t.remoteItem&&t.remoteItem.fileSystemInfo&&t.remoteItem.fileSystemInfo.lastAccessedDateTime;return n||r?n?r?n>r?-1:1:-1:1:0}))},additionalHeaders:l?{Prefer:J+",RecentOnlyMediaApp,NoPreAuthThumbnailUrls"}:{Prefer:J+";ODC,returnparentresource,returnowner"},onProcessResponse:W,groupChildItems:X})))];case 4:K=Z.sent().itemResolver;l&&K.resolveItems({items:(Q={},Q[e.itemKey]=Object(r.__assign)({},U.u.pack({})),Q)});K.mapKeys({mappings:(G={},G[w]=e.itemKey,G)});n(K.execute());return[2]}})})}});function Vt(e){return function(t){var n,i=new h.e({publisher:Vt});i.merge(t(Object(k.e)(e)).itemResolver);var s=e.driveItem,o=s.thumbnails,u=s.remoteItem,a=o||u&&u.thumbnails;i.resolveItems({items:(n={},n[e.itemKey]=Object(r.__assign)({},a?Object(r.__assign)({},ue.e.pack(!1)):{}),n)});return{itemResolver:i}}}var $t=Object(i.t)(function(){return function(e){e(Object(et.t)({keyFacet:_t.e,facets:[_t.e,c.h,c.v,c.m,c.O,c.f,f.t,c.M,te.n]}));e(Object(et.t)({keyFacet:wt.e,facets:[wt.e,f.e]}));e(Object(u.r)(_t.e,tt.e)(Dt));e(Object(u.r)(wt.e,tt.e)(Xt));e(Object(gt.e)(wt.e,bt.e)(Tt));e(Object(gt.e)(wt.e,Ct.e)(At));e(Object(gt.e)(wt.e,yt.e)(Ot))}}),Jt=n(145),Kt=!ve.t.isActivated("5F12686F-52A2-4E49-A1D8-A2AE7969622E","10/29/2021","True to use multiPart getItem api(ODC vroom) to avoid CORS."),Qt=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=L.e.deserialize(n);return function(s){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,o,u,a,f,l,c,h,p,d,y,b,w,E;return Object(r.__generator)(this,function(S){switch(S.label){case 0:t=i;return i.driveId&&"me"!==i.driveId?[3,2]:[4,s(ht({endpoint:i.endpoint}))];case 1:(o=S.sent())!==i.endpoint&&(t=Object(r.__assign)(Object(r.__assign)({},i),{endpoint:o}));S.label=2;case 2:u=Object(v.n)(t);a=s(Object(g.e)({disableRemoteItemInPlace:x.i})).disableRemoteItemInPlace;f=a?ye:q;return[4,s(Object(m.s)(t.endpoint))];case 3:l=S.sent();c=Kt&&l;return[4,s(Object(m.r)({url:Object(v.t)(t)+"?$expand=thumbnails",driveUrl:u,qosName:"getItem",useMultiPartIfSupported:c,endpoint:t.endpoint}))];case 4:h=S.sent();p=s(f({driveItemResponse:h,endpoint:t.endpoint})),d=p.itemResolver,y=p.actualItemKey;d.resolveItems({items:(b={},b[e.itemKey]=Object(r.__assign)({},Jt.r.pack(L.e)),b)});d.mapKeys({mappings:(w={},w[y]=n,w)});i.driveId&&"me"!==i.driveId||d.mapKeys({mappings:(E={},E[L.e.serialize(Object(r.__assign)(Object(r.__assign)({},i),{driveId:"me"}))]=L.e.serialize(Object(r.__assign)(Object(r.__assign)({},i),{driveId:""})),E[n]=L.e.serialize(t),E)});s(d.execute());return[2]}})})}});var Gt=Object(i.i)()(function e(t){var n=this,i=t.itemKey,s=w.deserialize(i),o=s.setItemKey,u=s.endpoint,a=s.token,l=b.e.get(o).deserialize(o),p=l.extFilters,d=l.driveItemKey,S=Object(v.n)(d),T=X.e.matches(o);return function(t){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,s,l,d,v,b,N,C,A,O,M,_,D,P,H,B,j,I,q,R,U,z,W,X,V;return Object(r.__generator)(this,function($){switch($.label){case 0:return[4,t(Object(m.s)(u))];case 1:n=$.sent();s=Kt&&n;return[4,t(Object(m.n)({endpoint:u,url:a,driveUrl:S,useMultiPartIfSupported:s,qosName:"getChildrenPage"}))];case 2:l=$.sent();d=p&&p.length>0?Rt(p):void 0;v=new h.e({publisher:e});b=[];for(N=0,C=l.value;N<C.length;N++){A=C[N];if(!(!!d&&d(A))){O=A&&(A.parentReference||A.remoteItem&&A.remoteItem.parentReference);M=O&&O.driveId;_=L.e.serialize({itemId:A.id,driveId:M,endpoint:u});D=null===(X=O)||void 0===X?void 0:X.id;P=(null===(V=O)||void 0===V?void 0:V.path)===F.e?F.r:D||void 0;H=O?L.e.serialize({itemId:P,driveId:M,endpoint:u}):void 0;B=t(Object(g.e)({allowDisableRemoteItemInPlace:x.i,processDriveItemFromSharePoint:x.N})),j=B.allowDisableRemoteItemInPlace,I=B.processDriveItemFromSharePoint;q=T&&j?ge:k.e;b.push(_);v.merge(t(q({itemKey:_,driveItem:A,endpoint:u,parentFolderItemKey:H})).itemResolver);v.resolveItems({items:(W={},W[_]=Object(r.__assign)({},Object(y.e)().forFacet(c.h).thenInvalidate(i,f.e).forFacet(c.l).thenInvalidate(i,f.e).pack()),W)});if(I){R=t(I.process({itemKey:_,driveItem:A})).itemResolver;v.merge(R)}}}if(U=l["@odata.nextLink"]){z=w.serialize({setItemKey:o,endpoint:u,token:U});v.merge(Object(E.t)({itemKey:z}).itemResolver);b.push(z)}v.merge(Object(E.e)({itemKey:i,itemSetKey:o,childItemKeys:b}).itemResolver);t(v.execute());return[2]}})})}});var Yt=n(154),Zt=n(718);var en=n(3585),tn=new D.e("enableListViewDataPrefetchConfiguration"),nn=new D.e("prefetchCacheConfiguration");function rn(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,s,o,u,a,l,c,p,d,y,b,w,E,S,x,T,N,k,A,O,M,_,P,H,B,j,F,I,q,z,W,V,$,J,K,Q,G,Y,ee,te,ne,re,ie,se,oe,ue,ae,fe,le,ce,he;return Object(r.__generator)(this,function(pe){switch(pe.label){case 0:t=e.itemKey,i=e.top,s=e.skip,o=e.disableRemoteItemInPlace;u=X.e.deserialize(t);a=u.driveItemKey,l=u.extFilters;c=u.sortBy,p=u.isAscending;d=u;y=a;return a.driveId&&"me"!==a.driveId?[3,2]:[4,n(ht({endpoint:a.endpoint}))];case 1:if((b=pe.sent())!==a.endpoint){y=Object(r.__assign)(Object(r.__assign)({},a),{endpoint:b});d=Object(r.__assign)(Object(r.__assign)({},u),{driveItemKey:y})}pe.label=2;case 2:w=L.e.serialize(y);E=Object(v.n)(y);return[4,n(Object(R.e)(function(e){return{isParentItemResolved:e.isItemFacetResolved(L.e,w),totalChildCount:e.isItemFacetResolved(U.e,w)?e.demandItemFacet(U.e,w):void 0,driveType:e.isItemFacetResolved(Z.e,w)?e.demandItemFacet(Z.e,w):void 0}}))];case 3:S=pe.sent(),x=S.isParentItemResolved,T=S.totalChildCount,N=S.driveType;k=n(Object(m.s)(y.endpoint));A=Kt&&k;O=n(Object(g.e)({convergenceConfiguration:Ft,enableListViewDataPrefetchConfiguration:tn,prefetchCache:nn})),M=O.convergenceConfiguration,_=O.enableListViewDataPrefetchConfiguration,P=O.prefetchCache;H=[{code:"notAllowed",message:"You do not have access to create this personal site or you do not have a valid license"},{code:"BadRequest",message:"Tenant does not have a SPO license."},{code:"AccessDenied",message:"Access to this site has been blocked. Please contact the administrator to resolve this problem."},{code:"UnknownError",message:"401 UNAUTHORIZED"},{code:"ItemNotFound"},{code:"503"},{code:"userContentMigrated"}];B=M&&M.canHandleUserMigration;j=Promise.resolve(void 0);if(!x){F=Object(v.t)(y);"getItem";I=function(){return n(Object(m.r)({url:F,driveUrl:E,useMultiPartIfSupported:A,qosName:"getItem",endpoint:y.endpoint,headers:k&&B?{Prefer:"Migration=EnableRedirect;FailOnMigratedFiles"}:void 0,expectedErrors:k?H:void 0}))};if(_&&P){G=P.getData({url:F,qosName:"getItem"});j=G?G.catch(I):I()}else j=I()}q=Object(v.t)(a);z=s?"&skiptoken="+(s+1)+"/"+T+"&skip="+s:"";W=k&&en.e?"&orderby=folder,savedSortFieldValue":"";V=c&&void 0!==p?Object(m.t)(c,p):W;$=(function(e){if(!e||0===e.length)return"";for(var t=[],n=[],i=0;i<e.length;i++){var s=e[i],o=!1,u=s;if("!"===s[0]){u=s.slice(1);o=!0}if("folder"===u&&1===e.length)!o&&t.push("folder ne null");else if("."!==u[0]);else{t=[];n=[]}}return t.length>0||n.length>0?"&$filter="+(0===n.length?It(t):0===t.length?qt(n):qt(Object(r.__spreadArrays)([It(t)],n))):""})(l);J=q+"/children?$top="+i+z+V+"&$expand="+("thumbnails"+(k?",lenses,tags":""))+"&select=*,ocr,webDavUrl"+$;"getChildren.folder";K=function(){return n(Object(m.r)({url:J,driveUrl:E,qosName:"getChildren.folder",useMultiPartIfSupported:A,endpoint:y.endpoint,headers:k&&B?{Prefer:"Migration=EnableRedirect;FailOnMigratedFiles"}:void 0,expectedErrors:H})).catch(function(t){throw n((function(e,t){var n=e.error;return function(i){var s,o=(function(e,t){var n=Object(D.n)({},{});e instanceof Zt.e&&(n=Object(Zt.t)(e,function(e){switch(e){case 404:return Yt.p.pack({});case 401:return Yt.e.pack({});case 0:return Yt.y.pack({domain:new C.e(t).domain})}})||Object(D.n)({},{}));return n})(n,t),u=Object(D.r)({itemNotFoundError:Yt.p,accessDeniedError:Yt.e,networkBlockedError:Yt.y},o),a=u.itemNotFoundError,l=u.accessDeniedError,c=u.networkBlockedError,p=new xe.e({facets:o,innerError:new xe.e(n)});if(a||l||c){var d=new h.e;d.updateItems({items:(s={},s[e.itemKey]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},f.e.pack(void 0)),f.o.pack(void 0)),Jt.e.pack(p)),s)});i(d.execute())}return p}})(Object(r.__assign)(Object(r.__assign)({},e),{error:t}),y.endpoint))})};if(_&&P){G=P.getData({url:J,qosName:"getChildren.folder"});Q=G?G.catch(K):K()}else Q=K();Y=[Q,j];ee=!1;if(!Ee.e(we.e.dataFetch.start)){Ee.t(we.e.dataFetch.start);ee=!0}return[4,Promise.all(Y)];case 4:te=pe.sent(),ne=te[0],re=te[1];ee&&Ee.t(we.e.dataFetch.end);if(re){re.folder&&(T=re.folder.childCount);re.parentReference&&re.parentReference.driveType&&(N=re.parentReference.driveType)}ie=n(Object(m.o)(y.endpoint,N));(se=new h.e({publisher:rn})).mapKeys({mappings:(ae={},ae[X.e.serialize(d)]=e.itemKey,ae[w]=L.e.serialize(u.driveItemKey),ae)});if(!u.driveItemKey.driveId||"me"===u.driveItemKey.driveId){(null===(he=null===(ce=re)||void 0===ce?void 0:ce.parentReference)||void 0===he?void 0:he.driveId)&&se.mapKeys({mappings:(fe={},fe[X.e.serialize(Object(r.__assign)(Object(r.__assign)({},d),{driveItemKey:Object(r.__assign)(Object(r.__assign)({},d.driveItemKey),{driveId:re.parentReference.driveId})}))]=e.itemKey,fe)});se.mapKeys({mappings:(le={},le[L.e.serialize(Object(r.__assign)(Object(r.__assign)({},u.driveItemKey),{driveId:"me"}))]=L.e.serialize(Object(r.__assign)(Object(r.__assign)({},u.driveItemKey),{driveId:""})),le)})}ue=(oe=se).merge;return[4,n(Se({itemKey:t,itemSetKeyFacet:X.e,parentItemKeyFacet:L.e,parentItemResponse:re,childItemsResponse:ne,disableRemoteItem:o,filterChildItems:l&&l.length>0?Rt(l):void 0,skip:s,enableRandomAccess:ie,totalChildCount:T,onProcessResponse:function(e){var t,n=e.driveItemKey,i=new h.e({publisher:rn});n&&i.resolveItems({items:(t={},t[L.e.serialize(n)]=Object(r.__assign)({},Jt.r.pack(L.e)),t)});return{itemResolver:i}}}))];case 5:ue.apply(oe,[pe.sent().itemResolver]);return[2,se]}})})}}var sn=Object(i.i)()(function(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i;return Object(r.__generator)(this,function(s){switch(s.label){case 0:t=n(Object(g.e)({pageSize:x.s})).pageSize;return[4,n(rn(Object(r.__assign)(Object(r.__assign)({},e),{disableRemoteItemInPlace:!0,skip:0,top:t||F.t})))];case 1:i=s.sent();Ee.t(we.e.resolveData.start);n(i.execute());Ee.t(we.e.resolveData.end);return[2]}})})}});var on=n(817),un=Object(i.t)(function(){return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(t){e(Object(on.e)(function(){e(Object(et.t)({keyFacet:X.e,facets:[X.e,f.e]}));e(Object(u.r)(X.e,tt.e)(sn))}));return[2]})})}}),an=n(42),fn=n(97),ln=n(350),cn=n(754),hn=Object(Et.t)()(function(){return function(e){return function(e,t){var n,i,s=Object(an.e)(e),o={},u=e.demandItemFacet(X.e,t.itemKey),a=e.demandItemFacet(L.e,t.itemKey),f=e.demandItemFacet(K.e,t.itemKey,{suppressGetItems:!0}),l=e.demandItemFacet(J,t.itemKey,{suppressGetItems:!0});if(ve.e.isActivated("09AA0112-641E-4D73-805E-DBCD89D22C3D","9/30/2021","Use new shortcutItemFacet for shortcut checks")){if(l&&t.itemKey){i={driveItemKey:l,sortBy:"",isAscending:!0};p=X.e.serialize(i);return Object(r.__assign)(Object(r.__assign)({},pn(e,{itemSetKey:p,parentItemKey:L.e.serialize(i.driveItemKey),stageItem:t.stageItem})),{itemKey:ln.e.serialize({localItemKey:t.itemKey,remoteItemKey:p})})}}else if(f&&t.itemKey){var h=e.demandItemFacet(L.e,f.itemKey);if(h){i={driveItemKey:h,sortBy:"",isAscending:!0};var p=X.e.serialize(i);return Object(r.__assign)(Object(r.__assign)({},pn(e,{itemSetKey:p,parentItemKey:L.e.serialize(i.driveItemKey),stageItem:t.stageItem})),{itemKey:ln.e.serialize({localItemKey:t.itemKey,remoteItemKey:p})})}}if(u){n=pn(e,{itemSetKey:X.e.serialize(u),parentItemKey:L.e.serialize(u.driveItemKey),stageItem:t.stageItem});o={itemKey:t.itemKey}}else{o=(p=(i=(function(e,t){var n=t.folderItemKey,i=t.currentItemSetKey;if(i&&n){var s=e.demandItemFacet(X.e,i),o=e.demandItemFacet(L.e,n);if(s&&o){if(!ve.e.isActivated("D8B0FDDF-555D-49A4-B069-D03ED692694A","11/4/2021","Do not emit item set key for non-folder items")&&o.itemId&&"root"!==o.itemId&&!e.demandItemFacet(c.m,n))return;var u=o.endpoint,a=o.driveId,f=o.itemId;return Object(r.__assign)(Object(r.__assign)({},s),{driveItemKey:{endpoint:u,driveId:a,itemId:f}})}}return})(e,{folderItemKey:t.itemKey,currentItemSetKey:s}))?X.e.serialize(i):void 0)?{itemKey:p}:{};n=i&&p&&pn(e,{itemSetKey:p,parentItemKey:L.e.serialize(i.driveItemKey),stageItem:t.stageItem})}var d=Object(cn.e)(e),v=d?e.demandItemFacet(L.e,d.localItemKey):void 0;if(d&&(i||o||a)){var m=v&&v.driveId,g=u&&u.driveItemKey&&u.driveItemKey.driveId||a&&a.driveId,y=i?X.e.serialize(i):u?X.e.serialize(u):a?L.e.serialize(a):void 0;if(m!==g&&y)return Object(r.__assign)({itemKey:ln.e.serialize({localItemKey:d.localItemKey,remoteItemKey:y})},n?{stageItem:n}:{})}return Object(r.__assign)(Object(r.__assign)({},o),n?{stageItem:n}:{})}}});function pn(e,t){var n=this,i=t.parentItemKey,s=t.itemSetKey,o=t.stageItem;if(i)return o?Object(fn.t)(function(e){var t=e.itemsScopeItemKey,u=e.currentItemKey;return function(e){return Object(r.__awaiter)(n,void 0,void 0,function(){var n;return Object(r.__generator)(this,function(a){switch(a.label){case 0:e(Object(et.e)({items:(n={},n[s]=Object(r.__assign)({},f.s.pack({itemKey:i})),n)}));return[4,e(o({currentItemKey:u,itemsScopeItemKey:t}))];case 1:a.sent();return[2]}})})}}):void 0}var dn=n(389),vn=new b.e("driveItemVirtualizedPage",{endpoint:Object(b.s)(),setItemKey:Object(b.s)(),skip:Object(b.i)(),top:Object(b.i)()}),mn=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=vn.deserialize(n),s=i.setItemKey,o=i.top,u=i.skip;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i;return Object(r.__generator)(this,function(a){switch(a.label){case 0:return[4,n(rn(Object(r.__assign)(Object(r.__assign)({},e),{itemKey:s,disableRemoteItemInPlace:!1,skip:u,top:o})))];case 1:(t=a.sent()).resolveItems({items:(i={},i[s]=Object(r.__assign)({},Object(y.e)().forFacet(f.e).thenInvalidate(e.itemKey,f.e).pack()),i)});n(t.execute());return[2]}})})}});var gn=n(1249),yn=new b.e("searchRootItem",{endpoint:Object(b.s)()}),bn=new b.e("searchItemSet",{driveItemKey:Object(b.o)(L.e),searchRootItemKey:Object(b.o)(yn),searchTerm:Object(b.s)()}),wn=Object(Et.t)()(function(){return function(e){return En}});function En(e,t){var n=t.handlers,i=t.itemKey,s=e.demandItemFacet(X.e,i),o=e.demandItemFacet(bn,i);if(n&&(s||o)){for(var u=[],a=0,f=n;a<f.length;a++){var l=f[a];if(l.key===xt.o.key)u.push("photo");else if(l.key===xt.u.key)u.push("video");else if(l.key===xt.e.key)u.push("folder");else if(l.key===xt.s.key)u.push("onenote");else if(l.key===xt.r.key)u.push("!photo");else if(l.key===xt.i.key)u.push("!video");else if(l.key===xt.t.key)u.push("!folder");else if(l.key===xt.n.key)u.push("!onenote");else{var c=Object(St.e)(l);c&&u.push(c)}}if(s)return{itemKey:X.e.serialize(Object(r.__assign)(Object(r.__assign)({},s),{extFilters:u}))}}return{}}var Sn=n(1248),xn=n(1275),Tn=n(1060),Nn=Object(Et.t)()(function(){return function(){return function(e,t){return{validator:Tn.e}}}});function Cn(e,t){return bn.serialize(Object(r.__assign)({driveItemKey:e.driveItemKey},t?{searchTerm:t}:{searchTerm:void 0}))}var kn=Object(Et.t)()(An),Ln=Object(Et.t)()(An);function An(){return function(e){return function(e,t){var n,r=t.itemKey,i=e.demandItemFacet(X.e,r);if(i)n=function(e){return i?Cn(i,e):void 0};else{var s=e.demandItemFacet(bn,r);n=function(e){return s?Cn(s,e):void 0}}return{isAvailable:!0,getSearchItemKey:n}}}}var On=n(1246),Mn=n(729),_n=n(872),Dn=n(838),Pn=n(756),Hn=n(684),Bn=n(588),jn=n(392),Fn=n(521),In=n(749),qn=new D.e("addToOneDrive"),Rn=new D.e("createFolder"),Un=new D.e("createLink"),zn=new D.e("delete"),Wn=new D.e("download"),Xn=new D.e("invite"),Vn=new D.e("move"),$n=new D.e("officeLens"),Jn=new D.e("rename"),Kn=new D.e("upload"),Qn=new b.e("commands",{endpoint:Object(b.s)(),driveId:Object(b.s)({shouldNormalizeToEmpty:!0})}),Gn=n(132),Yn=(new Gn.e("addToOneDrive",function(e,t){return rr(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:qn}))}),new Gn.e("canCreateFolder",function(e,t){return rr(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:Rn}))})),Zn=(new Gn.e("canCreateLink",function(e,t){return rr(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:Un}))}),new Gn.e("canDelete",function(e,t){return rr(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:zn}))})),er=new Gn.e("canDownload",function(e,t){return!e.demandItemFacet(W.i,t.itemKey)&&rr(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:Wn}))}),tr=(new Gn.e("canInvite",function(e,t){return rr(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:Xn}))}),new Gn.e("canMove",function(e,t){return rr(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:Vn}))}),new Gn.e("canUseOfficeLens",function(e,t){return rr(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:$n}))}),new Gn.e("canRename",function(e,t){return rr(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:Jn}))})),nr=new Gn.e("canUpload",function(e,t){return rr(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:Kn}))});function rr(e,t){var n=t.itemKey,r=t.commandFacet,i=e.demandItemFacet(L.e,n);if(!i)return!1;var s=i.endpoint,o=i.driveId,u=e.demandItemFacet(r,Qn.serialize({endpoint:s,driveId:o}));return!!u&&!!u.roles&&ir(e,{itemKey:n,oneOfRequiredRoles:u.roles})}function ir(e,t){var n=t.itemKey;return(function(e,t){var n=t.oneOfRequiredRoles,r=t.effectiveRoles;for(var i in r)if(i in n)return!0;return!1})(0,{oneOfRequiredRoles:t.oneOfRequiredRoles,effectiveRoles:(function(e,t){if((function(e,t,n){var r,i,s,o=e.demandItemFacet(G.e,t),u=null===(s=null===(i=null===(r=o)||void 0===r?void 0:r.owner)||void 0===i?void 0:i.user)||void 0===s?void 0:s.id;if(n&&u)return n.toUpperCase()===u.toUpperCase();return!o||!o.effectiveRoles||!o.owner})(e,t))return["read","write","owner"];var n=e.demandItemFacet(G.e,t);if(n&&n.effectiveRoles)return n.effectiveRoles;return[]})(e,n)})}var sr=Object(Et.t)()(function(){return function(){return function(e,t){var n=t.itemKey;return{isAvailable:e.demandItemFacet(Yn,n)}}}});var or=Object(Et.t)()(function(){return function(){return function(e,t){var n=t.itemKey;return{isAvailable:e.demandItemFacet(tr,n),validator:Tn.e}}}});var ur=n("react-lib"),ar=n(41),fr=n(4296),lr=Object(Et.t)()(function(){return function(){return function(e,t){var n=t.itemKey,r=e.demandItemFacet(Zn,n),i=e.demandItemFacet(J,n);return{isAvailable:r&&!i,deleteWizard:cr}}}});var cr=Object(ar.t)(function(e,t){var n=t.itemKeys,i=t.defaultRender,s=Object(r.__rest)(t,["itemKeys","defaultRender"]),o=void 0;1===n.length?o=Object(r.__assign)(Object(r.__assign)({},s),{deleteWizardStrings:Object(r.__assign)(Object(r.__assign)({},s.deleteWizardStrings),{confirmText:fr.e})}):n.length>0&&(o=Object(r.__assign)(Object(r.__assign)({},s),{deleteWizardStrings:Object(r.__assign)(Object(r.__assign)({},s.deleteWizardStrings),{confirmText:fr.t})}));var u=o||s;return i?ur.createElement(i,Object(r.__assign)({itemKeys:n},u)):null}),hr=Object(Et.t)()(function(){return function(){return function(e,t){var n=t.itemKey;return{isAvailable:e.demandItemFacet(nr,n)}}}});var pr=Object(Et.t)()(function(){return function(e){return dr}});function dr(e,t){if(1!==t.itemKeys.length)return{};var n=t.itemKeys[0];if(e.demandItemFacet(c.m,n))return{};var i=e.demandItemFacet(L.e,n),s=i?Object(v.t)(i):void 0,o=i?Object(v.n)(i):void 0,u=i&&i.endpoint||"";return{isAvailable:e.demandItemFacet(er,n),getDownloadData:s&&o?function(){return(function(e){var t=this,n=e.itemUrl,i=e.driveUrl,s=e.endpoint;return function(o){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,u,a,f;return Object(r.__generator)(this,function(r){switch(r.label){case 0:r.trys.push([0,2,,3]);return[4,o(Object(m.n)({url:e.itemUrl,driveUrl:i,method:"GET",qosName:"getItemDownloadUrl",endpoint:s}))];case 1:t=r.sent();if(!(u=(function(e){return 0===e.toLowerCase().lastIndexOf("https://graph.microsoft.com",0)})(n)?t["@microsoft.graph.downloadUrl"]:t["@content.downloadUrl"]))throw new Error("Unable to obtain download URL.");return[2,{method:"GET",url:u}];case 2:if((a=r.sent())instanceof Zt.e){f=Object(Zt.t)(a,function(e,t){switch(e){case"unauthenticated":case 401:return Yt.r.pack({});case"itemNotFound":case 404:return Yt.a.pack({});case"accessDenied":case 403:return Yt.e.pack({});default:return Yt.b.pack({})}});throw new xe.e({innerError:a,facets:f})}throw a;case 3:return[2]}})})}})({itemUrl:s,driveUrl:o,endpoint:u})}:void 0}}var vr=Object(Et.t)()(function(){return function(e){return mr}});function mr(e,t){var n=t.itemKey,i=e.demandItemFacet(L.e,n);return{isAvailable:!0,getShareLink:function(){return(function(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,s,o;return Object(r.__generator)(this,function(r){switch(r.label){case 0:if(!(t=e.driveItem))return[3,2];i=Object(v.t)(t)+"/invite";s=Object(v.n)(t);return[4,n(Object(m.r)({url:i,driveUrl:s,method:"POST",qosName:"getDefaultShareLink",endpoint:t.endpoint,headers:{prefer:"getDefaultLink","Content-type":"application/json"}}))];case 1:if(!(o=r.sent()))throw new Error("Unable to obtain default share URL");return[2,{url:o.value[0].link.webUrl,scope:o.value[0].link.scope}];case 2:throw new Error("Unable to obtain default share URL")}})})}})({driveItem:i})}}}var gr=Object(Et.t)()(function(){return function(){return function(){return{}}}});var yr=Object(Et.t)()(function(){return function(e){return br}});function br(e,t){var n=t.itemKey,i=t.link,s=t.recipients,o=e.demandItemFacet(L.e,n);return{isAvailable:!0,permissionInvite:function(){return(function(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,s,o,u,a,f,l,c,h,p,d;return Object(r.__generator)(this,function(r){switch(r.label){case 0:t=e.driveItem,i=e.link,s=e.recipients;if(!t||!i)throw new Error("Unable to obtain default share URL");o=t.endpoint;a=btoa(i);u="u!"+a.replace(/=/g,"").replace(/\//g,"_").replace(/\+/g,"-");f=s.map(function(e){return{email:e}});l={recipients:f,roles:["read"]};c=o.replace("v1.0","beta");h=c+"/shares/"+u+"/permission/grant";return[4,n(Object(m.r)({url:h,method:"POST",qosName:"permissionGrant",endpoint:t.endpoint,headers:{"Content-type":"application/json",Accept:"application/json"},body:l}))];case 1:p=r.sent();d=p.value[0].grantedToIdentities.map(function(e){return{email:e.user.email}});return[2,{recipients:d}]}})})}})({driveItem:o,link:i,recipients:s})}}}var wr=n(1097),Er=n(1422),Sr=new b.e("thumbnailToken",{endpoint:Object(b.s)(),driveId:Object(b.s)({shouldNormalizeToEmpty:!0})}),xr=n(3392),Tr=n(368),Nr=Object(Et.t)()(function(){return function(e){return Cr}});function Cr(e,t){var n=t.itemKey,r=t.desiredSize,i=t.fitMode,s=e.demandItemFacet(L.e,n);if(!s)return{};var o=e.demandItemFacet(ue.e,n)?(function(e,t){var n=t.itemKey,r=t.desiredSize,i=t.fitMode,s=(function(e){return e&&(t=e,t&&"number"==typeof t.length)?e[0]:e;var t})(e.demandItemFacet(V.e,n));if(s&&s.large)return{url:Or(s.large.url,r,i),width:0,height:0}})(e,{itemKey:n,driveItem:s,desiredSize:r,fitMode:i}):(function(e,t){var n=t.itemKey,r=t.driveItem,i=t.desiredSize;if(r.endpoint.indexOf("/_api/v2.")>-1){var s=e.demandItemFacet(c.i,n),o=e.demandItemFacet(c.p,n,{suppressGetItems:!0})||"";if(s){var u=new C.e(r.endpoint).authority+"/_api/v2.1",a=Sr.serialize({endpoint:u,driveId:r.driveId}),f=e.demandItemFacet(xr.e,a);if(f){var l=Object(v.t)({endpoint:u,driveId:r.driveId,itemId:r.itemId}),h=Math.ceil(i.width),p=Math.ceil(i.height);return{url:l+"/thumbnails/0/c"+h+"x"+p+"/content?"+Object(Tr.e)({prefer:"noredirect,closestavailablesize",cb:o,access_token:{uriValue:f}}),width:0,height:0}}}}})(e,{itemKey:n,driveItem:s,desiredSize:r});return o?{thumbnail:o}:{}}var kr=/width=[0-9]*/,Lr=/height=[0-9]*/,Ar=/cropmode=[a-z]*/;function Or(e,t,n){if(!ve.e.isActivated("AB808229-F141-4F5A-B7E9-C1DEF8EC6F64","10/21/2021","Enable crop mode for folder cover thumbnail")){var r="cover"===n?"center":"none";Ar.test(e)?e=e.replace(Ar,"cropmode="+r):e+=(e.indexOf("?")>-1?"&":"?")+"cropmode="+r}var i="number"==typeof t.width?Math.ceil(t.width):t.width,s="number"==typeof t.height?Math.ceil(t.height):t.height,o=""+(i||"");kr.test(e)?e=e.replace(kr,"width="+o):e+=(e.indexOf("?")>-1?"&":"?")+"width="+o;var u=""+(s||"");Lr.test(e)?e=e.replace(Lr,"height="+u):e+=(e.indexOf("?")>-1?"&":"?")+"height="+u;return e}var Mr=n(561),_r=n(3105),Dr=Object(i.t)(function(){return function(e){var t=e(Object(g.e)({useBatchedDeleteConfiguration:x._})).useBatchedDeleteConfiguration;e(Object(et.t)({keyFacet:L.e,facets:[L.e,c.h,c.v,c.m,K.e,J,c.O,c.f,f.t,c.M,c.i,c.p,te.n]}));e(Object(et.t)({keyFacet:w,facets:[w,f.e,f.r]}));e(un);e(Object(u.r)(L.e,tt.e)(Qt));e(Object(u.r)(vn,tt.e)(mn));e(Object(u.r)(w,tt.e)(Gt));e(Object(gt.e)(L.e,dn.e)(hn));e(Object(gt.e)(X.e,dn.e)(hn));e(Object(gt.e)(X.e,_r.e)(kn));e(Object(gt.e)(X.e,bt.e)(wn));e(Object(u.r)(L.e,On.t)(Object(i.r)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([11],4737)];case 1:return[2,e.sent().driveItemCreateFolderOperationHandler]}})})})));e(t?Object(u.r)(L.e,Mn.e)(Object(i.r)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee(0,4738)];case 1:return[2,e.sent().driveItemDeleteItemsBatchedOperationHandler]}})})})):Object(u.r)(L.e,Mn.e)(Object(i.r)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([12],3937)];case 1:return[2,e.sent().driveItemDeleteItemsOperationHandler]}})})})));e(Object(u.r)(L.e,_n.t)(Object(i.r)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([14],4739)];case 1:return[2,e.sent().driveItemRenameItemOperationHandler]}})})})));e(Object(u.r)(L.e,Dn.t)(Object(i.r)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([15],4956)];case 1:return[2,e.sent().driveItemUploadItemsOperationHandler]}})})})));e(Object(u.r)(L.e,Sn.t)(Object(i.r)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([13],4740)];case 1:return[2,e.sent().driveItemMoveCopyItemsOperationHandler]}})})})));e(Object(u.r)(L.e,gn.e)(Object(i.r)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([10],4741)];case 1:return[2,e.sent().addToOneDriveOperationHandler]}})})})));e(Object(gt.e)(L.e,Pn.e)(sr));e(Object(gt.e)(L.e,xn.e)(Nn));e(Object(gt.e)(L.e,Hn.e)(or));e(Object(gt.e)(L.e,Bn.t)(lr));e(Object(gt.e)(L.e,jn.e)(hr));e(Object(gt.e)(L.e,wr.e)(vr));e(Object(gt.e)(L.e,Er.e)(yr));e(Object(gt.e)(L.e,Fn.e)(pr));e(Object(gt.e)(L.e,In.e)(gr));e(Object(gt.e)(L.e,Mr.e)(Nr))}}),Pr=Object(i.i)()(function e(t){var n=this;return function(i){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,s,o,u,a,f,l;return Object(r.__generator)(this,function(c){switch(c.label){case 0:n=t.itemKey;s=Qn.deserialize(n);o=s.endpoint;u=Object(v.n)(s);return[4,i(Hr({url:Object(v.e)(s),driveUrl:u,qosName:"commands",endpoint:o}))];case 1:a=c.sent();(f=new h.e({publisher:e})).resolveItems({items:(l={},l[n]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},qn.pack(a.addToOneDrive)),Rn.pack(a.createFolder)),Un.pack(a.createLink)),zn.pack(a.delete)),Wn.pack(a.download)),Xn.pack(a.invite)),Vn.pack(a.move)),$n.pack(a.officeLens)),Jn.pack(a.rename)),Kn.pack(a.upload)),l)});i(f.execute());return[2]}})})}});function Hr(e){var t=this;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){return Object(r.__generator)(this,function(e){return[2,{addToOneDrive:{roles:["write"]},createFolder:{roles:["owner","write"]},createLink:{defaultScope:"anonymous",linkTypes:["view","edit"],scopes:["anonymous","application"]},delete:{roles:["owner","write"]},download:{roles:["owner","write","read"]},invite:{roles:["owner","write"]},move:{roles:["owner","write"]},officeLens:{extensions:["jpeg","jpg","jpe"],lensNames:["officeLens"],roles:["owner"]},rename:{roles:["owner","write"]},upload:{roles:["owner","write"]}}]})})}}var Br=Object(i.t)(function(){return function(e){e(Object(et.t)({keyFacet:Qn,facets:[qn,Rn,Un,zn,Wn,Xn,Vn,$n,Jn,Kn]}));e(Object(u.r)(Qn,tt.e)(Pr))}}),jr=Object(i.i)()(function(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,s,o,u,a,f;return Object(r.__generator)(this,function(l){switch(l.label){case 0:t=[{code:"AccessDenied",message:"Access to this site has been blocked. Please contact the administrator to resolve this problem."},{code:"UnknownError",message:"401 UNAUTHORIZED"},{code:"503"},{code:"ItemNotFound"},{code:"activityLimitReached"},{code:"serviceNotAvailable"}];i=bn.deserialize(e.itemKey),s=i.searchRootItemKey,o=i.searchTerm;return[4,n(Ne(Object(r.__assign)(Object(r.__assign)({},e),{qosName:"search",itemSetKeyFacet:bn,parentItemKeyFacet:yn,getUrl:function(e){var t,r=e.driveItemKey;o&&(t=encodeURIComponent(o));return n(Object(m.s)(r.endpoint))?Object(v.t)(r)+"/oneDrive.search(q='"+t+"')?$expand=thumbnails&select=*,webDavUrl":Object(v.t)(r)+"/search(q='"+t+"')?$expand=thumbnails&select=*,webDavUrl"},expectedErrors:t})))];case 1:u=l.sent().itemResolver;(a=s&&yn.serialize(s))&&u.resolveItems({items:(f={},f[a]=Object(r.__assign)({},c.h.pack(Ke.format(p.i,o))),f)});n(u.execute());return[2]}})})}});var Fr=Object(i.t)(function(){return function(e){e(Object(u.r)(bn,tt.e)(jr));e(Object(gt.e)(bn,_r.e)(Ln));e(Object(et.t)({keyFacet:bn,facets:[f.e]}))}}),Ir=n(4561),qr=n(3919),Rr=n(668),Ur=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=Q.e.deserialize(n).driveItemKey,s=i.endpoint;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,o,u,a,f,l,h,p=this;return Object(r.__generator)(this,function(d){t={Caller:"HoverCard"};o=e(Object(g.e)({enableCookiesForAnalyticsRequests:x.a})).enableCookiesForAnalyticsRequests,u=void 0!==o&&o;"GetItemAnalytics_addon-graph";a=Object(r.__awaiter)(p,void 0,void 0,function(){var o,a,f,l,h,p;return Object(r.__generator)(this,function(d){switch(d.label){case 0:return[4,e(Object(m.r)({url:(g=Object(v.t)(i),y=zr(g),b="$expand=analytics($expand=allTime($expand=activities))",w="$select=*,id,reactions,trending",E=w+"&"+b+",insights($expand=keyPoints)",S=y+"?"+E,S),qosName:"GetItemAnalytics_addon-graph_GetAnalyticsSections",endpoint:s,timeout:6e3,headers:t,driveUrl:zr(Object(v.n)(i)),allowCookies:u}))];case 1:o=d.sent();a=Object(Ir.t)(o);if(f=a.createdBy){l=H.e.serialize({email:f.email,endpoint:s});e(Object(et.e)({items:(h={},h[l]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},c.h.pack(f.displayName)),_.e.pack(f.email)),_.r.pack(f.image)),_.i.pack(f.id)),h[n]=Object(r.__assign)({},O.r.pack({itemKey:l,displayValue:f.displayName})),h)}))}e(Object(et.e)({items:(p={},p[n]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},O.h.pack(a.viewCount)),O.p.pack(a.viewerCount)),O.o.pack(a.isTrending)),O.e.pack(a.activities)),O.f.pack(a.likeCount)),O.t.pack(a.commentCount)),O.a.pack(a.lifeCycleStatus)),O.u.pack(a.keyPointsData)),O.s.pack(a.incompleteData)),O.i.pack(a.createdDateTime)),p)}));return[2]}var g,y,b,w,E,S})});f=[a];l=Object(r.__awaiter)(p,void 0,void 0,function(){var o,a,f,l;return Object(r.__generator)(this,function(c){switch(c.label){case 0:return[4,e(Object(m.r)({url:(h=Object(v.t)(i),p=zr(h),p+"?$expand=recommendedActionSet($expand=nonAggregatedRecommendedActions,aggregatedEditRecommendedAction($expand=importantActorsAndActivities)),conversationSet($expand=emailConversations($expand=participants),meetingConversations($expand=participants),teamsConversations($expand=participants))"),qosName:"GetItemAnalytics_addon-graph_GetRecommendedActionsAndConversations",endpoint:s,timeout:6e3,headers:t,driveUrl:zr(Object(v.n)(i)),allowCookies:u}))];case 1:o=c.sent();a=(function(e){var t=e.recommendedActionSet,n=t.nonAggregatedRecommendedActions;t.aggregatedEditRecommendedAction&&t.aggregatedEditRecommendedAction.recentEditorCount&&(n=n.concat(t.aggregatedEditRecommendedAction));return n})(o);f=(function(e){var t=e.conversationSet,n=t.emailConversations.concat(t.meetingConversations,t.teamsConversations),r={},i=[];n.forEach(function(e){var t=e.teamsMessageThreadId||e.conversationInstance.conversationId;if(!r.hasOwnProperty(t)){r[t]=!0;i.push({activityTimestamp:e.conversationInstance.sharedByTime,context:e.conversationInstance.subject,conversationType:qr.e[e.conversationInstance.referenceType],deepLink:e.conversationInstance.deepLink,referencePreview:e.conversationInstance.referencePreview,isSharedByMe:e.conversationInstance.isSharedByMe,sharedByUserDisplayName:e.sharedByUser.displayName,sharedByUserEmail:e.sharedByUser.email,participants:e.participants})}});return i.sort(function(e,t){return Date.parse(t.activityTimestamp)-Date.parse(e.activityTimestamp)})})(o);e(Object(et.e)({items:(l={},l[n]=Object(r.__assign)(Object(r.__assign)({},O.l.pack(a)),O.n.pack(f)),l)}));return[2]}var h,p})});f.push(l);e(Object(et.e)({items:(h={},h[n]=Object(r.__assign)({},O.c.pack([])),h)}));return[2,Object(Rr.e)(f)]})})}});function zr(e){return e.replace("2.0","2.1")}var Wr=Object(i.t)(function(){return function(e){e(Object(et.t)({keyFacet:Q.e,facets:[O.h]}));e(Object(u.r)(Q.e,tt.e)(Ur))}}),Xr=n(3035),Vr=n(911),$r=n(291),Jr=Object(i.n)({maxParallelOperationCount:1,maxItemCountPerBatch:20,areSameBatch:function(e,t){var n=A.e.deserialize(e.itemKey).driveItemKey,r=n.endpoint,i=n.driveId,s=A.e.deserialize(t.itemKey).driveItemKey,o=s.endpoint,u=s.driveId;return!!i&&!!u&&i===u&&r===o}})(function e(t){var n=this,i=t.items;return function(t){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,s,o,u,a,f,l,p,d,g,b,w,E,S,x,T,N,C,k,O,M,_,D,P,H,B,j,F,I,q,R;return Object(r.__generator)(this,function(U){switch(U.label){case 0:n=Object.keys(i);s=n[0];o=A.e.deserialize(s);u=o.driveItemKey,a=u.endpoint,f=u.driveId;if(!a)throw new Error("No endpoint to determine activity items.");l=n.map(function(e){return A.e.deserialize(e).driveItemKey.itemId});p=Object(v.n)({endpoint:(z=a,z.replace("2.1","2.0")),driveId:f});d=p+"/ExtendedActivitiesForItems";g={driveItems:l,badgeOnly:!0};return[4,t(Object(m.n)({url:d,method:"POST",body:g,qosName:"ItemActivityFieldDataSource.extendedActivitiesForItems",endpoint:a}))];case 1:if((b=U.sent()).value){w=(function(e){for(var t={},n=0,r=e;n<r.length;n++){var i=r[n],s=i.driveItemId;if(s){(t[s]||(t[s]=[])).push(i)}}return t})(b.value);E=0;S=0;x=0;T=0;N=new h.e({publisher:e});for(C=0,k=n;C<k.length;C++){O=k[C];E++;M=A.e.deserialize(O);_=M.driveItemKey.itemId;D=_&&w[_];P=L.e.serialize(M.driveItemKey);H=void 0;if(D){B=new Xr.e;j=B.processResponse({item:{name:_||"",relativePath:"",absolutePath:"",isFolder:!1,graphItemUrl:d},response:{value:D,"@odata.nextLink":""}}).activities;F=Kr(j);if(I=Qr(j)){x++;S++;if(!F){T++;q=Gr(I,O).itemResolver;N.merge(q);H=I}}}N.resolveItems({items:(R={},R[O]=Object(r.__assign)({},Vr.e.pack(H)),R[P]=Object(r.__assign)({},Object(y.e)().forFacet(c.e).thenInvalidate(O,Vr.e).pack()),R)})}t(N.execute());t(Object($r.e)({name:"ItemActivityField.View",extraData:{activityFieldProcessedItemCount:E,activityFieldEligibleItemCount:S,activityFieldActiveItemCount:x,activityFieldBadgedItemCount:T,activityFieldBadgedPercent:E?Math.round(T/E*100):0},isIntentional:!1}))}return[2]}var z})})}});function Kr(e){var t=e[0];return!!t&&1===t.actors.length&&t.actors[0].self&&!t.type||!1}function Qr(e){var t=e[0],n={};if(t)for(var i=0,s=t.actors;i<s.length;i++){(l=s[i]).id&&(n[l.id]=!0)}for(var o=Object(r.__assign)(Object(r.__assign)({},t),{actors:Object(r.__spreadArrays)(t.actors||[])}),u=1;u<e.length;u++)for(var a=0,f=e[u].actors;a<f.length;a++){var l;if("string"==typeof(l=f[a]).id&&!n[l.id]){o.actors.push(l);n[l.id]=!0}}return o||t}function Gr(e,t){var n=new h.e({publisher:Gr}),i=A.e.deserialize(t).driveItemKey,s=(function(e){var t=e.actors,n=e.action.mention&&e.action.mention.mentionees||[],i=e.action.share&&e.action.share.recipients||[],s=e.action.commentResponse&&e.action.commentResponse.commentAuthor,o=Object(r.__spreadArrays)(t,n,i);s&&o.push(s);return o})(e);if(s.length>0){var o=Yr(s,i).itemResolver;n.merge(o)}return{itemResolver:n}}function Yr(e,t){for(var n=new h.e({publisher:Yr}),r=0,i=e;r<i.length;r++){var s=Zr(i[r],t).itemResolver;n.merge(s)}return{itemResolver:n}}function Zr(e,t){var n=new h.e({publisher:Zr}),r=j({itemKey:L.e.serialize(t),userKey:H.e.serialize({email:e.email||"",endpoint:t.endpoint}),user:{displayName:e.displayName,email:e.email}}).itemResolver;n.merge(r);return{itemResolver:n}}var ei=Object(i.t)(function(){return function(e){e(Object(u.r)(A.e,tt.e)(Jr));e(Object(u.r)(A.e,tt.e)(Jr))}}),ti=n(65),ni=Object(i.i)({mergeForSameItemKey:!1})(function e(t){var n=this,i=t.itemKey,s=t.options,o=s.isFollowed,u=s.progressItemKey,a=ct.e.deserialize(i),f=a.driveItemKey,l=f.itemId,p=void 0===l?"":l,d=Object(v.n)(f);return function(t){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,i,s,l,v,y,b,w,E;return Object(r.__generator)(this,function(S){switch(S.label){case 0:n=t(Object(g.e)({saveForLaterGraphEndpoint:x.A})).saveForLaterGraphEndpoint;i=new h.e({publisher:e});s=ct.e.serialize(a);l=n||f.endpoint;u&&t(Object(et.e)({items:(b={},b[u]=Object(r.__assign)({},ti.b.pack({itemKey:L.e.serialize(f)})),b)}));v=o?{url:l+"/drives/"+f.driveId+"/items/"+p+"/follow",method:"POST",qosName:"followItem"}:{url:l+"/drives/"+f.driveId+"/following/"+p,method:"DELETE",qosName:"unfollowItem"};S.label=1;case 1:S.trys.push([1,3,,4]);return[4,t(Object(m.n)({url:v.url,driveUrl:d,method:v.method,qosName:v.qosName,endpoint:l}))];case 2:S.sent();i.invalidateItems({items:(w={},w[s]=[c.E],w)});i.resolveItems({items:(E={},E[s]=Object(r.__assign)({},c.E.pack(o||void 0)),E)});t(i.execute());return[3,4];case 3:y=S.sent();throw new Error(y.message);case 4:return[2]}})})}});var ri=n(605),ii=n(1597),si=n(28),oi=n(160),ui=Object(i.n)()(function e(t){var n=this,i=t.items;return function(t){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,s,o,u,a,l,p,d,v,m,g,b,w,E,S,x,T;return Object(r.__generator)(this,function(N){switch(N.label){case 0:return[4,t(Object(R.e)(function(e){return e.demandItemFacet(si.p,oi.e)}))];case 1:if(!N.sent())return[2];n=Object.keys(i);s=n[0];o=ct.e.deserialize(s);if(!(u=o.driveItemKey.endpoint))throw new Error("No endpoint to determine followed items.");a=at.e.serialize({driveItemKey:{endpoint:u},sortBy:"",isAscending:!0});return[4,t(Object(ii.e)(function(e){return e.demandItemFacet(f.e,a)}))];case 2:l=N.sent();p=l&&l.itemKeys||[];d=new h.e({publisher:e});v={};for(m=0,g=p;m<g.length;m++){S=g[m];v[S]=!0}for(b=0,w=n;b<w.length;b++){E=w[b];S=ct.e.deserialize(E).driveItemKey;x=!!v[L.e.serialize(S)];d.resolveItems({items:(T={},T[E]=Object(r.__assign)(Object(r.__assign)({},c.E.pack(x||void 0)),Object(y.e)().forFacet(c.E).thenInvalidate(a,f.e).pack()),T)})}t(d.execute());return[2]}})})}});var ai=Object(i.t)(function(){return function(e){e(Object(et.t)({keyFacet:ct.e,facets:[c.E]}));e(Object(u.r)(ct.e,tt.e)(ui));e(Object(u.r)(ct.e,ri.e)(ni))}}),fi=new b.e("sharesItem",{endpoint:Object(b.s)(),shareId:Object(b.s)()}),li=n(281),ci=Object(i.i)({maxParallelOperationCount:8})(function e(t){var n=this,i=t.itemKey,s=fi.deserialize(i),o=s.endpoint;return function(t){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,u,a,l,c,p,d,y,b,w,E,S,T,N,C,A;return Object(r.__generator)(this,function(O){switch(O.label){case 0:n=t(Object(g.e)({graphEndpoint:x.m,graphRecentEndpoint:x.b})),u=n.graphEndpoint,a=n.graphRecentEndpoint;return[4,t(Object(m.n)({url:Object(v.r)(s)+"?$expand=thumbnails&select=*,webDavUrl",qosName:"getSharesItem",endpoint:o,headers:{Prefer:"redeemSharingLinkIfNecessary"}}))];case 1:l=O.sent();c=new h.e({publisher:e});p=l&&l.parentReference;d=p&&p.driveId;y={endpoint:o,driveId:d,itemId:l.id};b=L.e.serialize(y);w=p&&p.id?L.e.serialize({endpoint:o,driveId:d,itemId:p.id}):void 0;c.merge(t(Object(k.e)({itemKey:b,driveItem:l,endpoint:o,parentFolderItemKey:w})).itemResolver);E=t(Object(g.e)({processDriveItemFromSharePoint:x.N})).processDriveItemFromSharePoint;S=o.indexOf("/_api/v2.0")>-1||o.indexOf("/_api/v2.1")>-1;T=u||a;if(E&&(S||T)){N=t(E.process({itemKey:b,driveItem:l})).itemResolver;c.merge(N)}c.resolveItems({items:(C={},C[b]=Object(r.__assign)(Object(r.__assign)({},li.n.pack(L.e)),f.t.pack({itemKey:X.e.serialize({driveItemKey:y,sortBy:"",isAscending:!0})})),C)});c.mapKeys({mappings:(A={},A[b]=i,A)});t(c.execute());return[2]}})})}});var hi=Object(i.t)(function(){return function(e){e(Object(u.r)(fi,tt.e)(ci))}}),pi=Object(i.t)(function(){return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(t){e(Dr);e(Br);e(Wr);e(o.e);e(s.e);e($t);e(nt);e(ut);e(mt);e(Fr);e(ei);e(ai);e(hi);return[2]})})}}),di=n(758),vi=n(89),mi=Object(i.t)(function(){return function(e){e(Object(gt.e)(L.e,di.e)(Object(Et.n)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(t){switch(t.label){case 0:return[4,e(Object(vi.o)())];case 1:t.sent();return[4,n.ee(95,4709)];case 2:return[2,t.sent().driveItemActivityFieldControlHandler]}})})})))}}),gi=n(412),yi=n(641),bi=n(74),wi=n(201),Ei=n(569),Si=n(364),xi=Object(bi.i)({key:new D.e("dateAccessedColumn").id,name:wi.e,fieldName:"",minWidth:bi.e.regularMin,maxWidth:bi.e.regularMax,isCollapsable:!0},Ei.e)(function(e,t){var n=e.demandItemFacet(c.o,t,{suppressGetItems:!0}),r=n&&new Date(n).getTime();if("number"!=typeof r||isNaN(r))return{text:""};var i=e.demandItemFacet(si.N,oi.e),s=i&&i.language||window.navigator.language;return s?{text:Object(Si.n)(new Date(r),s)}:{dateValue:r}},function(e,t){return""+e.demandItemFacet(c.o,t)}),Ti=n(3034),Ni=Object(Et.t)()(function(){return function(e){return ki}});var Ci=[yi.t,Ti.e,xi];function ki(e,t){return{columns:Ci}}var Li=n(388),Ai=n(413),Oi=n(199),Mi=n(63),_i=n(557),Di=n(1201),Pi=n(327),Hi=n(14),Bi=n(1643),ji=n(22),Fi=n(29),Ii=n(20),qi=new Ii.e("openInOfficeOnlineActionControl"),Ri=n(56),Ui=n(188),zi=Ui.n.isFeatureEnabled({ODC:"WebConvergenceEnabled"}),Wi=Object(ar.e)(function(e,t){var n=t.itemKey,i=e.demandItem({openUrl:c.O,appFacet:ne.e,isMalwareDetected:c.k},n),s=i.openUrl,o=i.appFacet,u=i.isMalwareDetected,a=e.dispatch,f=!u&&!!o&&!!s,l=e.demandItemFacet(qi,n);return Object(r.__assign)({isAvailable:f,onExecute:s?function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var e,t,i,o,u,f,c;return Object(r.__generator)(this,function(r){e=(new Date).getTime().toString();t=Bi.e.AddWopiPerfMarkToTargetUrl(e,"ItemsView",s);i=a(Object(R.e)(function(e){return qi.evaluate(l)(e,{itemKey:n,forceInSameWindow:!1})})).forceInSameWindow;if(zi){o=new Ri.t(t);if(-1!==o.getHost().indexOf("my.microsoftpersonalcontent.com")){(u=new Ri.t("https://onedrive.live.com/edit.aspx")).setQuery(o.getQuery());f=o.getPathSegments();c=f[1];u.setQueryParameter("cid",c);t=u.toString()}}i?window.location.href=t:window.open(t);return[2]})})}:void 0},Object(Fi.t)(e,{itemKey:n,engagement:{name:"OpenInOfficeOnline",isIntentional:!0}}))})(ji.e),Xi=Object(Hi.s)()(Object(Hi.r)()(Wi)),Vi={key:new D.e("openInOfficeOnline").id,automationId:"openInOfficeOnlineCommand",action:ur.createElement(Xi,null),facets:Object(r.__assign)({},Mi.t.pack(!0))},$i=n(88),Ji=n(1429),Ki=new Ii.e("openInOfficeClientActionControl"),Qi=new $i.e,Gi=function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){return[2]})})},Yi=Object(ar.e)(function(e,t){var n=t.itemKey,i=e.demandItem({key:L.e,appMap:ne.e,fileName:c.d,openUrl:c.O,canonicalUrl:c.i,isMalwareDetected:c.k},n),s=i.key,o=i.appMap,u=i.fileName,a=i.openUrl,f=i.canonicalUrl,l=i.isMalwareDetected,h=!1,p=Gi,d=ir(e,{itemKey:n,oneOfRequiredRoles:["write","owner"]});if(n){var v=!l&&!!o&&!!a&&(Qi.isMac||Qi.isWindows||Qi.isIOS||Qi.isWinPhone||Qi.isAndroid),m=e.demandItemFacet(Ki,n),g=Ki.evaluate(m)(e,{itemKey:n,isAvailable:v,protocolCallback:es}),y=g.protocolCallback,b=g.isAvailable;h=v&&b;s&&h&&(p=(function(e){var t=this,n=e.key,i=e.openUrl,s=e.canonicalUrl,o=e.canEdit,u=e.appMap,a=e.fileName,f=e.isNew,l=e.defaultLocation,c=e.protocolCallback;return function(){return Object(r.__awaiter)(t,void 0,void 0,function(){var e,t;return Object(r.__generator)(this,function(r){if(!n)return[2];e=!!o;t=function(){i&&window.open(i)};Object(Ji.e)({app:u||"",itemUrl:s||"",extension:a&&a.extension||"",shouldEdit:e,isNew:Boolean(f),defaultLocation:l||"",platformDetection:Qi,onNavigate:c,onFailureCallback:t});return[2]})})}})({key:s,openUrl:a,canonicalUrl:f,canEdit:d,appMap:o,fileName:u,protocolCallback:y}))}return Object(r.__assign)({isAvailable:h,onExecute:p},Object(Fi.t)(e,{itemKey:n,engagement:{name:"OpenInOfficeClient",isIntentional:!0}}))})(ji.e),Zi=Object(Hi.s)()(Object(Hi.r)()(Yi));function es(e){window.location.href=e}var ts={key:new D.e("openInOfficeClient").id,automationId:"openInOfficeClientCommand",action:ur.createElement(Zi,null),facets:Object(r.__assign)({},Mi.t.pack(!0))},ns=n(1280),rs=new D.e("fileHandlerOpenCommand").id,is={ODB:625,ODC:"CommandBarBrandIcons",Fallback:!1},ss=(Object(Hi.s)()(Object(Hi.r)()(Object(ar.e)(function(e,t){var n=t.itemKey,r=t.item,i=e.demandItem({appMap:ne.e},n).appMap,s=r.name;r.key===Vi.key?s=s||(i?Object(Pi.s)(i,!1):Pi.e.OpenInBrowser):r.key===ts.key&&(s=s||(i?Object(Pi.o)(i,!0):Pi.e.Open));return{name:s}})(function(e){return ur.createElement("div",{className:"contextualMenuItemLinkContent_6c203618"},ur.createElement("span",{dir:"auto",className:"contextualMenuItemTextLabel_6c203618"},e.name))}))),Object(Hi.s)()(Object(Hi.r)()(Object(ar.e)(function(e,t){var n=t.itemKey,i=t.menuProps,s=e.demandItem({appMap:ne.e,fileName:c.d},n),o=s.appMap,u=s.fileName,a={};if(i&&i.items){var f=i.items[0];f&&-1!==f.key.indexOf(rs)&&f.iconProps&&(a=f.iconProps)}var l=!!u&&!!u.extension&&".pdf"===u.extension.toLowerCase(),h={iconName:o?Object(Pi.t)(o):l?"PDF":"OpenFile"},p=Ui.n.isFeatureEnabled(is),d=void 0;i&&i.items&&(d=i.items.map(function(e){return e.key===Vi.key?Object(r.__assign)(Object(r.__assign)({},e),{iconProps:h,name:e.name||o&&Object(Pi.s)(o,!0)||(l?Pi.e.OpenInBrowser:Pi.e.Open),onRenderIcon:o?os.bind(void 0,o,!0,p):void 0}):e.key===ts.key?Object(r.__assign)(Object(r.__assign)({},e),{iconProps:h,name:e.name||o&&Object(Pi.i)(o),onRenderIcon:o?os.bind(void 0,o,!0,p):void 0}):e}));return{iconProps:a||h,onRenderIcon:o?os.bind(void 0,o,!1,p):void 0,text:Pi.e.Open,menuProps:d?Object(r.__assign)(Object(r.__assign)({},i),{items:d}):i}})(Di.e))));function os(e,t,n){var r=e&&Object(Pi.n)(e),i=e&&Object(Pi.r)(e);return i&&n?ur.createElement(ns.e,{size:16,extension:"",brand:i.toLowerCase(),className:"brandIcon_6c203618"}):r?ur.createElement("span",{className:t?"menuItemIconContainer_6c203618":"iconContainer_6c203618"},ur.createElement(_i.e,{iconName:r.logoFill16,className:"logoFillIcon_6c203618"}),ur.createElement(_i.e,{iconName:r.logo16,className:"logoIcon_6c203618"})):null}var us={key:Ai.e.key,automationId:Ai.e.automationId,subMenuProps:{items:[Vi,ts]},onRender:function(e){return ur.createElement(ss,Object(r.__assign)({},e,{menuProps:e.subMenuProps}))},facets:Object(r.__assign)({},Mi.t.pack(!0))},as=(Ai.e.key,Ai.e.automationId,Ai.e.name,Object(r.__assign)({},Mi.t.pack(!0)),Object(Et.t)()(function(){return function(e){return function(e,t){var n=t.commands,i=t.overflowCommands,s=t.farCommands,o=i?Object(r.__spreadArrays)(i):[],u=n?Object(r.__spreadArrays)(n):[],a=s;return{commands:u=fs(e,{defaultCommands:u}).overrideDefaultCommands,overflowCommands:o,farCommands:a}}}}));function fs(e,t){for(var n=[],r=0,i=t.defaultCommands;r<i.length;r++){var s=i[r];s.key===Ai.e.key?n.push(us):n.push(s)}return{overrideDefaultCommands:n}}var ls=n(554),cs=Object(Hi.s)()(Object(Hi.r)()(Object(ar.t)(function(e,t){var n=t.itemKey,r=e.demandItemFacet(c.M,n);return r?ur.createElement(ls.e,{itemKey:r.itemKey}):null}))),hs=n(393),ps={key:"OpenFileLocation",name:hs.i,title:hs.i,action:cs,iconProps:{iconName:"FabricFolder"}},ds=Object(Et.t)()(function(){return function(e){return ms}});var vs=[Ai.e,ps,Oi.n,Oi.t];function ms(e,t){return{commands:fs(0,{defaultCommands:vs}).overrideDefaultCommands}}var gs=n(259),ys=Object(Et.t)()(function(){return function(e){return Es}});var bs={name:"-",key:"divider_1",itemType:gs.e.Divider},ws=[Ai.e,ps,bs,Oi.n,Oi.t];function Es(e,t){return{commands:ws}}var Ss=n(634),xs=Object(Et.t)()(function(){return function(e){return function(e,t){return{isAvailable:!1}}}});var Ts=n(438),Ns=Object(Et.t)()(function(){return function(e){return function(e,t){var n=t.itemsScopeItemKey,i=t.engagement,s=i&&i.name;return{engagement:{datasource:"Recent",extraData:Object(r.__assign)({},"ItemsView.Load"===s?Cs(e,{itemsScopeItemKey:n}):{})}}}}});function Cs(e,t){var n=t.itemsScopeItemKey,i=Object(an.e)(e,n),s=e.demandItemFacet(z,i);return Object(r.__assign)({},s)}var ks=Object(i.t)(function(){return function(e){e(Object(gt.e)(_t.e,Ts.e)(Ns))}}),Ls=n(869),As=Object(Et.t)()(function(){return function(){return Os}});function Os(e,t){var n=e.demandItemFacet(U.u,t.itemKey);return Object(r.__assign)({},n?{defaultLayout:Ls.t.layoutType,isLayoutResolved:!0}:{})}var Ms=Object(i.t)(function(){return function(e){e($t);e(Object(gt.e)(wt.e,gi.e)(Ni));e(Object(gt.e)(_t.e,Li.e)(ds));e(Object(gt.e)(_t.e,Ss.e)(ys));e(Object(gt.e)(Ht,dn.e)(xs));e(Object(gt.e)(wt.e,yt.e)(As));e(ks)}}),_s=n(844),Ds=Object(bi.i)({key:new D.e("dateFollowedColumn").id,name:wi.c,fieldName:"",minWidth:bi.e.regularMin,maxWidth:bi.e.regularMax,isCollapsable:!0},Ei.e)(function(e,t){var n=e.demandItemFacet(c.a,t),r=n&&new Date(n).getTime();if("number"!=typeof r||isNaN(r))return{text:""};var i=e.demandItemFacet(si.N,oi.e),s=i&&i.language||window.navigator.language;return s?{text:Object(Si.n)(new Date(r),s)}:{dateValue:r}},function(e,t){return""+e.demandItemFacet(c.a,t)}),Ps=n(1397),Hs=Object(Et.t)()(function(){return function(e){return js}});var Bs=[yi.t,Ti.e,Ds,Ps.e];function js(e,t){return{columns:Bs}}var Fs=n(343),Is=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){return this.props.group?ur.createElement("div",{className:"root_de13c386"},this.props.group.name):null};return t})(ur.PureComponent),qs=n(1713),Rs=n(1732),Us=n(651),zs=n(435),Ws=n(858);function Xs(e,t){var n=t.signals;if(n){var i=Object(zs.t)(n,function(e){return e.key===Ws.n});if(i&&i.index>-1){var s=i.index;return{signals:Object(r.__spreadArrays)(n.slice(0,s),n.slice(s+1))}}}return{}}var Vs=Object(Et.t)()(function(){return function(e){return Js}});var $s=function(e){var t=e.defaultRender,n=Object(r.__assign)({},Us.e.pack(Xs));return t?ur.createElement(Rs.e,{controlHandlers:n},ur.createElement(t,Object(r.__assign)({},e))):null};function Js(){return{groupHeaderRenderer:Is,rowRenderer:$s,groupProps:{collapseAllVisibility:qs.e.hidden}}}var Ks=n(845),Qs=Object(Et.t)()(function(){return function(e){return Zs}});function Gs(e,t){var n=t.itemKey,r=e.demandItemFacet(c.a,n,{suppressGetItems:!0}),i=r&&new Date(r).getTime();if("number"==typeof i&&!isNaN(i)){var s=e.demandItemFacet(si.N,oi.e),o=s&&s.language||window.navigator.language,u=Object(Si.n)(new Date(i),o);return{itemActivity:u&&ur.createElement(Ei.e,{text:u})||null}}return{}}var Ys=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.defaultRender,n=Object(r.__rest)(e,["defaultRender"]),i=Object(r.__assign)(Object(r.__assign)({},Us.e.pack(Xs)),Ks.e.pack(Gs));return t?ur.createElement(Rs.e,{controlHandlers:i},ur.createElement(t,Object(r.__assign)({},n))):null};return t})(ur.PureComponent);function Zs(){return{tileRenderer:Ys}}var eo=n(431),to=n(4300),no=Object(Et.t)()(function(){return function(e){return function(e,t){return{emptyFolderIconUrl:"https://static2.sharepointonline.com/files/fabric/onedrive-assets/images/empty_state_sfl.svg",emptyFolderTitle:to.e}}}});var ro,io=Object(i.t)(function(){return function(e){e(mt);e(Object(gt.e)(at.e,Fs.e)(Vs));e(Object(gt.e)(at.e,_s.e)(Qs));e(Object(gt.e)(at.e,gi.e)(Hs));e(Object(gt.e)(at.e,eo.e)(no));e(Object(gt.e)(ft.e,Li.e)(as))}}),so=n(467),oo=n(920),uo={action:ur.createElement(oo.e,null),automationId:"addShortcutFromSharedWithMeCommand",title:hs.t,iconProps:{iconName:"FabricFolderLink"},key:new D.e("AddShortcutFromSharedWithMe").id,name:hs.e},ao=n(62),fo=n(665),lo={action:ur.createElement(ao.t,null,ur.createElement(fo.t,null)),automationId:"removeShortcutFromSharedWithMeCommand",title:hs.a,iconProps:{iconName:"FabricFolderLink"},key:new D.e("RemoveShortcutFromSWM").id,name:hs.u},co=n(156),ho=n(205),po=n(1661),vo=n(780),mo=n(1061),go=n(130),yo=n(18),bo=n(1436),wo=Object(ar.t)(function(e,t){var n=t.itemKeys,i=t.removeFromSharedListWizard,s=t.removeItemsFromSharedList,o=void 0===s?mo.t:s,u=Object(an.e)(e)||"",a=e.demandItemFacet(l.e,u);if(0===n.length)return null;for(var f=a&&n.length<=200,c=i,h=0,p=n;h<p.length;h++){var d=p[h],v=e.demandItemFacet(bo.e,d),m=!ve.t.isActivated("6c28a705-1f14-4f06-97c7-ee39b2d66e9e","11/5/2020","Action should be available unless otherwise stated in control handler");bo.e.evaluate(v)(e,{itemKey:d,isAvailable:m}).isAvailable||(f=!1)}var g=e.dispatch,y=function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var e,t;return Object(r.__generator)(this,function(r){switch(r.label){case 0:e={itemSetKey:u};t=Object(go.e)(n,function(){return e});return[4,g(o({items:t}))];case 1:r.sent();return[2]}})})},b=Object(yo.o)(function(e){return ur.createElement(c,Object(r.__assign)({},e,{onItemRemoved:y,itemKeys:n}))});return ur.createElement(ji.e,Object(r.__assign)({isAvailable:f,onExecute:b},Object(Fi.t)(e,{itemKey:void 0,engagement:{name:"RemoveFromSharedList",isIntentional:!0,extraData:{itemCount:n.length}}})))}),Eo=Object(Hi.s)()(wo),So=n(4301),xo=n(3921),To=n(458),No=n(96),Co=((ro={})[ti.r.started]=function(e){return Object(Ke.formatToArray)(Object(Ke.getLocalizedCountValue)(xo.s,xo.t,e)||"",e)},ro[ti.r.completed]=function(e){return Object(Ke.formatToArray)(Object(Ke.getLocalizedCountValue)(xo.e,xo.t,e)||"",e)},ro[ti.r.failed]=function(e){return Object(Ke.formatToArray)(Object(Ke.getLocalizedCountValue)(xo.n,xo.r,e)||"",e)},ro[ti.r.canceled]=function(e){return Object(Ke.formatToArray)(Object(Ke.getLocalizedCountValue)(xo.n,xo.r,e)||"",e)},ro),ko=Object(i.t)(function(){return function(e){e(Object(gt.e)(mo.e,To.e)(Object(Et.t)()(Lo)))}});function Lo(){return function(e){return Ao}}function Ao(e,t){var n,i=Object(No.r)(e,t),s=i.phase,o=i.count;n=Co[s](o);return Object(r.__assign)({},n&&"item"!==t.format?{title:n}:{})}var Oo=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this,t=this.props,n=t.resolve,i=t.reject,s=t.onItemRemoved,o=t.itemKeys,u=function(){return Object(r.__awaiter)(e,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:n();return[4,s()];case 1:e.sent();return[2]}})})},a=function(){return Object(r.__awaiter)(e,void 0,void 0,function(){return Object(r.__generator)(this,function(e){i(new co.e);return[2]})})};return ur.createElement(ho.e,null,function(e){var t=e.itemCache,n=Mo(t,o),r=n.title,i=n.prompt;return ur.createElement(po.ConfirmationDialog,{onCancel:a,onConfirm:u,yesText:xo.i,noText:So.o,defaultToYes:!0,title:r,prompt:i})})};return t})(ur.PureComponent),Mo=function(e,t){if(t.length>1)return{title:So.s,prompt:So.i};if(1===t.length){var n=e.demandItemFacet(c.m,t[0]);return{title:n?So.r:So.t,prompt:n?So.n:So.e}}return{title:"",prompt:""}},_o=Object(vo.e)({operationTypeFacet:mo.n,progressKeyFacet:mo.e,initializeBatch:function(){return ko}});var Do=Object(ar.e)(function(){return{removeFromSharedListWizard:Oo,removeItemsFromSharedList:_o}})(Eo),Po={key:new D.e("removeFromSharedList").id,automationId:"removeFromSharedListCommand",name:hs.f,title:hs.l,action:ur.createElement(ao.t,null,ur.createElement(Do,null)),iconProps:{iconName:"Cancel"}},Ho=!ve.t.isActivated("A62AD86A-B7EB-4EF6-A7F2-CC139D544AE7","",""),Bo={name:"-",key:"divider_1",itemType:gs.e.Divider},jo=Object(Et.t)()(function(){return function(e){return function(e,t){return{commands:Object(r.__spreadArrays)([Ai.e,Oi.n,Oi.t],Ho?[Bo]:[],[uo],Ho?[so.e]:[],[lo,Po])}}}});var Fo=!ve.t.isActivated("A62AD86A-B7EB-4EF6-A7F2-CC139D544AE7","",""),Io=Object(Et.t)()(function(){return function(e){return function(e,t){return{commands:Object(r.__spreadArrays)([Ai.e,Oi.n,Oi.t,uo],Fo?[so.e]:[],[lo,Po])}}}});var qo,Ro=n(352),Uo=((qo={})[Fe.t]=!0,qo[Fe.s]=!0,qo[pe.r]=!0,qo[pe.e]=!0,qo[pe.n]=!0,qo),zo=Object(Et.t)()(function(){return function(e){return function(e,t){var n=t.itemSetKey,i=t.handler,s=i.columnKey,o=i.isAscending;if(!Uo[s])return{};var u=e.demandItemFacet(l.e,n);if(!u)return{};var a=pe.t[s];if(!a)return{};var f=u.driveItemKey.endpoint,c=u.sortBy;return Object(m.i)(e,f)&&!c&&s===Fe.t&&o?{newItemSetKey:n}:{newItemSetKey:l.e.serialize(Object(r.__assign)(Object(r.__assign)({},u),{sortBy:a,isAscending:o}))}}}});var Wo,Xo=n(543),Vo=Object(Et.t)()(function(){return function(e){return function(e,t){var n=t.itemKey,i=e.demandItemFacet(l.e,n),s=i&&i.driveItemKey.endpoint,o=s&&i&&pn(0,{itemSetKey:l.e.serialize(i),parentItemKey:a.e.serialize({endpoint:s}),stageItem:t.stageItem});return Object(r.__assign)({},o?{stageItem:o}:{})}}});var $o=((Wo={})[pe.r]=!0,Wo[pe.e]=!0,Wo),Jo=Object(Et.t)()(function(){return function(e){return Ko}});function Ko(e,t){var n=t.itemSetKey,i=t.handler.columnKey;if(!$o[i])return{};var s=e.demandItemFacet(l.e,n);if(!s)return{};var o=pe.t[i];return o?{newItemSetKey:l.e.serialize(Object(r.__assign)(Object(r.__assign)({},s),{groupBy:o}))}:{}}var Qo=Object(Et.t)()(function(){return function(e){return Go}});function Go(e,t){var n=t.itemSetKey,i=e.demandItemFacet(l.e,n);return i?{newItemSetKey:l.e.serialize(Object(r.__assign)(Object(r.__assign)({},i),{groupBy:void 0}))}:{}}var Yo=n(513),Zo=n(1313),eu=ve.t.isActivated("d4cb8ed6-56a5-4c23-8c49-2f352054edd9","12/15/2021","Use cultureName instead of cultureUIName to display the date"),tu=Object(bi.i)({name:Zo.t,key:pe.e,fieldName:"",minWidth:bi.e.regularMin,maxWidth:bi.e.regularMax,isCollapsable:!0,sortProps:bi.t},Ei.e)(function(e,t){var n,r,i=e.demandItemFacet(G.e,t),s=i&&new Date(i.sharedDateTime).getTime();if("number"!=typeof s||isNaN(s))return{text:""};var o=e.demandItemFacet(si.N,oi.e),u=!eu&&(null===(n=o)||void 0===n?void 0:n.cultureLCID)||(null===(r=o)||void 0===r?void 0:r.language)||window.navigator.language;return u?{text:Object(Si.n)(new Date(s),u)}:{dateValue:s}}),nu=n(747),ru=new b.e("topCollaboratorSetKeyFacet",{endpoint:Object(b.s)()}),iu=n(1030),su=n(1676),ou=n(4302),uu=(function(e){Object(r.__extends)(t,e);function t(t){return e.call(this,t)||this}t.prototype.render=function(){var e=this.props,t=e.userName,n=e.isPlaceholder,r=ur.createElement(_i.e,{className:"topCollaboratorIcon_7990aeb5",iconName:"TeamFavorite"}),i=ur.createElement("span",{className:"topCollaboratorUserName_7990aeb5"},t),s=ur.createElement("div",{className:"topCollaboratorTooltip_7990aeb5"},Ke.formatToArray(ou.e,i));return ur.createElement("div",{className:"topCollaPlaceHolder_7990aeb5"},n?null:t?ur.createElement(su.e,{content:s},r):r)};return t})(iu.e),au=Object(bi.i)({name:Zo.n,key:pe.r,fieldName:"",minWidth:bi.e.regularMin,maxWidth:bi.e.regularMax,isCollapsable:!0,sortProps:bi.r,headerClassName:"columnHeader_7990aeb5"},nu.e)(function(e,t){var n,r,i,s=e.demandItem({shareByPerson:P},t).shareByPerson,o=e.demandItem({sharedBy:G.e},t).sharedBy,u=null===(n=s)||void 0===n?void 0:n.itemKey,a=o&&(null!=(r=o.sharedBy)?r:o.owner),l=(null===(i=s)||void 0===i?void 0:i.displayValue)||a&&a.user&&a.user.displayName,c=!1;if(u&&H.e.matches(u)){var h=H.e.deserialize(u).email,p=e.demandItemFacet(f.e,ru.serialize({endpoint:"https://graph.microsoft.com/beta"}));p&&(c=p.itemKeys.slice(0,3).some(function(t){var n=e.demandItemFacet(_.e,t);return!!n&&n===h}))}return u||l?{people:[{itemKey:u||"",displayValue:l}],onRenderUser:function(e,t){if(!e||!t)return null;var n=t(e),r=e.user;return ur.createElement("div",{className:"userWithTopCollaborator_7990aeb5"},ur.createElement(uu,{userName:r.title,isPlaceholder:!c}),n)}}:{people:[]}},function(e,t){return""+e.demandItemFacet(_.e,t)}),fu=Object(Et.t)()(function(){return function(e){return function(e,t){var n=t.itemSetKey,i=!1,s=e.demandItemFacet(l.e,n);if(s){var o=s.driveItemKey.endpoint;i=Object(m.i)(e,o)}return{columns:Object(r.__spreadArrays)(i?[yi.e,Yo.e]:[yi.t,Ti.e,tu],[au])}}}});var lu=new b.e("topCollaboratorItemKeyFacet",{id:Object(b.s)()}),cu=Object(i.i)()(function e(t){var n=this,i=t.itemKey;return function(s){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,o,u,a,l,p,d,v,y,b,w,E,S,T,N,C;return Object(r.__generator)(this,function(k){switch(k.label){case 0:n=new h.e({publisher:e});o=s(Object(g.e)({graphEndpoint:x.m})).graphEndpoint;u=ru.deserialize(i);a=o||u.endpoint;l=a+"/me/people/";return[4,s(Object(m.n)({url:l,qosName:"getTopCollaborator",endpoint:a}))];case 1:p=k.sent();d=[];for(v=0,y=p.value;v<y.length;v++){b=y[v];w=b.id,E=b.displayName,S=b.userPrincipalName;T=lu.serialize({id:w});s(Object(et.e)({items:(N={},N[T]=Object(r.__assign)(Object(r.__assign)({},c.h.pack(E)),_.e.pack(S)),N)}));d.push(T)}n.resolveItems({items:(C={},C[t.itemKey]=Object(r.__assign)({},f.e.pack({itemKeys:d})),C)});s(n.execute());return[2]}})})}});var hu=Object(Et.t)()(function(){return function(e){return function(e,t){return{isAvailable:!1}}}});var pu=Object(Et.t)()(function(){return function(e){return function(e,t){return{isAvailable:!1}}}});var du=Object(i.t)(function(){return function(e){e(nt);e(Object(gt.e)(a.e,Li.e)(Io));e(Object(gt.e)(a.e,Ss.e)(jo));e(Object(gt.e)(l.e,Ro.e)(zo));e(Object(gt.e)(l.e,dn.e)(Vo));e(Object(gt.e)(l.e,Xo.e)(Jo));e(Object(gt.e)(l.e,Xo.t)(Qo));e(Object(gt.e)(l.e,gi.e)(fu));e(Object(gt.e)(We,dn.e)(hu));e(Object(gt.e)(Ve,dn.e)(pu));e(Object(u.r)(ru,tt.e)(cu))}}),vu=n(1431),mu=n(429),gu=n(1055),yu=Object(Et.t)()(function(){return function(){return function(e,t){var n=t.setItemKey,r=e.demandItemFacet(X.e,n);if(!n||!r)return{};var i=r.driveItemKey.endpoint,s=L.e.serialize(r.driveItemKey),o=e.demandItemFacet(Z.e,s),u=e.demandItemFacet(x.s,oi.e)||F.t,a=e.demandItemFacet(x.M,oi.e);if(a&&a(i,o)){return{totalItemCount:e.demandItemFacet(U.e,s),getPageKey:function(e,t){return vn.serialize({setItemKey:n,endpoint:r.driveItemKey.endpoint,skip:e,top:t-e})},pageSize:u}}return{}}}});var bu=n(1077),wu=n(1277),Eu=Object(bi.i)({key:new D.e("dateTakenColumn").id,name:wi.n,fieldName:"",minWidth:bi.e.regularMin,maxWidth:bi.e.regularMax,isCollapsable:!0,sortProps:bi.t},wu.t)(function(e,t){return function(){return{itemKey:t}}},function(e,t){return""+e.demandItemFacet(Y.u,t,{suppressGetItems:!0})}),Su=n(1008),xu=n(1104),Tu=n(1044),Nu=n(292),Cu=!ve.t.isActivated("637A4DC9-1258-4BD2-8166-5F852E5FEBBE","11/09/2021","The switch to add modifiedBy column in default column set."),ku=Object(Et.t)()(function(){return function(e){return Mu}});var Lu=[yi.e,Yo.e,bu.e,Su.e,xu.e],Au=[yi.e,Yo.e,bu.e,Tu.e,Su.e,xu.e],Ou=[yi.e,Yo.e,bu.e,Eu,Su.e,xu.e];function Mu(e,t){var n,r,i=t.itemSetKey;if(i){var s=Object(Nu.e)(e,{itemKey:i});if("photo"===(null===(r=null===(n=e.demandItemFacet($.e,s))||void 0===n?void 0:n.folder)||void 0===r?void 0:r.folderType))return{columns:Ou}}if(Cu){if((0,e.dispatch)(Object(g.e)({disableModifiedByColumn:x.r})).disableModifiedByColumn)return{columns:Lu}}return{columns:Au}}var _u=n(25),Du=Object(Et.t)()(function(){return function(e){return Pu}});function Pu(e,t){return(function(e,t,n){var i,s,o=n.itemSetKey,u=n.handler,a=u.columnKey,l=u.isAscending,c=e.demandItemFacet(t,o);if(!c)return{};var h=L.e.serialize(Object(r.__assign)({},c.driveItemKey)),p=e.demandItemFacet(Z.e,h);if(!p||"business"===p||"documentLibrary"===p)return{};if(!c.sortBy)if(en.e){var d=e.demandItemFacet(f.u,h);if(a===(null===(i=d)||void 0===i?void 0:i.columnKey)&&(null===(s=d)||void 0===s?void 0:s.isAscending)===l)return{newItemSetKey:o}}else if(a===Yo.e.key&&!0===l)return{newItemSetKey:o};var v=Object(_u.e)(e,{customColumnKeysToFieldNamesConfiguration:x.n}).customColumnKeysToFieldNamesConfiguration,m=Object(r.__assign)(Object(r.__assign)({},pe.t),v),g=m?m[a]:void 0;if(!g)return{};return{newItemSetKey:t.serialize(Object(r.__assign)(Object(r.__assign)({},c),{sortBy:g,isAscending:l}))}})(e,X.e,t)}var Hu=n(589),Bu=Object(Et.t)()(function(){return function(e){return function(e,t){return{isAvailable:!0}}}});var ju=n(571),Fu=n(1428),Iu=n(524),qu={key:new D.e("openInOfficeOnlineDefaultClickHandler").id,evaluate:function(e,t){var n=t.itemKey,r=e.demandItem({openUrl:c.O,appMap:ne.e},n),i=r.openUrl,s=r.appMap;return{action:!!i&&!!s?ur.createElement(Iu.e,{itemKey:n,action:Object(yo.i)(e,ur.createElement(Wi,{itemKey:n}))}):void 0}}},Ru={key:new D.e("openInOfficeClientDefaultClickHandler").id,evaluate:function(e,t){var n=t.itemKey,r=e.demandItem({openUrl:c.O,appMap:ne.e},n),i=r.openUrl,s=r.appMap;return{action:!!i&&!!s?ur.createElement(Iu.e,{itemKey:n,action:Object(yo.i)(e,ur.createElement(Yi,{itemKey:n}))}):void 0}}},Uu=Object(Et.t)()(function(){return function(e){return function(e,t){var n=t.handlers,i=void 0===n?[]:n;return{handlers:Object(r.__spreadArrays)([Fu.e,qu,Ru],i)}}}});var zu=n(683),Wu=n(1469),Xu=n(676),Vu=n(170),$u=n(810),Ju=function(e,t){return n=e,Object(r.__assign)(((i={version:2})[0]="",i[1]="",i[3]="",i[6]="",i[16]="",i),n);var n,i},Ku=function(e,t){var n=t.queryType,r=t.layoutType,i=r&&(function(e){return e===Vu.e?$u.e:e===kt.e?$u.n:$u.t})(r),s=Ju(e);"number"==typeof n&&i&&(s[n]=i);return s},Qu=n(1842),Gu=Object(fn.t)(function(e){e.itemsScopeItemKey;var t=e.localStorageKey,n=Object(r.__rest)(e,["itemsScopeItemKey","localStorageKey"]);return function(e){var i,s=e(Object(R.e)(function(e){return Object(Qu.e)(e,{name:t})}))||{},o=s&&Ku(s,Object(r.__assign)({},n));e(Object(Qu.n)({values:(i={},i[t]=o,i)}))}}),Yu=Object(Et.t)()(function(){return function(){return ea}}),Zu=new b.e("itemsScopeList",{driveId:Object(b.s)(),itemsScopeItemKey:Object(b.s)()});function ea(e,t){var n=Object(_u.e)(e,{isLayoutResolvedEnabled:si.T,isLocalStorageForLayoutEnabled:x.T}),i=n.isLayoutResolvedEnabled,s=n.isLocalStorageForLayoutEnabled;if(!i||!s)return{};var o,u,a,f,l=t.itemsScopeItemKey,c=Object(an.e)(e),h=e.demandItemFacet(X.e,c),p=void 0;if(c&&h&&l){var d=h.driveItemKey;if(d){var v=d.endpoint,m=d.driveId;if(!m||!v)return{};var g,y,b=Zu.serialize({driveId:m,itemsScopeItemKey:l}),w=e.demandItemFacet(x.g,oi.e),E=w&&w(e,{itemSetKey:c}),S=E&&E.queryType||0;g="ItemsStore"+(o={endpoint:v,driveId:m,queryType:S},u=o.endpoint,a=o.driveId,f="Graph.Files.FilesQueryType."+u,f=a?f+"."+a:f).toLocaleLowerCase();var T=Object(Qu.e)(e,{name:g});p=Object(Qu.t)(e,{name:g});var N=T&&T[S]||"";y=p?(function(e){switch(e){case $u.t:return Vu.t;case $u.e:return Vu.e;default:return kt.e}})(N):void 0;var C=e.demandItemFacet(Qe.l,b);return{preferredLayoutType:e.demandItemFacet(Qe.f,b)||y,preferredLayoutVersion:C,setPreferredLayout:function(e){var t=e.layoutType;return function(n){g&&m&&v&&n(Gu({endpoint:v,driveId:m,itemsScopeItemKey:l,queryType:S,localStorageKey:g,layoutType:t}));n(Object(on.e)(function(){var t,i;n(Object(et.e)({items:(t={},t[b]=Object(r.__assign)({},Qe.f.pack(e.layoutType)),t)}));n(Object(et.e)({items:(i={},i[b]=Object(r.__assign)({},Qe.l.pack((C||0)+1)),i)}))}))}}}}}return{}}var ta=n(1089),na=n(229),ra=new D.e("itemRestrictedSignal").id,ia=Object(Et.t)()(function(){return function(e){return function(e,t){var n=t.itemKey;if(e.demandItemFacet(de.e,n)&&n){var i=Object(r.__spreadArrays)(t.signals||[]);i.push(oa);return{signals:i}}return{}}}});var sa,oa={signal:ur.createElement(na.t,null),title:p.e,key:ra},ua=n(579),aa=n(203),fa=n(329);(function(e){e.vaultOpen="vaultopen";e.vaultClosed="vaultclosed"})(sa||(sa={}));var la={small:{vaultclosed:"vaultCoverSmallVaultClosed",vaultopen:"vaultCoverSmallVaultOpen"},large:{vaultclosed:"VaultCoverLargeVaultClosed",vaultopen:"VaultCoverLargeVaultOpen"}},ca=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e,t=this.props,n=t.vaultCoverSize,i=void 0===n?"large":n,s=t.vaultCoverType,o=void 0===s?"vaultclosed":s,u=(t.ref,t.children,t.isFluent),a=Object(r.__rest)(t,["vaultCoverSize","vaultCoverType","ref","children","isFluent"]),f=la[i][o];"small"===i?e="vaultCoverIsSmall_0b1cee7d":"large"===i&&(e="vaultCoverIsLarge_0b1cee7d");return ur.createElement("div",Object(r.__assign)({},a,{className:"root_0b1cee7d "+e+" "+(u?"isFluent":"")}),ur.createElement(_i.e,{"aria-hidden":!0,className:"ms-VaultCover cover_0b1cee7d",iconName:f}))};return t})(ur.Component);var ha=!ve.t.isActivated("563DE72A-2756-43DF-A2E8-910F31083778","","");(function(e,t){void 0===e&&(e="https://spoprod-a.akamaihd.net/files/fabric/office-ui-fabric-react-assets/foldericons");Object(fa.n)({fontFace:{},style:{width:78,height:58,overflow:"hidden"},icons:{vaultCoverSmallVaultClosed:ur.createElement("img",{src:e+"/vault-sm.svg"}),vaultCoverSmallVaultOpen:ur.createElement("img",{src:e+"/vault-sm-open.svg"})}},t);Object(fa.n)({fontFace:{},style:{width:118,height:86,overflow:"hidden"},icons:{VaultCoverLargeVaultClosed:ur.createElement("img",{src:e+"/vault-lg.svg"}),VaultCoverLargeVaultOpen:ur.createElement("img",{src:e+"/vault-lg-open.svg"})}},t)})("https://spoprod-a.akamaihd.net/files/fabric/office-ui-fabric-react-assets/foldericons",{disableWarnings:!0});var pa=Object(Et.t)()(function(){return function(e){return function(e,t){var n=t.itemKey,i=e.demandItemFacet(ee.e,n),s=ha&&(e.demandItemFacet(K.e,n)||e.demandItemFacet(J,n));return Object(r.__assign)(Object(r.__assign)({},i&&i.root?{tileAs:va}:{}),{folderCoverControlHandler:function(t,n){var i={};s&&(i={folderCoverAs:ma});var o=n.signalData;if(o&&o.signal)return i;var u=e.demandItem({specialFolder:oe.e},n.itemKey).specialFolder;if(!u)return i;var a=(function(e){var t=null;"desktop"===e?t=ur.createElement(na.n,null):"documents"===e?t=ur.createElement(na.r,null):"pictures"===e&&(t=ur.createElement(na.c,null));return{signal:t,key:e||""}})(u);return a&&a.signal?Object(r.__assign)(Object(r.__assign)({},i),{signalData:a}):i}})}}});var da=Object(ar.t)(function(e,t){var n=t.itemKey,i=Object(r.__rest)(t,["itemKey"]),s=e.demandItemFacet(ee.e,n),o=s&&s.isLocked?sa.vaultClosed:sa.vaultOpen;return ur.createElement(ca,Object(r.__assign)({},i,{vaultCoverSize:i.folderCoverSize,vaultCoverType:o}))}),va=Object(ar.t)(function(e,t){var n=t.defaultRender,i=t.foreground,s=Object(r.__rest)(t,["defaultRender","foreground"]),o=t.itemKey,u=i,a=e.demandItemFacet(ee.e,o);a&&a.root&&(u=Object(aa.r)(e,ur.createElement(da,Object(r.__assign)({},s,{folderCoverSize:s.tileSize,itemKey:o}))));return n?ur.createElement(n,Object(r.__assign)({},s,{foreground:u})):null});function ma(e){var t=e.defaultRender,n=Object(r.__rest)(e,["defaultRender"]);return t?ur.createElement(t,Object(r.__assign)({},n,{folderCoverType:"linked"})):null}var ga=n(511),ya=n(109),ba=n(297),wa=Object(Et.t)()(function(){return function(e){return function(e,t){var n,i,s,o,u=t.itemKey,a=e.demandItemFacet(ee.e,u);if(a&&a.root){var f=e.demandItemFacet(c.h,u),l=a.isLocked?sa.vaultClosed:sa.vaultOpen,h={iconType:ga.e.Image,ariaLabel:f,imageProps:{src:(n=l,"https://spoprod-a.akamaihd.net/files/fabric-cdn-prod_20201207.001//assets/item-types/"+(i||"20")+(o&&"png"===s?"_2x":"")+"/"+n+"."+(s||"png")),imageFit:ya.t.contain,className:"fileHandlerFileTypeIcon_7f11123a"}};return{iconAs:function(e){return ur.createElement(_i.e,Object(r.__assign)({},e,h))}}}return{fileTypeIconAs:Ea}}}});var Ea=Object(ar.t)(function(e,t){var n=t.defaultRender,i=Object(r.__rest)(t,["defaultRender"]),s=i.isFolder,o=i.itemKey,u=i.type,a=u;if(s&&void 0===u){var f=e.demandItemFacet(oe.e,o);void 0!==f&&("desktop"===f?a=ba.e.desktopFolder:"documents"===f?a=ba.e.documentsFolder:"pictures"===f&&(a=ba.e.picturesFolder))}return n?ur.createElement(n,Object(r.__assign)({},i,{type:a})):null}),Sa=Object(i.t)(function(){return function(e){e(Dr);e(Object(gt.e)(X.e,gi.e)(ku));e(Object(gt.e)(X.e,ta.e)(Object(Et.n)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([8],4742)];case 1:return[2,e.sent().driveItemSortActionControlHandler]}})})})));e(Object(gt.e)(X.e,Ro.e)(Du));e(Object(gt.e)(L.e,Us.e)(ia));e(Object(gt.e)(L.e,mu.e)(vu.e));e(Object(gt.e)(X.e,gu.e)(yu));e(Object(gt.e)(L.e,Hu.e)(Bu));e(Object(gt.e)(L.e,ua.e)(wa));e(Object(gt.e)(L.e,Ks.e)(pa));e(Object(gt.e)(L.e,ju.e)(Uu));e(Object(gt.e)(L.e,zu.e)(Wu.e));e(Object(gt.e)(X.e,Xu.e)(Yu))}}),xa=new b.e("specialDriveItem",{endpoint:Object(b.s)(),driveId:Object(b.s)({shouldNormalizeToEmpty:!0}),name:Object(b.s)()}),Ta=Object(i.i)()(function e(t){var n=this,i=t.itemKey,s=xa.deserialize(i),o=s.driveId,u=s.endpoint,a=Object(v.n)(s);return function(t){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,l,c,p,d,g,y,b,w;return Object(r.__generator)(this,function(E){switch(E.label){case 0:return[4,t(Object(m.n)({url:Object(v.i)(s),driveUrl:a,qosName:"getItem",endpoint:u}))];case 1:n=E.sent();l=new h.e({publisher:e});c=n&&n.parentReference;p=c&&c.driveId;d={endpoint:u,driveId:p||o,itemId:n.id};g=L.e.serialize(d);y=c&&c.id?L.e.serialize({endpoint:u,driveId:p,itemId:c.id}):void 0;l.merge(t(Object(k.e)({itemKey:g,driveItem:n,endpoint:u,parentFolderItemKey:y})).itemResolver);l.resolveItems({items:(b={},b[g]=Object(r.__assign)(Object(r.__assign)({},li.n.pack(L.e)),f.t.pack({itemKey:X.e.serialize({driveItemKey:d,sortBy:"",isAscending:!0})})),b)});l.mapKeys({mappings:(w={},w[g]=i,w)});t(l.execute());return[2]}})})}});var Na=Object(i.t)(function(){return function(e){e(Object(u.r)(xa,tt.e)(Ta))}}),Ca=Object(i.t)(function(){return function(e){e(Na);e(Object(gt.e)(xa,ua.e)(wa));e(Object(gt.e)(xa,Ks.e)(pa))}}),ka=n(843),La=Object(i.i)()(function e(t){var n=this,i=t.itemKey,s=Sr.deserialize(i),o=s.endpoint,u=s.driveId;return function(t){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,s,a,f,l;return Object(r.__generator)(this,function(c){switch(c.label){case 0:n=Object(v.n)({endpoint:o,driveId:u});return[4,t(Object(ka.getSessionToken)({endpoint:o,driveUrl:n}))];case 1:s=c.sent();a=s&&s.accessToken;(f=new h.e({publisher:e})).resolveItems({items:(l={},l[i]=Object(r.__assign)({},xr.e.pack(a)),l)});t(f.execute());return[2]}})})}});var Aa=Object(i.t)(function(){return function(e){e(Object(u.r)(Sr,tt.e)(La))}}),Oa=n(883),Ma=Object(Et.t)()(function(){return function(e){return function(e,t){for(var n=0,r=t.sourceItemKeys;n<r.length;n++){var i=r[n],s=e.demandItemFacet(L.e,i);if(!s)return{};var o=s.itemId;if((void 0===o?F.r:o)===F.r)return{};if(t.isMove){if(!e.demandItemFacet(Zn,i))return{}}if(e.demandItemFacet(J,i))return{}}return{isAvailable:!0}}}});var _a=Object(i.t)(function(){return function(e){e(Object(gt.e)(L.e,Oa.e)(Ma))}}),Da=Object(i.t)(function(){return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(t){e(pi);e(Sa);e(Aa);e(mi);e(Ms);e(io);e(du);e(Ca);e(_a);return[2]})})}})},4881:function(e,t,n){"use strict";n.r(t);n.d(t,"sharePointAddonAutoRefresh",function(){return Le});var r,i=n(12),s=n(379),o=n(92),u=n(3860),a=n(0),f=n("react-lib"),l=n(332),c=n(8),h=n(25),p=n(9),d=n(5),v=n(213),m=n(189),g=n(212),y=n(36),b=n(1319),w=n(3932),E=n(718),S=n(77),x=n(37);(function(e){e[e.New=0]="New";e[e.Update=1]="Update";e[e.Delete=2]="Delete"})(r||(r={}));var T={ODB:819,ODC:"EnablePushChannelLogging"},N={ODB:459},C=(function(){function e(e){var t=this;this.subscribe=function(){t._log("Subscribe");if(0===t._subscribers){t._async=new m.e;y.t.isActivated("90f6bcb1-03a0-4a02-9370-1e6807d6763a","7/22/2021","Fix Item Auto Refresh Bug")||(t._syncToken="latest");var e=t._async.debounce(function(){return t._onNotification()},1e4,{leading:!0,maxWait:1e4});t._pushChannelService.setupNotificationHandler({source:w.t.WebhookSubscription},function(){t._log("PushChannelMessageSource",w.t.WebhookSubscription);e()});t._pushChannelService.setupNotificationHandler({source:w.t.EventHub},function(){t._log("PushChannelMessageSource",w.t.EventHub);e()});t._pushChannelService.addConnectionHandler(t._id,function(e){return t._onPushChannelConnection(e)})}t._subscribers++;t._pushChannelService.isConnected()||t._pushChannelService.connect(t._getNotification(),{methodInvoker:"ItemAutoRefreshHelper.subscribe"});return t._unsubscribe.bind(t)};this._id=e.id;this._driveUrlParts=e.driveUrl?Object(b.e)(e.driveUrl):void 0;this._dispatch=e.dispatch;this._template=e.template;this._itemScopeItemKey=e.itemsScopeItemKey||"";this._pushChannelService=e.pushChannelService;this._onUnsubscribe=e.onUnsubscribe;this._isTestMode=e.isTestMode;this._onPushChannelConnected=e.onPushChannelConnected;this._onNotificationReceived=e.onNotificationReceived;this._subscribers=0;this._syncToken="latest";this._getChangesAttempts=0}e.prototype._unsubscribe=function(){this._log("Unsubscribe");this._subscribers--;this._template.onUnsubscribe(this._subscribers);if(0===this._subscribers){if(this._async){this._async.dispose();this._async=void 0;this._refreshSubscriptionTimeoutId=void 0}this._pushChannelService.setupNotificationHandler({source:w.t.WebhookSubscription},function(){});this._pushChannelService.removeConnectionHandler(this._id);this._pushChannelService.disconnect()}this._onUnsubscribe(this._subscribers);return this._subscribers};e.prototype._onPushChannelConnection=function(e){return Object(a.__awaiter)(this,void 0,void 0,function(){var t,n;return Object(a.__generator)(this,function(r){switch(r.label){case 0:if(!e){this._log("Disconnected");this._clearRefreshSubscriptionTimeout();return[2]}this._log("Connected");this._isTestMode&&this._onPushChannelConnected&&this._onPushChannelConnected();if(y.t.isActivated("90f6bcb1-03a0-4a02-9370-1e6807d6763a","7/22/2021","Fix Item Auto Refresh Bug"))return[3,5];r.label=1;case 1:r.trys.push([1,3,,4]);return[4,this._resolveChangeMessages()];case 2:r.sent();return[3,4];case 3:t=r.sent();this._handleError(t);return[2];case 4:return[3,9];case 5:if("latest"!==this._syncToken)return[3,9];r.label=6;case 6:r.trys.push([6,8,,9]);return[4,this._getChangeMessages()];case 7:r.sent();return[3,9];case 8:n=r.sent();this._handleError(n);return[2];case 9:this._refreshSubscriptionHandler();return[2]}})})};e.prototype._handleError=function(e){var t=this;this._getChangesAttempts++;if(!(this._getChangesAttempts>10)){var n=!1;if(Object(E.s)(e))switch(e.status){case 404:case 410:n=!0;this._syncToken="latest"}n&&this._async&&this._async.setTimeout(function(){return t._onPushChannelConnection(t._pushChannelService.isConnected())},500+Math.pow(2,this._getChangesAttempts))}};e.prototype._getNotification=function(){return this._template.getSubscription&&this._template.getSubscription(this._dispatch)};e.prototype._refreshSubscriptionHandler=function(){var e=this;if(this._async){var t=this._pushChannelService.getSocketIoSubscription();if(t){var n=105001*Math.random()+15e3,r=Date.parse(t.expirationDateTime),i=Date.now(),s=r-i-n;if(s<12e4){if(g.e.isFeatureEnabled(N)){var o={refreshDelay:s,expirationDateTime:t.expirationDateTime,expirationDateTimeinMS:r,dateTimeNow:i,recreateBufferRandom:n};new S.e({name:"ItemAutoRefreshHelper.refreshSubscription",extraData:o}).end({resultType:x.e.Failure,extraData:o})}s=12e4}this._clearRefreshSubscriptionTimeout();this._refreshSubscriptionTimeoutId=this._async.setTimeout(function(){return Object(a.__awaiter)(e,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:this._log("Refreshing subscription");this._refreshSubscriptionTimeoutId=void 0;return[4,this._pushChannelService.refreshSubscription()];case 1:!0===e.sent()&&this._refreshSubscriptionHandler();return[2]}})})},s)}}};e.prototype._clearRefreshSubscriptionTimeout=function(){if(this._async&&void 0!==this._refreshSubscriptionTimeoutId){this._async.clearTimeout(this._refreshSubscriptionTimeoutId);this._refreshSubscriptionTimeoutId=void 0}};e.prototype._getChangeMessages=function(){return Object(a.__awaiter)(this,void 0,void 0,function(){var e;return Object(a.__generator)(this,function(t){switch(t.label){case 0:return[4,this._template.getChangeMessages(this._dispatch,this._syncToken,this._driveUrlParts)];case 1:e=t.sent();this._syncToken=e.syncToken?e.syncToken:"latest";this._getChangesAttempts=0;return[2,e]}})})};e.prototype._onNotification=function(){return Object(a.__awaiter)(this,void 0,void 0,function(){var e;return Object(a.__generator)(this,function(t){switch(t.label){case 0:t.trys.push([0,2,,3]);if(this._template.hasPendingRequest())return[2];this._isTestMode&&this._onNotificationReceived&&this._onNotificationReceived();return[4,this._resolveChangeMessages()];case 1:t.sent();return[3,3];case 2:e=t.sent();this._log("onNotification error",e);return[3,3];case 3:return[2]}})})};e.prototype._resolveChangeMessages=function(){return Object(a.__awaiter)(this,void 0,void 0,function(){var t,n,i,s,o,u,f,l,c;return Object(a.__generator)(this,function(a){switch(a.label){case 0:t=new v.e({publisher:e});return[4,this._getChangeMessages()];case 1:n=a.sent();this._log("Change messages",n);i=this._processMessages(n.messages);this._log("Changes",i);t.merge(n.itemResolver);for(s=0,o=i;s<o.length;s++)switch((u=o[s]).type){case r.New:t.invalidateItems({items:(f={},f[u.invalidateKey]=[p.t],f)});break;case r.Update:u.hasSelection&&this._itemScopeItemKey?this._updateItems(u.invalidateKey):t.invalidateItems({items:(l={},l[u.invalidateKey]=[u.invalidateFacet],l)});break;case r.Delete:t.invalidateItems({items:(c={},c[u.invalidateKey]=[d.l],c)})}this._dispatch(t.execute());return[2]}})})};e.prototype._processMessages=function(e){var t=[];e.sort(function(e,t){return e.parentItemKey?0:1});for(var n=0;n<e.length;n++){var r=e[n],i=this._template.processMessage(this._dispatch,r,this._itemScopeItemKey);if(void 0!==i){this._log("Change",i.invalidateKey,i.reason);t.push(i)}else if(r.parentItemKey)for(var s=n+1;s<e.length;s++){if(e[s].itemKey===r.parentItemKey){e.splice(s,1);break}}}return t};e.prototype._updateItems=function(e){this._template.updateItems(this._dispatch,e)};e.prototype._log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];g.e.isFeatureEnabled(T)&&console.log.apply(console,Object(a.__spreadArrays)(["ItemAutoRefreshHelper"],e))};return e})(),k=n(716),L=n(843),A=n(79),O=n(4307),M=n(4306),_=n(11),D=n(228),P=n(45),H=n(1),B=n(55),j=n(403),F=n(104),I=n(108),q=n(118),R=n(174),U=n(113),z=n(577),W=n(717),X=n(1514),V=n(84),$=(function(){function e(e){this._dataRequestor=e.dataRequestor;this._rootItemKey=e.rootItemKey;this._pendingRequest=!1}e.prototype.onUnsubscribe=function(e){};e.prototype.getSubscription=function(e){var t,n,r,i,s,o,u,a,f,l=this,c=e(Object(q.e)(function(e){return{spItem:e.demandItemFacet(B.e,l._rootItemKey)}})).spItem;if((null===(t=c)||void 0===t?void 0:t.webAbsoluteUrl)&&c.listFullUrl){var h=F.e.serialize({webAbsoluteUrl:null===(n=c)||void 0===n?void 0:n.webAbsoluteUrl,listFullUrl:null===(r=c)||void 0===r?void 0:r.listFullUrl}),p=e(Object(q.e)(function(e){return e.demandItemFacet(H.Je,h)}));if((null===(i=p)||void 0===i?void 0:i.notificationUrl)&&(null===(s=p)||void 0===s?void 0:s.expirationDateTime)&&(null===(o=p)||void 0===o?void 0:o.subscribeID))return{notificationUrl:null===(u=p)||void 0===u?void 0:u.notificationUrl,expirationDateTime:null===(a=p)||void 0===a?void 0:a.expirationDateTime,id:null===(f=p)||void 0===f?void 0:f.subscribeID}}};e.prototype.hasPendingRequest=function(){return this._pendingRequest};e.prototype.getChangeMessages=function(e,t,n){var r;return Object(a.__awaiter)(this,void 0,void 0,function(){var i,s,o,u,f,l,c,h,p,d,m,g,b,w,E,S,x,T,N,C,k,O,M,_,D,P,j,$,J,K,Q,G=this;return Object(a.__generator)(this,function(Y){switch(Y.label){case 0:if(void 0===n||void 0===n.endpoint||void 0===n.driveId)throw"Invalid drive url parts";i=n.endpoint+"/drives/"+n.driveId;s=e(Object(R.e)({isTAB:A.x})).isTAB;o=e(Object(q.e)(function(e){return{spItem:e.demandItemFacet(B.e,G._rootItemKey)}})).spItem;u=new v.e;if("latest"===t&&o){f=F.e.serialize({webAbsoluteUrl:o.webAbsoluteUrl,listFullUrl:o.listFullUrl});l=e(Object(q.e)(function(e){return e.demandItemFacet(H.Ue,f)}));if(c=null===(r=l)||void 0===r?void 0:r.tick){h=c-621355968e9;h/=1e4;p=new Date(h);if(!y.t.isActivated("90f6bcb1-03a0-4a02-9370-1e6807d6763a","7/22/2021","Fix Item Auto Refresh Bug")){t=""+p.toISOString();d=new Date;if((d.getTime()-p.getTime())/1e3<30)return[2,{syncToken:t,messages:[],itemResolver:u}]}return[2,{syncToken:""+p.toISOString(),messages:[],itemResolver:u}]}}return(b=n.endpoint)?[4,e(Object(L.getSessionToken)({endpoint:n.endpoint,driveUrl:i}))]:[3,2];case 1:b=Y.sent();Y.label=2;case 2:if(void 0===(m=(g=b)&&g.accessToken))throw new V.e({code:"authFailure"});this._pendingRequest=!0;w=i+"/root/view.delta?token="+encodeURIComponent(t);return[4,this._dataRequestor.send({apiName:"viewDelta",path:w,accessToken:{accessToken:m,tokenUrl:i},useAuthorizationHeaders:!0,headers:Object(a.__assign)({"X-RestrictedReadCapabilities":"ForceCheckOut,RequiredColumn,ContentApproval,Irm,ExcludeFromOfflineClient,DocumentParser,DraftItemSecurity,ItemLevelPermissions"},s?{}:{ScenarioType:"BGO"})})];case 3:E=Y.sent();S=[];if(E&&E.value)for(x=0,T=E.value;x<T.length;x++){N=T[x];C=void 0;k={endpoint:n.endpoint,driveId:n.driveId,itemId:N.id};if(N.root){P=Object(z.t)(k);for(O=0,M=P;O<M.length;O++){J=M[O];u.mapKeys({mappings:(K={},K[J]=this._rootItemKey,K)})}}else if(N.webUrl&&(_=Object(W.n)(N.webUrl))){D=X.e.serialize({itemFullUrl:_});if(e(Object(I.e)({spItemKey:B.e},D)).spItemKey){P=Object(z.t)(k);for(j=0,$=P;j<$.length;j++){J=$[j];u.mapKeys({mappings:(Q={},Q[J]=D,Q)})}}}if(!N.root){N.parentReference&&(C=N.parentReference.id);S.push({itemKey:U.e.serialize(k),parentItemKey:C&&U.e.serialize({endpoint:n.endpoint,driveId:n.driveId,itemId:C}),isDeleted:!!N.deleted,isShared:!!N.shared,name:N.name,dateModified:N.lastModifiedDateTime,eTag:N.eTag})}}this._pendingRequest=!1;return[2,{syncToken:E["@delta.token"],messages:S,itemResolver:u}]}})})};e.prototype.updateItems=function(e,t,n){};e.prototype.processMessage=function(e,t,n){if(t.isDeleted){if(e(Object(I.e)({deleted:d.l},t.itemKey)).deleted)return;return{type:r.Delete,invalidateKey:t.itemKey,reason:"Deleted"}}var i=e(Object(I.e)({spItemKey:B.e,mediaTransformSchema:D.e,displayName:d.h},t.itemKey)),s=i.spItemKey,o=i.mediaTransformSchema,u=i.displayName;if(void 0===s){if(!t.parentItemKey)return;return{type:r.New,invalidateKey:t.parentItemKey,reason:"New item"}}if(o&&t.eTag){var a=o[".etag"];if(a&&t.eTag&&t.eTag!==a)return{type:r.Update,invalidateKey:t.itemKey,invalidateFacet:D.e,reason:"eTag changed from "+a+" to "+t.eTag}}if(void 0!==t.name&&u!==t.name)return{type:r.Update,invalidateKey:t.itemKey,invalidateFacet:d.h,reason:"Name changed from "+u+" to "+t.name}};return e})(),J=n(263),K=n(35),Q=n(47),G=n(825),Y=n(49),Z=n(188),ee=n(162),te=n(735),ne={ODB:819,ODC:"EnablePushChannelLogging"},re=(function(){function e(e){this._dispatch=e.dispatch;this._webAbsoluteUrl=e.webAbsoluteUrl;this._listFullUrl=e.listFullUrl;this._listId=e.listId}e.prototype.getSocketIoSubscription=function(e){return Object(a.__awaiter)(this,void 0,void 0,function(){var t,n,r,i,s,o,u,f,c,h,p,d,v,m,g;return Object(a.__generator)(this,function(a){switch(a.label){case 0:if(e.existingSubscription)return[3,5];n=Object(te.n)({webAbsoluteUrl:this._webAbsoluteUrl}).segments("microservicemanager","getserviceurls").parameter("service","push");return[4,this._dispatch(Object(ee.t)({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl,url:n.toString(),method:"GET",qosName:"GetServiceUrls",noRedirect:!0})).catch(function(e){Z.n.isFeatureEnabled(ne)&&console.log("Error getting service url: ",e)})];case 1:r=a.sent();i=this._dispatch(Object(R.e)({isTest:A.x})).isTest;if(!(s=r&&r.d&&r.d.GetServiceUrls&&r.d.GetServiceUrls.results&&r.d.GetServiceUrls.results[0])&&!i)throw new Error("Unable to retrieve PushChannel base url");i&&(s="https://northcentralus0-pushs.svc.ms");o=s+"/notifications/register";u=Y.e.generate();f=this._dispatch(Object(l.e)({name:"SubscriptionServiceGenericList.Register"}));c={correlationId:u};a.label=2;case 2:a.trys.push([2,4,,5]);return[4,G.e.start({url:o,method:"GET",headers:{"X-Correlation-Id":u},requestTimeoutInMS:1e4})];case 3:(h=a.sent())&&h.responseText&&h.responseText.length>0&&(p=JSON.parse(h.responseText))&&p.serverUrl&&p.webhookUrl&&(t=p.webhookUrl);if(void 0===t)throw new Error("Unable to retireve PushChannel notification url");this._dispatch(f({resultType:Q.t.success,extraData:c}));return[3,5];case 4:d=a.sent();this._dispatch(f({resultType:Q.t.failure,extraData:c}));throw d;case 5:v=Object(te.r)({webAbsoluteUrl:this._webAbsoluteUrl,listOrItemFullUrl:this._listFullUrl}).segment("lists").method("GetById",this._listId);if(e.existingSubscription){v=v.method("Subscriptions",{guid:e.existingSubscription.id}).segment("Update");t=e.existingSubscription.notificationUrl}else v=v.segments("Subscriptions","Add");m={parameters:{resource:this._listId,notificationUrl:t,expirationDateTime:new Date(Date.now()+3e5).toISOString(),clientState:""}};return[4,this._dispatch(Object(ee.t)({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl,url:v.toString(),body:JSON.stringify(m),qosName:"SubscriptionServiceGenericList.getSocketIoSubscription",method:"POST",noRedirect:!0}))];case 6:if((g=a.sent())&&g.d){delete g.d.__metadata;if(e.existingSubscription){g.d.id=e.existingSubscription.id;g.d.notificationUrl=e.existingSubscription.notificationUrl;g.d.expirationDateTime=m.parameters.expirationDateTime}return[2,g.d]}throw new Error("Invalid subscription object")}})})};e.prototype.deleteSocketIoSubscription=function(e){var t=Object(te.r)({webAbsoluteUrl:this._webAbsoluteUrl,listOrItemFullUrl:this._listFullUrl}).segment("lists").method("GetById",this._listId).method("Subscriptions",e.id);return this._dispatch(Object(ee.t)({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl,url:t.toString(),qosName:"SubscriptionServiceGenericList.deleteSocketIoSubscription",method:"DELETE",noRedirect:!0}))};return e})(),ie=n(315),se=n(44),oe=n(138),ue=n(317),ae=n(202),fe=(function(){function e(e){this._pushChannelService=e.pushChannelService;this._subscriptionService=e.subscriptionService;this._webAbsoluteUrl=e.webAbsoluteUrl;this._listFullUrl=e.listFullUrl;this._itemSetKey=e.itemSetKey;this._serverResponse=void 0;this._pendingRequest=!1}e.prototype.onUnsubscribe=function(e){if(0===e&&this._subscriptionService instanceof re){var t=this._pushChannelService.getSocketIoSubscription();t&&this._subscriptionService&&this._subscriptionService.deleteSocketIoSubscription(t)}};e.prototype.getSubscription=function(e){var t,n,r,i,s,o;if(this._webAbsoluteUrl&&this._listFullUrl){var u=F.e.serialize({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl}),a=e(Object(q.e)(function(e){return e.demandItemFacet(H.Je,u)}));if((null===(t=a)||void 0===t?void 0:t.notificationUrl)&&(null===(n=a)||void 0===n?void 0:n.expirationDateTime)&&(null===(r=a)||void 0===r?void 0:r.subscribeID))return{notificationUrl:null===(i=a)||void 0===i?void 0:i.notificationUrl,expirationDateTime:null===(s=a)||void 0===s?void 0:s.expirationDateTime,id:null===(o=a)||void 0===o?void 0:o.subscribeID}}};e.prototype.getChangeMessages=function(e,t,n){var r;return Object(a.__awaiter)(this,void 0,void 0,function(){var n,i,s,o,u,f,l,c,h,p,d,m,g,b,w,E,S,x,T,N,C,k,L,O,M,_,D,P,j,I,U,z,W,X=this;return Object(a.__generator)(this,function(V){switch(V.label){case 0:if("latest"===t){n=F.e.serialize({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl});i=e(Object(q.e)(function(e){return e.demandItemFacet(H.Ue,n)}));if(s=null===(r=i)||void 0===r?void 0:r.lastItemModifiedTime){o=new v.e;return[2,{syncToken:"SPO_LIST,"+s,messages:[],itemResolver:o}]}}this._pendingRequest=!0;if(l=!!t&&"SPO_LIST,"===t.substr(0,9)){c=t.split(",");h=c[1];p='<Gt><FieldRef Name="Modified" />';p+='<Value Type="DateTime" IncludeTimeValue="True" StorageTZ="True">'+h+"</Value>";u=p+="</Gt>";f=["ID","FileRef","Modified","Title"];d=this._getListColumns(e);for(m=0,g=d;m<g.length;m++)"ID"!==(b=g[m]).internalName&&"FileRef"!==b.internalName&&"Modified"!==b.internalName&&"Title"!==b.internalName&&f.push(b.internalName)}else{if(!y.t.isActivated("9e144a63-594c-45c9-8189-a4b0eb40e708","10/26/2021","Return empty messages and current time as sync token for initial sync")){this._pendingRequest=!1;return[2,{syncToken:"SPO_LIST,"+(new Date).toISOString(),messages:[],itemResolver:new v.e}]}f=["ID","FileRef","Modified"]}"ID";w=l;E=l?200:1;S=new J.e("<View></View>");u&&S.addFilters([u]);f&&S.replaceFields(f);S.updateSort({fieldName:"ID",isAscending:w});S.updateRowLimit({rowLimit:E,isPerPage:!1});x=e(Object(q.e)(function(e){return Object(se.e)(e,B.e.serialize({webAbsoluteUrl:X._webAbsoluteUrl,listFullUrl:X._listFullUrl}))}));return[4,e(Object(R.e)({isTAB:A.x}))];case 1:T=V.sent().isTAB;this._requestDatesInUtc=!x;return[4,e(Object(ie.e)({getItemContext:Object(a.__assign)(Object(a.__assign)({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl,qosName:"ItemAutoRefreshGenericList.GetChanges",viewXml:S.getEffectiveViewXml()},T?{}:{isBackground:!0}),{postDataContext:{requestDatesInUtc:this._requestDatesInUtc,needsSchema:!0},currentPageContext:x})}))];case 2:N=V.sent();this._serverResponse=N;C=N.ListData;k=C&&C.Row||[];L=[];O=l?this._getLastModifiedTimeInList(k,x):(new Date).toISOString();for(M=0,_=k;M<_.length;M++)if(void 0!==(D=_[M]).FileRef){P={};j=Object.keys(D);for(I=0,U=j;I<U.length;I++){z=U[I];W=0===z.indexOf("OData_")?z.substr(6):z;P[W]=D[z]}L.push(Object(a.__assign)(Object(a.__assign)({itemKey:B.e.serialize({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl,itemId:D.ID}),parentItemKey:B.e.serialize({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl}),isDeleted:!1,isShared:!1,name:D.Title||""},D.Modified?{dateModified:""+D.Modified}:{}),{fields:P}))}0===L.length&&L.push({itemKey:B.e.serialize({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl}),isDeleted:!1,isShared:!1});this._pendingRequest=!1;return[2,{syncToken:"SPO_LIST,"+O,messages:L,itemResolver:new v.e}]}})})};e.prototype.hasPendingRequest=function(){return this._pendingRequest};e.prototype.updateItems=function(e,t){if(t&&o.e.matches(this._itemSetKey)&&this._serverResponse){var n=o.e.deserialize(this._itemSetKey),r={webAbsoluteUrl:n.webAbsoluteUrl,listFullUrl:n.listFullUrl,rootFolder:n.rootFolder||""},i=e(Object(ae.n)({itemSetKey:r})),s=e(Object(ae.e)(n,i,"getSPItem")),u=e(Object(ue.t)({serverData:this._serverResponse,itemSetKey:r,contentTypes:i,currentPageContext:s.currentPageContext,isItemSetRequest:!1})).itemResolver;e(u.execute())}this._serverResponse=void 0};e.prototype.processMessage=function(e,t,n){var i=e(Object(q.e)(function(e){var r=Object(oe.e)(e,{itemsScopeItemKey:n});return e.isItemFacetResolved(B.e,t.itemKey)?{rowData:e.demandItemFacet(H.Mt,t.itemKey),spItemKey:e.demandItemFacet(B.e,t.itemKey),title:e.demandItemFacet(H.En,t.itemKey),selectedItemKeys:r}:{rowData:void 0,spItemKey:void 0,title:void 0,selectedItemKeys:r}})),s=i.rowData,o=i.spItemKey,u=i.title,a=i.selectedItemKeys,f=a&&a.length>0;if(void 0===t.parentItemKey){if(f)return;return{type:r.New,invalidateKey:t.itemKey,reason:"Deleted an unknown item"}}if(t.isDeleted){if(e(Object(I.e)({deleted:d.l},t.itemKey)).deleted||f)return;return{type:r.Delete,invalidateKey:t.itemKey,reason:"Deleted"}}if(void 0===o||void 0===s){if(!t.parentItemKey)return;if(void 0===e(Object(I.e)({spParentItemKey:B.e},t.parentItemKey)).spParentItemKey)return;return f?void 0:{type:r.New,invalidateKey:t.parentItemKey,reason:"New item"}}if(void 0!==u&&void 0!==t.name&&u!==t.name)return{type:r.Update,invalidateKey:t.itemKey,invalidateFacet:H.En,hasSelection:f,reason:'Item title changed from "'+u+'" to '+t.name+")"};if(t.fields){f||(this._serverResponse=void 0);for(var l=this._getListColumns(e),c=function(e){for(var n=e.internalName,i=0,o=Object.keys(t.fields).filter(function(e){return e!==n+".COUNT"&&0===e.indexOf(n)});i<o.length;i++){var u=o[i],a=s&&s[u],l=t.fields[u];try{"object"==typeof a&&(a=JSON.stringify(a));"object"==typeof l&&(l=JSON.stringify(l));if(h._requestDatesInUtc&&"DateTime"===e.fieldType){var c=Date.parse(a),p=Date.parse(l);if(!isNaN(c)&&!isNaN(p)){a=c;l=p}}}catch(e){continue}if(a!==l)return{value:{type:r.Update,invalidateKey:t.itemKey,invalidateFacet:H.Mt,hasSelection:f,reason:'Item field "'+n+'" changed from "'+a+'" ('+typeof a+') to "'+l+'" ('+typeof l+")"}}}},h=this,p=0,v=l;p<v.length;p++){var m=c(v[p]);if("object"==typeof m)return m.value}}};e.prototype._getLastModifiedTimeInList=function(e,t){var n=(new Date).toISOString();if(e&&e.length>0)for(var r=void 0,i=0,s=e;i<s.length;i++){var o=s[i];if(this._requestDatesInUtc){var u=o.Modified;if(u){f=new Date(u);if(void 0===r||r<f){r=f;n=""+u}}}else{var a=o["Modified."];if(a){var f=new Date(a),l=t&&t.webTimeZoneData?t.webTimeZoneData.Bias-f.getTimezoneOffset():0;l&&f.setTime(f.getTime()+6e4*l);if(void 0===r||r<f){r=f;n=f.toISOString()}}}}return n};e.prototype._getListColumns=function(e){var t=[],n=e(Object(I.e)({schema:p.o},this._itemSetKey)).schema,r=n&&n.columnKeys;if(r)for(var i=0,s=r;i<s.length;i++){var o=s[i],u=e(Object(I.e)({internalName:H.Te,fieldType:H.ce,mappedFieldType:H.Ke},o)),a=u.internalName,f=u.fieldType,l=u.mappedFieldType;void 0!==a&&void 0!==f&&void 0!==l&&l!==K.t.Title&&t.push({internalName:a,fieldType:f,mappedFieldType:l})}return t};return e})(),le=n(252),ce=n(353),he=n(53),pe=n(6),de=n(155),ve=n(200),me=n(160),ge=n(2537),ye=(function(){function e(e){this._connectionCallbacks={};this._notificationCallback=void 0;this._notificationId=void 0;this._siteId=e.siteId;this._listId=e.listId;this._isConnected=!1;this._client=e.dataSyncClient}e.prototype.isConnected=function(){return this._isConnected};e.prototype.getSocketIoSubscription=function(){};e.prototype.addConnectionHandler=function(e,t){this._connectionCallbacks[e]=t};e.prototype.removeConnectionHandler=function(e){this._connectionCallbacks[e]&&delete this._connectionCallbacks[e]};e.prototype.setupNotificationHandler=function(e,t){this._notificationCallback=t;return!0};e.prototype.disconnect=function(){this._notificationCallback=void 0;this._connectionCallbacks={};this._notificationId&&this._client&&this._client.removeListStatusCallback(this._notificationId);this._isConnected=!1};e.prototype.refreshSubscription=function(){return Object(a.__awaiter)(this,void 0,void 0,function(){return Object(a.__generator)(this,function(e){return[2,!0]})})};e.prototype.connect=function(e,t){return Object(a.__awaiter)(this,void 0,void 0,function(){var e,t,n,r,i,s;return Object(a.__generator)(this,function(o){switch(o.label){case 0:t=(e=this)._client,n=e._siteId,r=e._listId;i={siteId:n,listId:r};return[4,t.isListDataSyncEnabledAsync(i)];case 1:if(!o.sent())return[3,3];s=this;return[4,t.addListStatusCallbackAsync(this._onNotification.bind(this),i,{sendConnectionNotifications:!0})];case 2:s._notificationId=o.sent();return[2,!0];case 3:return[2,!1]}})})};e.prototype._onNotification=function(e){if(1===e.length){var t=e[0];t.dataRefreshNeeded?this._notificationCallback&&this._notificationCallback(void 0):t.state===ge.e.ListStatusConnected?this._notifyConnectionHandlers(!0):t.state===ge.e.ListStatusConnectionLost&&this._notifyConnectionHandlers(!1)}};e.prototype._notifyConnectionHandlers=function(e){this._isConnected=e;for(var t in this._connectionCallbacks)this._connectionCallbacks.hasOwnProperty(t)&&this._connectionCallbacks[t](e)};return e})(),be=n(227),we={ODB:860},Ee={ODB:818},Se=new pe.e("itemAutoRefreshHelper",{itemsScopeItemKey:Object(pe.s)(),spPageContextKey:Object(pe.s)()}),xe=Object(ce.e)(function(e){return{}});function Te(e){var t=e.spPageContextKey,n=e.pageContext,r=e.listId,i=e.webAbsoluteUrl,s=e.listFullUrl,o=e.isTAB,u=e.itemKey,a=e.driveUrl,f=e.itemsScopeItemKey,c=e.getDataSyncClient;return function(h){var p=h(xe),d=Se.serialize({itemsScopeItemKey:f,spPageContextKey:t}),v=p[d];if(!v){var m,g=void 0,b=void 0,w=!n||!Object(y.n)(n).isActivated("f3c67c53-3465-4927-924d-963e1011836b","09/29/2020","Skip checking the subscription service");if(c&&e.pushChannelService&&(w||e.subscriptionService)){g=e.pushChannelService;b=e.subscriptionService}else{if(n){var E=h(k.e).dataRequestor;b=new O.e({listId:r,webAbsoluteUrl:i},{dataRequestor:E})}else b=new re({dispatch:h,webAbsoluteUrl:i,listFullUrl:s,listId:r});g=new M.e({disableWebSockets:!0},{subscriptionService:b})}m=new fe({pushChannelService:g,subscriptionService:b,webAbsoluteUrl:i,listFullUrl:s,itemSetKey:u});v=p[d]=new C({id:d,isTestMode:o,onPushChannelConnected:function(){return window._isPushChannelConnected=!0},onNotificationReceived:function(){return window._tabPushNotification=!0},driveUrl:a,dispatch:h,template:m,itemsScopeItemKey:f,pushChannelService:g,logQoS:function(e){var t=h(Object(l.e)(e));return function(e){return h(t(e))}},onUnsubscribe:function(e){0===e&&delete p[d]}})}return v}}function Ne(e){var t=Object(le.t)();f.useLayoutEffect(function(){if(e.getDataSyncClient){var n=new Promise(function(n){(function(e){var t=this,n=e.pageContext,r=e.listId,i=e.getDataSyncClient;return i?i.then(function(i){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,s,o;return Object(a.__generator)(this,function(u){switch(u.label){case 0:t=void 0;s=void 0;return(o=i&&n&&r&&n.siteId)?[4,i.isListDataSyncEnabledAsync({listId:r,siteId:n.siteId})]:[3,2];case 1:o=u.sent();u.label=2;case 2:if(o){t=new ye({listId:r,siteId:n.siteId,dataSyncClient:i});s=void 0;return[2,Te(Object(a.__assign)(Object(a.__assign)({},e),{subscriptionService:s,pushChannelService:t}))]}return[2,Te(e)]}})})}):Promise.resolve(Te(e))})(e).then(function(e){var r=t(e);n(r.subscribe())})});return function(){n.then(function(e){return e()})}}return t(Te(e)).subscribe()},[]);return null}function Ce(e){var t=Object(le.t)();f.useLayoutEffect(function(){return t((function(e){var t=this,n=e.spPageContextKey,r=e.webAbsoluteUrl,i=e.listFullUrl,s=e.isTAB,o=e.driveUrl,u=e.endpoint,f=e.itemsScopeItemKey;return function(e){var c=e(xe),h=Se.serialize({itemsScopeItemKey:f,spPageContextKey:n}),p=c[h];if(!p){var d,v,m=e(k.e).dataRequestor;v=new $({dataRequestor:m,rootItemKey:B.e.serialize({webAbsoluteUrl:r,listFullUrl:i,rootFolder:""})});d=new M.e({disableWebSockets:!0},{subscriptionService:new O.e({},{dataRequestor:m}),sessionTokenFetcher:function(){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,n,r;return Object(a.__generator)(this,function(i){switch(i.label){case 0:return(n=u)?[4,e(Object(L.getSessionToken)({endpoint:u,driveUrl:o}))]:[3,2];case 1:n=i.sent();i.label=2;case 2:if(!(r=(t=n)&&t.accessToken))throw new V.e({code:"authFailure"});return[2,{accessToken:r,tokenUrl:o}]}})})}});p=c[h]=new C({id:h,isTestMode:s,onPushChannelConnected:function(){return window._isPushChannelConnected=!0},onNotificationReceived:function(){return window._tabPushNotification=!0},driveUrl:o,dispatch:e,itemsScopeItemKey:f,template:v,pushChannelService:d,logQoS:function(t){var n=e(Object(l.e)(t));return function(t){return e(n(t))}},onUnsubscribe:function(e){0===e&&delete c[h]}})}return p}})(e)).subscribe()},[]);return null}var ke=Object(c.t)()(function(){return function(e){return function(e,t){var n,r=t.itemKey;if(!r)return{};var i=e.demandItem({key:o.e},r).key;if(!i||!i.webAbsoluteUrl||!i.listFullUrl)return{};var s=i.webAbsoluteUrl,u=i.listFullUrl,a=j.e.serialize({webAbsoluteUrl:s,listFullUrl:u}),l=e.demandItemFacet(H.hn,a);if(!Object(P.e)(e,{feature:we,pageContext:l})||!Object(P.e)(e,{feature:Ee,pageContext:l}))return{};var c=Object(be.c)(function(t){return Object(P.e)(e,{feature:t})},be.e.SharePointList)?null===(n=e.demandItemFacet(H.Xt,me.e))||void 0===n?void 0:n.dataSyncClient:void 0,p=F.e.serialize({webAbsoluteUrl:s,listFullUrl:u}),d=e.demandItem({listFacets:H.Ue,listMediaTransformSchema:D.t},p),v=d.listFacets,m=d.listMediaTransformSchema;if(!v||void 0===v.id||void 0===v.templateType)return{};var g=v.isDocumentLibrary,y=_.s(v.templateType);if(!g&&!y)return{};var w,E=Object(h.e)(e,{isTAB:A.x}).isTAB,S=m&&m[".driveUrl"],x=S&&Object(b.e)(S),T=x&&x.endpoint,N=Object(he.e)(e).itemsScopeItemKey||"itemsSCopeItemKey";if(g&&!S)return{};var C=Object(de.e)(e,{itemsScopeItemKey:N});if(C&&C.id===ve.e.id)return{};if(g){if(!m)return{};if(!S)return{};if(E){var k=m[".driveAccessToken"];w=k&&k.replace("access_token=","")}if(!x)return{};var L=x.driveId;return T&&L?{isAvailable:!0,itemSubscriber:f.createElement(Ce,{spPageContextKey:a,driveUrl:S,isTAB:E,listFullUrl:u,endpoint:T,driveAccessToken:w,webAbsoluteUrl:s,pageContext:l,itemsScopeItemKey:N})}:{}}return{isAvailable:!0,itemSubscriber:f.createElement(Ne,{spPageContextKey:a,isTAB:E,itemKey:r,listFullUrl:u,webAbsoluteUrl:s,listId:v.id,pageContext:l,driveUrl:S,itemsScopeItemKey:N,getDataSyncClient:c})}}}});var Le=Object(i.t)(function(){return function(e){e(Object(s.e)(o.e,u.e)(ke))}})},4950:function(e,t,n){"use strict";n.r(t);n.d(t,"ItemLibrariesDropdown",function(){return M});n.d(t,"LibrariesDropdown",function(){return _});var r=n(0),i=n("react-lib"),s=n(134),o=n(4233),u=n(205),a=n(92),f=n(104),l=n(958),c=n(39),h=n(9),p=n(5),d=n(55),v=n(1),m=n(557),g=n(153),y=n(11),b=n(363),w=n(25),E=n(754),S=n(14),x=new(n(20).e)("LibrariesDropdownControl",{}),T=n(129),N=n(148),C=n(225),k=n(80),L=Object(k.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee(5,1766)];case 1:return[2,e.sent().ActionContextMenu]}})})}),A={component:"LibrariesDropdown;"},O=Object(T.t)({withContext:A}),M=Object(C.n)(O)(function(e){var t=i.useRef(null),n=i.useState(!1),r=n[0],S=n[1],C=Object(g.e)(function(){return S(!1)}),k=Object(c.e)("librariesDropdown_6ac370b8",e.className,r?"librariesDropdownOpen_6ac370b8":"librariesDropdownNotOpen_6ac370b8");return i.createElement(u.e,null,function(n){var u,g=n.itemCache,A=(n.dispatch,null===(u=Object(T.n)(g))||void 0===u?void 0:u.telemetry),O=e.itemKey,M=g.demandItemFacet(d.e,O),_=g.demandItemFacet(a.e,O),D=Object(E.e)(g);if(M||_){var P=Object(w.e)(g,{enableLibrariesDropdown:v.j}).enableLibrariesDropdown,H=void 0,B=void 0,j=void 0;if(M){H=M.webAbsoluteUrl;B=M.rootFolder;j=f.e.serialize(M)}else{if(!_)return null;H=_.webAbsoluteUrl;B=_.rootFolder;j=f.e.serialize(_)}var F=g.demandItemFacet(v.Ue,j),I=!(D||!P||!F||F.templateType!==y.n.documentLibrary||""!==B),q=g.demandItemFacet(x,O);if(!x.evaluate(q)(g,{itemKey:O,isAvailable:I}).isAvailable)return null;var R=[],U=null;if(r){var z=g.demandItemFacet(h.e,l.e.serialize({webAbsoluteUrl:H}));if(z&&z.itemKeys&&z.itemKeys.length){U=function(){A&&A(N.e).logData({name:"LibrariesDropdown.Load",component:"LibrariesDropdown;",objectType:"Libraries",extraData:{numberOfLibraries:z.itemKeys.length},isIntentional:!0})};R=z.itemKeys.map(function(e){return{key:e,name:g.demandItemFacet(p.h,e)||"",action:i.createElement(b.e,{itemKey:e})}})}}return i.createElement(i.Fragment,null,i.createElement("button",{className:k,onClick:r?C:function(){A&&A(N.e).logData({name:"LibrariesDropdown.OpenDropdown",component:"LibrariesDropdown;",isIntentional:!0});S(!0)},ref:t,"aria-label":o.e,title:o.e},i.createElement(m.e,{iconName:"Library",className:Object(c.e)("librariesDropdownIcon_6ac370b8")}),i.createElement(m.e,{iconName:"ChevronDown",className:Object(c.e)("librariesDropdownChevron_6ac370b8")})),r?i.createElement(L,{commands:R,target:t.current,directionalHint:s.e.bottomLeftEdge,alignTargetEdge:!0,onDismiss:C,isOpen:!0,onMenuOpened:U||void 0}):null)}return null})}),_=Object(S.e)()(M)}}]);