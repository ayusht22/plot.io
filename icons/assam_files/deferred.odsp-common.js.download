(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([["deferred.odsp-common"],{1133:function(e,t,n){"use strict";n.d(t,"i",function(){return x});n.d(t,"n",function(){return T});n.d(t,"s",function(){return N});n.d(t,"o",function(){return k});n.d(t,"t",function(){return L});n.d(t,"r",function(){return A});n.d(t,"u",function(){return O});n.d(t,"e",function(){return M});var r,i,s,o,u,a,f,l,c,h,p=n(0),d=n(573),v=n(1703),m=n(328),g=n(16),y=n(212),b=n(364),w=n(309),E=void 0,S={ODB:1469,ODC:"ChromiumDateFix"};function x(e,t){void 0===t&&(t=!1);return b.n(e,M(m.e.language),t)}function T(e,t,n,r,i,s){void 0===t&&(t=!1);void 0===n&&(n=!1);void 0===r&&(r=!1);var o=Date.now()-e.getTime(),u=(function(){var e=new Date;e.setHours(0,0,0,0);return e})(),a=H(u,-1),f=H(u,-6),l=i||{},c=l.displayMinutesToOneHour,h=void 0===c||c,p=l.displayHoursToOneDay,g=void 0===p||p,y=l.displayHoursInDates,E=void 0===y||y,S=l.displayShortenedWeekday,x=void 0===S||S,T=M(s||m.e.language);if(h&&o<-5*w.n)return e.toLocaleDateString(T,j({month:"short",day:"numeric"},r));if(o<w.o)return n?v.n:v.t;if(h&&o<w.t)return B(o,v.i,w.n);if(w.l(u,e))return g?B(o,v.r,w.t):b.t("Today",n);if(e>=a)return t||!E?b.t("Yesterday",n):b.t("YesterdayAndTime",n).replace("{0}",e.toLocaleTimeString(T,j({hour:"numeric",minute:"2-digit"},r)));if(e>=f){var N=e.toLocaleDateString(T,j({weekday:"short"},r));return t?N:x||E?d.RelativeDateTime_DayAndTime.replace("{0}",N).replace("{1}",e.toLocaleTimeString(T,j({hour:"numeric",minute:"2-digit"},r))):e.toLocaleDateString(T,j({weekday:"long"},r))}return w.c(u,e)?T.match(/(^ja$)|(^ja-{1})/i)?e.toLocaleDateString(T,j({month:"long",day:"numeric"},r)):e.toLocaleDateString(T,j({month:"short",day:"numeric"},r)):e.toLocaleDateString(T,j({month:"short",day:"numeric",year:"numeric"},r))}function N(e){return b.r(e,M(m.e.language))}function C(){var e=r(),t=_();if(window.Intl&&window.Intl.DateTimeFormat){var n={},i={hour:"2-digit",minute:"2-digit"};s=new Intl.DateTimeFormat(e,n);o=new Intl.DateTimeFormat(e,i);if(t){n.timeZone="UTC";i.timeZone="UTC"}u=new Intl.DateTimeFormat(e,n);a=new Intl.DateTimeFormat(e,i);f=s.format;l=o.format;c=u.format;h=a.format}else{f=c=function(t){return t.toLocaleDateString(e)};l=h=function(t){return t.toLocaleTimeString(e)}}}function k(e,t){if(!e)return"";f||C();var n=w.l(new Date,e);return(t?n?h:c:n?l:f)(e)}function L(e,t){if(!e)return"";f||C();return(t?c:f)(e).replace(/[:\/\\]/g,"-")}function A(e,t){f||C();var n=t?c(e):f(e),r=t?h(e):l(e);return Object(g.format)(v.e,n,r)}function O(e,t){return w.p(e,M(m.e.language),t)}function M(e){if(void 0===E)try{E=y.e.isFeatureEnabled(S)}catch(e){E=!1}return E&&(function(e){void 0===P&&(function(){P={};var e=new Date(1900,0,1);try{for(var t={month:"long"},n=0,r=D;n<r.length;n++){var i=r[n];e.toLocaleDateString(i,t).match("M[0-9][0-9]")&&(P[i]=!0)}}catch(e){}})();if(e){e=e.toLowerCase();return P[e]}return})(e)?"en":e}r=function(){for(var e,t=0,n=[window.$Config&&window.$Config.mkt,m.e.language,navigator.language,"en"].filter(function(e){return!!e});t<n.length;t++){var i=n[t];try{(new Date).toLocaleDateString(i);e=i;break}catch(e){}}e=M(e);r=function(){return e};return e};function _(){if(void 0===i)try{var e=r();(new Date).toLocaleDateString(e,{timeZone:"UTC"});i=!0}catch(e){i=!1}return i}var D=["eu-es","af-za","az-latn-az","bs-latn-ba","cy-gb","ga-ie","gl-es","ha-latn-ng","hy-am","ig-ng","is-is","ka-ge","kk-kz","km-kh","ky-kg","mk-mk","mn-mn","mt-mt","ne-np","nn-no","or-in","pa-in","si-lk","sq-al","ur-pk","uz-latn-uz","yo-ng","zu-za","pa-arab-pk","ku-arab-iq","be-by","rw-rw","ti-et","tg-cyrl-tj","eu","af","az","bs","cy","ga","gl","ha","hy","ig","is","ka","kk","km","ky","mk","mn","mt","ne","nn","or","pa","si","sq","ur","uz","yo","zu","pa","ku","be","rw","ti"],P=void 0;function H(e,t){return new Date(e.getFullYear(),e.getMonth(),e.getDate()+t,e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())}function B(e,t,n){var r=Math.round(e/n);return t.replace("{0}",String(r))}function j(e,t){return _()&&t&&e?Object(p.__assign)(Object(p.__assign)({},e),{timeZone:"UTC"}):e}},1601:function(e,t,n){"use strict";n.r(t);n.d(t,"getFirstConsistentlyInteractive",function(){return i});var r=n(1707);n.d(t,"restartLongTaskObserver",function(){return r.t});function i(e){void 0===e&&(e={});if("PerformanceLongTaskTiming"in window){return new r.e(e).getFirstConsistentlyInteractive()}return Promise.resolve(null)}},1649:function(e,t,n){"use strict";n.r(t);n.d(t,"asyncTypeResourceKey",function(){return c});n.d(t,"observablesFactoryTypeResourceKey",function(){return h});n.d(t,"eventGroupTypeResourceKey",function(){return p});n.d(t,"errorHandlerResourceKey",function(){return d});n.d(t,"BaseModel",function(){return v});var r=n(0),i=n(7),s=n(127),o=n(98),u=n(189),a=n(2027),f=n(493),l="@ms/odsp-shared/lib/base/BaseModel",c=new i.t({name:l+".asyncType",factory:new i.e(u.e)}),h=new i.t({name:l+".observablesFactoryType",factory:new s.r(a.e,{asyncType:c.optional})}),p=new i.t({name:l+".eventGroupType",factory:new i.e(o.t)}),d=new i.t({name:l+".errorHandler"}),v=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this,i=t.id,s=void 0===i?"":i;r.id=s;r._BaseModel_dependencies=n;return r}Object.defineProperty(t.prototype,"async",{get:function(){return this._BaseModel_getAsync()},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"events",{get:function(){return this._BaseModel_getEvents()},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"observables",{get:function(){return this._BaseModel_getObservables()},enumerable:!0,configurable:!0});t.prototype.subscribe=function(e,t,n){return this.observables.subscribe(e,t,{isBeforeChange:n})};t.prototype.createComputed=function(e,t){return this.observables.compute(e,t)};t.prototype.createPureComputed=function(e,t){return this.observables.pureCompute(e,t)};t.prototype.createBackgroundComputed=function(e,t){return this.observables.backgroundCompute(e,t)};t.prototype.addDisposable=function(e){return this.scope.attach(e)};t.prototype.trackPromise=function(e){var t=!1,n=this.scope.attach({dispose:function(){!t&&e.cancel&&e.cancel()}}),r=function(){t=!0;n.dispose()};e.done(r,r);return e};t.prototype.wrapObservable=function(e){return this.observables.wrap(e)};t.prototype.peekUnwrapObservable=function(e){return Object(a.r)(e)};t.prototype.createObservable=function(e){return this.observables.create(e)};t.prototype.unwrapObservable=function(e){return Object(a.i)(e)};t.prototype.isObservable=function(e){return Object(a.n)(e)};t.prototype._BaseModel_getAsync=function(){var e=new(this.scope.attached(this._BaseModel_getAsyncType()))(this,this._BaseModel_getErrorHandler());this._BaseModel_getAsync=function(){return e};return e};t.prototype._BaseModel_getEvents=function(){var e=new(this.scope.attached(this._BaseModel_getEventGroupType()))(this,this._BaseModel_getErrorHandler());this._BaseModel_getEvents=function(){return e};return e};t.prototype._BaseModel_getObservables=function(){var e=new(this.scope.attached(this._BaseModel_getObservablesFactoryType()))({owner:this});this._BaseModel_getObservables=function(){return e};return e};t.prototype._BaseModel_getAsyncType=function(){return this._BaseModel_dependencies.asyncType||this.resources&&this.resources.consume(c.optional)||u.e};t.prototype._BaseModel_getEventGroupType=function(){return this._BaseModel_dependencies.eventGroupType||this.resources&&this.resources.consume(p.optional)||o.t};t.prototype._BaseModel_getObservablesFactoryType=function(){return this._BaseModel_dependencies.observablesFactoryType||this.resources&&(this.resources.consume(h.optional)||Object(i.i)(a.e,{asyncType:this._BaseModel_getAsyncType()}))||a.e};t.prototype._BaseModel_getErrorHandler=function(){return this._BaseModel_dependencies.errorHandler||this.resources&&this.resources.consume(d.optional)};t.dependencies=Object(r.__assign)(Object(r.__assign)({},f.e.dependencies),{asyncType:c.optional,observablesFactoryType:h.optional,eventGroupType:p.optional,errorHandler:d.optional});return t})(f.e);t.default=v},1707:function(e,t,n){"use strict";n.d(t,"t",function(){return l});n.d(t,"e",function(){return c});var r=n(0),i=0;var s=["img","script","iframe","link","audio","video","source"];function o(e,t){for(var n=0,r=e;n<r.length;n++){var i=r[n];if(t.includes(i.nodeName.toLowerCase())||o(i.children,t))return!0}return!1}function u(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];a()&&console.log.apply(console,e)}function a(){try{if("sessionStorage"in window&&window.sessionStorage){var e=window.sessionStorage.enableTTILogging;return e&&"true"===e.toLowerCase()&&"undefined"!=typeof console&&!!console}}catch(e){}return!1}function f(e,t){if(e.length>2)return performance.now();for(var n=[],r=0,i=t;r<i.length;r++){var s=i[r];n.push({timestamp:s.start,type:"requestStart"});n.push({timestamp:s.end,type:"requestEnd"})}for(var o=0,u=e;o<u.length;o++){var a=u[o];n.push({timestamp:a,type:"requestStart"})}n.sort(function(e,t){return e.timestamp-t.timestamp});for(var f=e.length,l=n.length-1;l>=0;l--){var c=n[l];switch(c.type){case"requestStart":f--;break;case"requestEnd":if(++f>2)return c.timestamp;break;default:throw Error("Internal Error: This should never happen")}}return 0}function l(){window.__tti&&window.__tti.o.observe({entryTypes:["longtask"]})}var c=(function(){function e(e){var t=this;void 0===e&&(e={});this._useMutationObserver=!!e.useMutationObserver;this._trackNetworkRequests=!!e.trackNetworkRequests;this._minValue=e.minValue||null;this._requiredMainThreadQuietnessDurationInMilliseconds=e.requiredMainThreadQuietnessDurationInMilliseconds||5e3;this._requiredNetworkQuietnessDurationInMilliseconds=e.requiredNetworkQuietnessDurationInMilliseconds||5e3;var n=window.__tti&&window.__tti.e,r=window.__tti&&window.__tti.o;this._longTaskId=0;if(n){u("Consuming the long task entries already recorded.");this._longTasks=n.map(function(e){return t._createLongTask(e)});window.__tti.e=[]}else this._longTasks=[];r&&r.disconnect();this._networkRequests=[];this._incompleteJSInitiatedRequestStartTimes=new Map;this._timerId=void 0;this._timerActivationTime=-1/0;this._scheduleTimerTasks=!1;this._firstConsistentlyInteractiveResolver=null;this._performanceObserver=null;this._mutationObserver=null;this._registerListeners(this._trackNetworkRequests)}e.prototype.getFirstConsistentlyInteractive=function(){var e=this;return new Promise(function(t,n){e._firstConsistentlyInteractiveResolver=t;"complete"===document.readyState?e.startSchedulingTimerTasks():window.addEventListener("load",function(){e.startSchedulingTimerTasks()})})};e.prototype.startSchedulingTimerTasks=function(){u("Enabling FirstConsistentlyInteractiveDetector");this._scheduleTimerTasks=!0;var e=this._longTasks.length>0?this._longTasks[this._longTasks.length-1].end:0,t=f(this._incompleteRequestStarts(),this._networkRequests);this._rescheduleTimer(Math.max(this._trackNetworkRequests?t+this._requiredNetworkQuietnessDurationInMilliseconds:0,e))};e.prototype._rescheduleTimer=function(e){var t=this;if(this._scheduleTimerTasks){u("Attempting to reschedule FirstConsistentlyInteractive check to "+e);u("Previous timer activation time: "+this._timerActivationTime);if(this._timerActivationTime>e)u("Current activation time is greater than attempted reschedule time. No need to postpone.");else{clearTimeout(this._timerId);this._timerId=setTimeout(function(){t._checkTTI()},Math.max(0,e-performance.now()));this._timerActivationTime=e;u("Rescheduled firstConsistentlyInteractive check at "+e)}}else u("startSchedulingTimerTasks must be called before calling rescheduleTimer")};e.prototype._disable=function(){u("Disabling FirstConsistentlyInteractiveDetector");clearTimeout(this._timerId);this._scheduleTimerTasks=!1;this._unregisterListeners()};e.prototype._registerPerformanceObserver=function(e){var t=this;void 0===e&&(e=!0);this._performanceObserver=new PerformanceObserver(function(n){for(var r=0,i=n.getEntries();r<i.length;r++){var s=i[r];"resource"===s.entryType&&e&&t._networkRequestFinishedCallback(s);"longtask"===s.entryType&&t._longTaskFinishedCallback(s)}});this._performanceObserver.observe({entryTypes:e?["longtask","resource"]:["longtask"]})};e.prototype._registerListeners=function(e){void 0===e&&(e=!0);if(e){u=this._beforeJSInitiatedRequestCallback.bind(this),a=this._afterJSInitiatedRequestCallback.bind(this),f=XMLHttpRequest.prototype.send,l=i++,XMLHttpRequest.prototype.send=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];u(l.toString());this.addEventListener("readystatechange",function(){4===e.readyState&&a(l.toString())});return f.apply(this,t)};t=this._beforeJSInitiatedRequestCallback.bind(this),n=this._afterJSInitiatedRequestCallback.bind(this),r=window.fetch,window.fetch=function(){for(var e=[],s=0;s<arguments.length;s++)e[s]=arguments[s];return new Promise(function(s,o){var u=i++;t(u.toString());r.apply(void 0,e).then(function(e){n(u.toString());s(e)},function(e){n(e);o(e)})})}}var t,n,r,u,a,f,l;this._registerPerformanceObserver(e);this._useMutationObserver&&(this._mutationObserver=(function(e){var t=new MutationObserver(function(t){for(var n=0,r=t;n<r.length;n++){var i=r[n];("childList"===i.type&&o(i.addedNodes,s)||"attributes"===i.type&&s.includes(i.target.tagName.toLowerCase()))&&e(i)}});t.observe(document,{attributes:!0,childList:!0,subtree:!0,attributeFilter:["href","src"]});return t})(this._mutationObserverCallback.bind(this)))};e.prototype._unregisterListeners=function(){this._performanceObserver&&this._performanceObserver.disconnect();this._mutationObserver&&this._mutationObserver.disconnect()};e.prototype._beforeJSInitiatedRequestCallback=function(e){u("Starting JS initiated request. Request ID: "+e);this._incompleteJSInitiatedRequestStartTimes.set(e,performance.now());u("Active XHRs: "+this._incompleteJSInitiatedRequestStartTimes.size)};e.prototype._afterJSInitiatedRequestCallback=function(e){u("Completed JS initiated request with request ID: "+e);this._incompleteJSInitiatedRequestStartTimes.delete(e);u("Active XHRs: "+this._incompleteJSInitiatedRequestStartTimes.size)};e.prototype._networkRequestFinishedCallback=function(e){u("Network request finished",e);this._networkRequests.push({start:e.fetchStart,end:e.responseEnd});this._rescheduleTimer(f(this._incompleteRequestStarts(),this._networkRequests)+this._requiredNetworkQuietnessDurationInMilliseconds)};e.prototype._longTaskFinishedCallback=function(e){u("Long task finished",e);var t,n=this._createLongTask(e),r="longTaskEnd"+n.id;t=r,window.performance&&performance.mark&&performance.mark(t);n.endMarkName=r;this._longTasks.push(n);this._rescheduleTimer(n.end+this._requiredMainThreadQuietnessDurationInMilliseconds)};e.prototype._mutationObserverCallback=function(e){u("Potentially network resource fetching mutation detected",e);u("Pushing back FirstConsistentlyInteractive check by "+this._requiredNetworkQuietnessDurationInMilliseconds+" milliseconds.");this._rescheduleTimer(performance.now()+this._requiredNetworkQuietnessDurationInMilliseconds)};e.prototype._getMinValue=function(){return this._minValue?this._minValue:performance.timing.domContentLoadedEventEnd?performance.timing.domContentLoadedEventEnd-performance.timing.navigationStart:null};e.prototype._createLongTask=function(e){var t=e.startTime+e.duration;return{attribution:e.attribution,name:e.name,start:Math.round(e.startTime),end:Math.round(t),id:this._longTaskId++}};e.prototype._incompleteRequestStarts=function(){return Object(r.__spreadArrays)(Array.from(this._incompleteJSInitiatedRequestStartTimes.values()))};e.prototype._checkTTI=function(){u("Checking if First Consistently Interactive was reached...");var e=performance.timing.navigationStart,t=f(this._incompleteRequestStarts(),this._networkRequests),n=(window.chrome&&window.chrome.loadTimes?1e3*window.chrome.loadTimes().firstPaintTime-e:0)||performance.timing.domContentLoadedEventEnd-e,r=this._getMinValue(),i=performance.now();if(null!==r){u("Parameter values:");u("NavigationStart",e);u("lastKnownNetwork2Busy",t);u("Search Start",n);u("Min Value",r);u("Last busy",t);u("Current time",i);u("Long tasks",this._longTasks);u("Incomplete JS Request Start Times",this._incompleteRequestStarts());u("Network requests",this._networkRequests);var s=(function(e,t,n,r,i,s,o,u){if(s&&r-n<u)return null;var a=0===i.length?e:i[i.length-1].end;if(r-a<o)return null;if(a&&i.length>0){var f=i[i.length-1].endMarkName;f&&performance.measure("TTI",void 0,f)}return Math.max(a,t)})(n,r,t,i,this._longTasks,this._trackNetworkRequests,this._requiredMainThreadQuietnessDurationInMilliseconds,this._requiredNetworkQuietnessDurationInMilliseconds);if(s&&this._firstConsistentlyInteractiveResolver){u("maybeFCI",s);this._firstConsistentlyInteractiveResolver({tti:s,longTasks:this._longTasks});this._disable()}else{u("Could not detect First Consistently Interactive. Retrying in 1 second.");this._rescheduleTimer(performance.now()+1e3)}}else{u("No usable minimum value yet. Postponing check.");this._rescheduleTimer(Math.max(this._trackNetworkRequests?t+this._requiredNetworkQuietnessDurationInMilliseconds:0,i+1e3))}};return e})()},1721:function(e,t,n){"use strict";n.r(t);n.d(t,"EngagementHelper",function(){return u});n.d(t,"mergeEngagementData",function(){return a});n.d(t,"EngagementPartType",function(){return i.r});n.d(t,"EngagementPart",function(){return i.n});n.d(t,"EngagementBuilder",function(){return i.t});n.d(t,"ENGAGEMENT_ROOT",function(){return i.e});n.d(t,"clickEngagementPart",function(){return f.e});n.d(t,"keyPressEngagementPart",function(){return f.n});n.d(t,"dropEngagementPart",function(){return f.t});n.d(t,"getMostSpecificMatchingContext",function(){return l});var r=n(0),i=n(732),s=n(148),o=n(184),u=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this,i=n.handlers,o=void 0===i?[]:i,u=n.logData,a=void 0===u?function(e){return s.e.logData(e)}:u;r._handlers=o;r._logData=a;return r}t.prototype.logData=function(e){void 0===e&&(e={});if(this.contexts.length||e.name){for(var t=this.contexts.map(function(e,t){return{context:e,order:t}}).sort(function(e,t){return e.context.part.type-t.context.part.type||e.order-t.order}).map(function(e){return e.context}),n=e.name,i=void 0===n?t.map(function(e){return e.part.name}).join("."):n,s=e.isIntentional,o=void 0!==s&&s,u=e.extraData,f=Object(r.__rest)(void 0===u?{}:u,[]),l=Object(r.__rest)(e,["name","isIntentional","extraData"]),c=Object(r.__assign)({name:i,isIntentional:o,extraData:f},l),h=0,p=t;h<p.length;h++){var d=p[h],v=d.part,m=d.extraData,g=void 0===m?{}:m,y={};for(var b in g)y[v.name+"_"+b]=g[b];a(c,{extraData:y});a(c,d.part.getEngagementData(d)||{})}for(var w=0,E=this._handlers;w<E.length;w++){var S=E[w],x=S.getEngagementData.apply(S,t);x&&a(c,x)}this._logData(c)}};t.prototype.clone=function(e){return new t({},{engagementSource:{contexts:e},handlers:this._handlers,logData:this._logData})};return t})(i.t);function a(e,t){var n=t.extraData,i=void 0===n?{}:n,s=t.experiment;(function e(t,n){for(var r in n){var i=n[r];if("object"==typeof i&&i){var s="object"==typeof t[r]&&t[r]||{};t[r]=s;e(s,i)}else void 0!==i&&(t[r]=i)}})(e,Object(r.__rest)(t,["extraData","experiment"]));Object(o.e)(e.extraData,i);void 0!==s&&(e.experiment=s)}var f=n(3527);function l(e,t){for(var n=t.length-1;n>=0;n--){var r=t[n];if(e.matches(r))return r}}},1772:function(e,t,n){"use strict";n.r(t);n.d(t,"getFirstCPUIdle",function(){return o});function r(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];i()&&console.log.apply(console,e)}function i(){try{if("sessionStorage"in window&&window.sessionStorage){var e=window.sessionStorage.enableFCILogging;return e&&"true"===e.toLowerCase()&&"undefined"!=typeof console&&!!console}}catch(e){}return!1}var s=(function(){function e(e){this._longTaskId=0;this._checkFCIRunId=0;this._isDisposed=!1;var t=e.requiredMainThreadCPUIdleDurationInMilliseconds,n=e.measurementStartTime;this._measurementStartTime=n;this._requiredMainThreadCPUIdleDurationInMilliseconds=t;this._resultResolver={resolve:void 0,reject:void 0};this._fciPromise=void 0;this._longTasks=[];this._processLongTaskPreQueue();this._registerLongTaskObserver()}e.prototype.measureFCI=function(){var e=this;if(this._isDisposed)throw"FCIMeasurer is disposed.";this._fciPromise||(this._fciPromise=new Promise(function(t,n){e._resultResolver.resolve=t;e._resultResolver.reject=n}));this._tryScheduleNextCheck();return this._fciPromise};e.prototype._tryScheduleNextCheck=function(){var e=this;this._checkFCIRunId&&clearTimeout(this._checkFCIRunId);var t=this._findEarlestPossibleCheckTime(),n=performance.now(),r=Math.max(0,t-n);this._checkFCIRunId=setTimeout(function(){e._checkFCI()},r)};e.prototype._findEarlestPossibleCheckTime=function(){var e=this._getLatestLongTask(),t=e&&e.end||-1/0;return Math.max(t+this._requiredMainThreadCPUIdleDurationInMilliseconds,this._measurementStartTime+this._requiredMainThreadCPUIdleDurationInMilliseconds,performance.now())};e.prototype._checkFCI=function(){var e,t=performance.now(),n=this._longTasks?this._longTasks.length:0;r("Running checkFCI:");r("Measurement start time",this._measurementStartTime);r("Current time",t);r("Long tasks",this._longTasks);r("latestLongTaskEndTime",null===(e=this._longTasks[n-1])||void 0===e?void 0:e.end);if(!this._measurementStartTime||this._measurementStartTime<0)this._onFoundFCI(NaN);else if(0!==n){for(var i=this._longTasks[0],s=1;s<n;s++){var o=this._longTasks[s],u=Math.max(i.end,this._measurementStartTime);if(o.start>=this._measurementStartTime&&o.start-u>=this._requiredMainThreadCPUIdleDurationInMilliseconds){this._onFoundFCI(u,i.endMarkName);return}i=o}if(t-i.end>=this._requiredMainThreadCPUIdleDurationInMilliseconds){var a=i.end>this._measurementStartTime?i.endMarkName:void 0;this._onFoundFCI(Math.max(i.end,this._measurementStartTime),a)}}else t-this._measurementStartTime>=this._requiredMainThreadCPUIdleDurationInMilliseconds&&this._onFoundFCI(this._measurementStartTime)};e.prototype._onFoundFCI=function(e,t){t&&performance.measure("FCI",void 0,t);r("possibleFCI:",e);this._resultResolver.resolve&&this._resultResolver.resolve({fci:e,longTasks:this._longTasks});this._dispose()};e.prototype._dispose=function(){clearTimeout(this._checkFCIRunId);this._longTaskObserver.disconnect();this._isDisposed=!0};e.prototype._getLatestLongTask=function(){for(var e=void 0,t=0,n=this._longTasks;t<n.length;t++){var r=n[t];(!e||r.end>e.end)&&(e=r)}return e};e.prototype._processLongTaskPreQueue=function(){if(window.__fci){var e=window.__fci.o,t=window.__fci.e;if(e){for(var n=0,r=t;n<r.length;n++){var i=r[n];if("longtask"===i.entryType){var s=this._createLongTask(i);this._longTasks.push(s)}}e.disconnect()}}};e.prototype._registerLongTaskObserver=function(){var e=this;this._longTaskObserver=new PerformanceObserver(function(t){for(var n=0,r=t.getEntries();n<r.length;n++){var i=r[n];"longtask"===i.entryType&&e._longTaskFinishedCallback(i)}});this._longTaskObserver.observe({entryTypes:["longtask"]})};e.prototype._createLongTask=function(e){var t=e.startTime+e.duration;return{attribution:e.attribution,name:e.name,start:Math.round(e.startTime),end:Math.round(t),id:this._longTaskId++}};e.prototype._longTaskFinishedCallback=function(e){r("Long task finished: ",e);var t,n=this._createLongTask(e),i="longTaskEnd"+n.id;t=i,window.performance&&performance.mark&&performance.mark(t);n.endMarkName=i;this._longTasks.push(n);this._tryScheduleNextCheck()};return e})();function o(e){if("PerformanceLongTaskTiming"in window){return new s(e).measureFCI()}return Promise.resolve(null)}},1859:function(e,t,n){"use strict";n.d(t,"e",function(){return p});var r=n(0),i=n(1649),s=n(16),o=n(2021),u=n("knockout-lib");var a={init:function(e,t,n,r,i){u.applyBindingsToNode(e,{attr:{"data-automationType":t()}},i);if(i){var s=i.$component;if(s){var o=u.utils.unwrapObservable(t());if(o){var a=s.__automationTypeBinding$elements;a||(a=s.__automationTypeBinding$elements={});var f=a[o];f||(f=a[o]=[]);f.push(e);u.utils.domNodeDisposal.addDisposeCallback(e,function(){var t=f.indexOf(e);if(-1!==t){delete f[t];f.splice(t,1)}})}}}}},f=n(1864),l=n(26),c=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this,r=n.element.getAttribute("class");n.element.setAttribute("class",n._expandIconClassNames(r));return n}t.prototype._expandIconClassNames=function(e){var t={};if(e&&e.indexOf("ms-Icon--")>=0){for(var n=e.split(" "),r=[],i=0,s=n;i<s.length;i++){var o=s[i];this._lastClassesAdded&&this._lastClassesAdded[o]||r.push(o);if(0===o.indexOf("ms-Icon--")){var u=o.substring(9),a=Object(l.L)(u);if(a&&-1===n.indexOf(a)){t[a]=!0;r.push(a)}}}this._lastClassesAdded=t;return r.join(" ")}return e};t.after=["css","class"];return t})(f.e),h=n(184),p=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r.bindingHandlers={};r.automationId=t&&t.automationId||void 0;r.addBindingHandlers({automation:o.e,automationType:a,icon:c});return r}t.prototype.getAutomationElement=function(e){return Object(o.t)(this,e)};t.prototype.format=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return Object(s.format)(e,t)};t.prototype.addBindingHandlers=function(e){Object(h.e)(this.bindingHandlers,e)};return t})(i.default);t.t=p},1860:function(e,t,n){"use strict";n.d(t,"e",function(){return s});n.d(t,"t",function(){return o});var r=n("knockout-lib"),i=n(1136);function s(e){var t=e.tagName,n=e.template,i=e.viewModel,s=e.synchronous,o=void 0!==s&&s;r.components.register(t,{viewModel:i,template:n,synchronous:o});return e}function o(e,t){var n=document.createElement("script");n.setAttribute("type","text/html");n.id=e;i.e.setText(n,t);document.head.appendChild(n)}},1864:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var r=n(0),i=n(1649),s=n("knockout-lib"),o=n(2055),u=n(7),a=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r.element=t.element;r.valueAccessor=t.valueAccessor;r.allBindingsAccessor=t.allBindingsAccessor;r.bindingContext=t.bindingContext;r.controlsDescendantBindings=!1;return r}t.init=function(e,t,n,r,i){var a=new u.n(o.e(i)),f=new(this.supportsDependencies?a.resolved(this):a.injected(this))({element:e,allBindingsAccessor:n,valueAccessor:t,bindingContext:i});s.utils.domNodeDisposal.addDisposeCallback(e,function(){return f.dispose()});return{controlsDescendantBindings:f.controlsDescendantBindings}};t.dependencies=Object(r.__assign)({},i.default.dependencies);t.supportsVirtualElements=!1;t.supportsDependencies=!1;return t})(i.default);t.t=a},1972:function(e,t,n){"use strict";var r=n(305),i=(function(){function e(){}e.prototype.debounce=function(e){var t=this;this.clear();this._originalPromise=e;var n=new r.e(function(){return t._originalPromise.cancel()});this._originalPromise.done(function(e){t._clear(!1);n.complete(e)},function(e){t._clear(!1);n.error(e)});return n.getPromise()};e.prototype.clear=function(){this._clear(!0)};e.prototype.isExecuting=function(){return Boolean(this._originalPromise)};e.prototype._clear=function(e){if(this.isExecuting()){e&&this._originalPromise.cancel();this._originalPromise=null}};return e})();t.e=i},2021:function(e,t,n){"use strict";n.d(t,"t",function(){return i});var r=n("knockout-lib");function i(e,t){var n=e.__automationBinding$elements;return n&&n[t]}t.e={init:function(e,t,n,i,s){r.applyBindingsToNode(e,{attr:{"data-automationId":t()}},s);if(s){var o=s.$component;if(o){var u=r.utils.unwrapObservable(t());if(u){var a=o.__automationBinding$elements;a||(a=o.__automationBinding$elements={});a[u]=e;r.utils.domNodeDisposal.addDisposeCallback(e,function(){a[u]&&delete a[u]})}}}}}},2027:function(e,t,n){"use strict";n.d(t,"r",function(){return l});n.d(t,"i",function(){return c});n.d(t,"n",function(){return h});n.d(t,"t",function(){return p});var r=n(0),i=(n(2533),n(85)),s=n("knockout-lib");s.onError=function(e){i.e.log(e)};var o=n(356),u=n(189),a=n(1138),f=n(184);function l(e){return h(e)?e.peek():e}function c(e){return s.unwrap(e)}function h(e){return s.isObservable(e)}function p(e){return{defaultValue:e,reducer:function(e,t){return t}}}var d=(function(){function e(e,t){void 0===e&&(e={});void 0===t&&(t={});this._owner=e.owner;this._asyncType=t.asyncType}Object.defineProperty(e.prototype,"scope",{get:function(){return this._scope||(this._scope=new o.e)},enumerable:!0,configurable:!0});e.prototype.subscribe=function(e,t,n){var r,i=(void 0===n?{}:n).isBeforeChange;void 0!==i&&i&&(r="beforeChange");return this.scope.attach(e.subscribe(t,this._owner,r))};e.prototype.create=function(e){return s.observable(e)};e.prototype.createArray=function(e){return s.observableArray(e)};e.prototype.createCallback=function(e){var t=0,n=this.create({}),i=e.defaultValue,s=e.reducer,o=this.pureCompute(function(){return Object.keys(n()).map(function(e){return n()[e]}).reduce(function(e,t){return s(e,c(t))},c(i))});o.equalityComparer=a.n;return Object(f.e)(o,{register:function(e){var i,s=""+ ++t;n(Object(r.__assign)(Object(r.__assign)({},n.peek()),((i={})[s]=e,i)));return{dispose:function(){var e=n.peek(),t=s,i=(e[t],Object(r.__rest)(e,["symbol"==typeof t?t:t+""]));n(i)}}}})};e.prototype.compute=function(e,t){var n=this,r={owner:this._owner,disposeWhen:function(){return n.scope.isDisposed}},i=(function(e){return"object"==typeof e})(e)?e:{read:e},o=s.utils.extend(r,i);t&&s.utils.extend(o,t);var u=s.computed(o);return this.scope.attach(u)};e.prototype.pureCompute=function(e,t){var n={pure:!0};t&&s.utils.extend(n,t);return this.compute(e,n)};e.prototype.backgroundCompute=function(e,t){var n={deferEvaluation:!0};t&&s.utils.extend(n,t);return this._setupBackgroundTask(this.compute(e,n))};e.prototype.wrap=function(e){return h(e)?e:this.create(e)};e.prototype.peekUnwrap=function(e){return h(e)?e.peek():e};e.prototype.unwrap=function(e){return c(e)};e.prototype.isObservable=function(e){return h(e)};e.prototype.ignore=function(e){return(function(e){return s.ignoreDependencies(e)})(e)};e.prototype.dispose=function(){this._scope&&this._scope.dispose()};e.prototype._setupBackgroundTask=function(e){var t=this;this._backgroundTasks||(this._backgroundTasks=[]);this._backgroundTasks.push(e);this._backgroundTasksTimeoutId||(this._backgroundTasksTimeoutId=this._getAsync().setImmediate(function(){return t._runBackgoundTasks()}));return e};e.prototype._runBackgoundTasks=function(){for(;this._backgroundTasks.length;)this._backgroundTasks.shift()();delete this._backgroundTasksTimeoutId;delete this._backgroundTasks};e.prototype._getAsync=function(){var e=this._asyncType||u.e,t=this.scope.attach(new e(this));this._getAsync=function(){return t};return t};return e})();t.e=d},2055:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var r=n(0),i=n("knockout-lib");"boolean"==typeof i.options.preferJQueryEvents?i.options.preferJQueryEvents=!1:"boolean"==typeof i.options.useOnlyNativeEvents&&(i.options.useOnlyNativeEvents=!0);var s=n(7),o=n(597),u=n(3866);function a(e){var t,n;if(e&&e.$data&&e.$data.resources)return e.$data.resources;for(;(!(n=e.$data)||"object"!=typeof n||!(t=n.resources))&&e.$parentContext;)e=e.$parentContext;return t}var f={loadViewModel:function(e,t,n){n(function(n,f){void 0===n&&(n={});var l,c=i.contextFor(f.element),h=i.utils.unwrapObservable(n.resources)||a(c),p={owner:e,useFactoriesOnKeys:!0},d=h?new s.n(h,p):new s.n(p);n=Object(r.__assign)(Object(r.__assign)({},n),{resources:d});l=(function(e){return"function"==typeof e.createViewModel})(t)?t.createViewModel(n,f):new(d.injected(t))(n);var v=new u.e({name:e,viewModel:l,element:f.element,bindingContext:c});return Object(o.e)(l,function(){v.dispose();d.dispose()})})}};i.components.loaders.unshift(f)},2057:function(e,t,n){"use strict";n.d(t,"e",function(){return g});var r=n(0),i=n("react-lib"),s=n(1030),o=n(2223),u=n(36),a=n(4176),f=n(1958),l=n(3509),c=n(2134),h=n(3066),p=n(723),d=u.t.isActivated("41868B4D-8044-4ACF-8E89-CFD71EF69C3D","10/31/2021","fix people picker suggestion dup"),v=o.e,m=o.t,g=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._onResolveSuggestions=function(e){if(n._peoplePickerSearchPromise){n._peoplePickerSearchPromise.cancel();n._peoplePickerSearchPromise=void 0}if((e=e.trim()).length<2)return n.props.onResolvedSuggestions?n.props.onResolvedSuggestions([],e):[];var t=n._dataProvider.search(e.trim(),n._getPeoplePickerQueryParams());if(!t)return n.props.onResolvedSuggestions?n.props.onResolvedSuggestions([],e):[];var r=t.cached?t.cached:[];n._peoplePickerSearchPromise=t.promise;return n._peoplePickerSearchPromise.then(function(e){n._peoplePickerSearchPromise=void 0;return e?r.concat(e):[]}).then(function(t){var r=d?t:n._dedupeSuggestions(t);return n.props.onResolvedSuggestions?n.props.onResolvedSuggestions(r,e):r})};n._onGetMoreResults=function(e){n._onGetMoreResultsClicked&&n._onGetMoreResultsClicked();var t;if(n.props.peoplePickerQueryParams){(t=Object(r.__assign)({},n.props.peoplePickerQueryParams)).useGraph=!1;t.useSubstrate=!1}return n._dataProvider&&n._dataProvider.sharePointSearch&&t?n._dataProvider.sharePointSearch(e,t).then(function(t){if(n.props.onResolvedSuggestions){var r=n.props.onResolvedSuggestions(t,e);if(r instanceof Array)return r}return t}):[]};if(t.dataProvider)n._dataProvider=t.dataProvider;else{if(!t.context)throw new Error("No pageContext available for PeoplePickerProvider.");n._dataProvider=new a.e({pageContext:t.context,peoplePickerDataSource:t.dataSource})}n._handleGetMoreResultsInBaseClass=!!(n._dataProvider.canUseGraph&&n.props.peoplePickerQueryParams&&n._dataProvider.canUseGraph(n.props.peoplePickerQueryParams))&&!n.props.onGetMoreResults;n.state={hasUnresolvedText:!1,searchForMoreText:n._getSearchForMoreText(n._handleGetMoreResultsInBaseClass)};return n}Object.defineProperty(t.prototype,"selectedPeople",{get:function(){return this._peoplePicker&&this._peoplePicker.items||[]},enumerable:!0,configurable:!0});t.prototype.render=function(){var e=this.props,t=e.className,n=e.onRenderItem,s=e.onRenderSuggestionsItem,o=e.defaultSelectedItems,u=e.onSelectedPersonasChange,a=e.suggestionsHeaderText,f=e.suggestionsClassName,p=e.noResultsFoundText,d=e.loadingText,g=e.inputProps,y=e.onSuggestionSelected,b=e.suggestionsAvailableAlertText,w=e.enableSelectedSuggestionAlert,E=e.selectedItems,S=e.itemLimit,x=e.onInputChange,T=e.onGetMoreResults,N=e.searchForMoreIcon,C=e.searchForMoreText,k=e.ariaLabel,L=void 0===k?"":k,A=e.pickerCalloutProps,O=e.pickerOverrideStyles,M=e.theme,_=e.disabled,D=e.onGetMoreResultsClicked,P=e.removeButtonAriaLabel,H=e.onEmptyResolveSuggestions;this._onGetMoreResultsClicked=D;var B={className:t,onRenderSuggestionsItem:s||l.r,onResolveSuggestions:this._onResolveSuggestions,defaultSelectedItems:o,selectedItems:E,onChange:u,inputProps:g,enableSelectedSuggestionAlert:w,pickerSuggestionsProps:{suggestionsHeaderText:a,loadingText:d,noResultsFoundText:p,className:f,suggestionsAvailableAlertText:b,searchForMoreIcon:N,searchForMoreText:C||(this._handleGetMoreResultsInBaseClass?this.state.searchForMoreText:void 0),suggestionsContainerAriaLabel:h.t},onItemSelected:y,itemLimit:S,onInputChange:x,onGetMoreResults:T||(this._handleGetMoreResultsInBaseClass?this._onGetMoreResults:void 0),pickerCalloutProps:A,styles:O,theme:M,"aria-label":L,disabled:_,removeButtonAriaLabel:P,onEmptyResolveSuggestions:H};switch(this.props.peoplePickerType){case c.e.listBelow:B.onRenderItem=n||l.e;return i.createElement(m,Object(r.__assign)({},B,{componentRef:this._resolveRef("_peoplePicker")}));default:B.onRenderItem=n||l.t;return i.createElement(v,Object(r.__assign)({},B,{componentRef:this._resolveRef("_peoplePicker")}))}};t.prototype.focusInput=function(){this._peoplePicker&&this._peoplePicker.focusInput()};t.prototype._getPeoplePickerQueryParams=function(){if(this.props.peoplePickerQueryParams){!this.props.peoplePickerQueryParams.onToggleGetMoreResults&&this._handleGetMoreResultsInBaseClass&&(this.props.peoplePickerQueryParams.onToggleGetMoreResults=this._onToggleGetMoreResults);return this.props.peoplePickerQueryParams}return{allowEmailAddresses:!1,groupID:0,maximumEntitySuggestions:30,principalSource:15,blockExternalUsers:!0,principalType:f.e.user|f.e.securityGroup|f.e.sharePointGroup}};t.prototype._dedupeSuggestions=function(e){var t=this,n=[],i=this._peoplePicker&&this._peoplePicker.items||[];i=Object(r.__spreadArrays)(i);for(var s=function(e){var r=o._getItemKey(e);if(!i.some(function(e){var n=t._getItemKey(e);return r===n})){n.push(e);i.push(e)}},o=this,u=0,a=e;u<a.length;u++){s(a[u])}return n};t.prototype._getItemKey=function(e){return e.email||e.userId||Object(p.e)(JSON.stringify(e)).toString()};t.prototype._onToggleGetMoreResults=function(e){this.state&&(e&&!this.state.searchForMoreText||!e&&this.state.searchForMoreText)&&this.setState({searchForMoreText:this._getSearchForMoreText(e)})};t.prototype._getSearchForMoreText=function(e){return e?h.r:void 0};return t})(s.e)},2129:function(e,t,n){"use strict";var r,i=n(212),s={ODB:563,ODC:null,Fallback:!1};(function(e){e.isShortcutItem=function(e){return!(!e||!e.extension)&&t("."!==e.extension[0]?e.extension:e.extension.slice(1))};function t(e){return"url"===e||"website"===e}e.isShortcutFileType=t;e.isShortcutEnabled=function(){return i.e.isFeatureEnabled(s)};(function(e){e[e.UnknownError=0]="UnknownError";e[e.NewFileCreationFileAlreadyExistsError=1]="NewFileCreationFileAlreadyExistsError";e[e.InvalidCharacterError=2]="InvalidCharacterError"})(e.ShortcutErrors||(e.ShortcutErrors={}))})(r||(r={}));t.e=r},2134:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e[e.normal=0]="normal";e[e.listBelow=1]="listBelow"})(r||(r={}))},2154:function(e,t,n){"use strict";n.d(t,"e",function(){return l});var r=n(98),i=n(356),s="formFactorChange",o="hamburgerVisibilityChange",u="showCommandLabelsChange",a={Small:"sm",Medium:"md",Large:"lg",XLarge:"xlg",XXLarge:"xxlg",XXXLarge:"xxxlg",XXXXLarge:"xxxxlg"},f={Small:480,Medium:640,Large:1024,XLarge:1366,XXLarge:1920,XXXLarge:2560,XXXXLarge:1/0},l=(function(){function e(e,t){this._scope=new i.e;this._events=new(this._scope.attached(r.t))(this);this._events.on(window,"resize, orientationchange",this._onContainerResize.bind(this));var n=t.breakpoints;this._breakpoints="function"==typeof n?n:function(){return n};this._windowWidth=0;this._windowHeight=0;this._onContainerResize()}e.reduceBreakpoints=function(e,t){return{Small:t,Medium:e.Small,Large:e.Medium,XLarge:e.Large,XXLarge:e.XLarge,XXXLarge:e.XXLarge,XXXXLarge:1/0}};e.determineWindowSize=function(e,t){void 0===t&&(t=f);if(0===e)return"Medium";for(var n in f)if(e<t[n])return n};e.determineCssClass=function(e){return a[e]};e.getScrollbarWidth=function(){var e=document.createElement("div"),t=document.createElement("div"),n=e.style;n.visibility="hidden";n.width="100px";n.msOverflowStyle="scrollbar";n.overflow="scroll";t.style.width="100%";document.body.appendChild(e);e.appendChild(t);var r=e.offsetWidth,i=t.offsetWidth;e.parentNode.removeChild(e);var s=r-i;this.getScrollbarWidth=function(){return s};return s};Object.defineProperty(e.prototype,"windowWidth",{get:function(){return this._windowWidth},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"windowHeight",{get:function(){return this._windowHeight},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"formFactorSize",{get:function(){return this._formFactorSize},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"isHamburgerVisible",{get:function(){return this._isHamburgerVisible},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"showLabels",{get:function(){return this._showLabels},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"cssClass",{get:function(){return this._cssClass},enumerable:!0,configurable:!0});e.prototype.dispose=function(){this._scope.dispose()};e.prototype.compareSize=function(e,t){var n=this._breakpoints();return n[e]-n[t]};e.prototype._afterContainerResize=function(){};e.prototype._onContainerResize=function(){var t=document.body,n=document.documentElement,r=this._windowHeight=n.clientWidth||t.clientWidth;this._windowWidth=n.clientHeight||t.clientHeight;var i=this._formFactorSize,a=this._formFactorSize=e.determineWindowSize(r,this._breakpoints());this._cssClass=e.determineCssClass(a);var l=this._isHamburgerVisible;this._isHamburgerVisible=r<f.Large;var c=this._showLabels;this._showLabels=this.compareSize(a,"Medium")>0;i&&a!==i&&this._events.raise(s);"boolean"==typeof l&&l!==this._isHamburgerVisible&&this._events.raise(o);"boolean"==typeof c&&c!==this._showLabels&&this._events.raise(u);this._afterContainerResize()};e.DEFAULT_BREAKPOINTS=f;e.MAC_SCROLL_BAR_WIDTH=8;return e})();t.t=l},2204:function(e,t,n){"use strict";var r=n(912);n.d(t,"e",function(){return r.e});n.d(t,"t",function(){return r.t});n.d(t,"n",function(){return r.r})},2230:function(e,t,n){"use strict";var r=(function(){function e(t){var n;this._raw=t;if(t){t=(t=t.replace(/\u200e|\u200f/g,"")).trim();for(var r,i,s=new RegExp(e.EmailRegexPattern,"gi"),o=e.EmailMatchTypes.None,u=e.EmailMatchTypes.None;null!==(i=s.exec(t));){var a=i[0],f=a.charAt(0),l=a.charAt(a.length-1);if((u="<"===f&&">"===l?e.EmailMatchTypes.Bracketed:'"'===f&&'"'===l?e.EmailMatchTypes.Quoted:e.EmailMatchTypes.Bare)>o){r=i;o=u;if(u===e.EmailMatchTypes.Bracketed)break}}var c=t;if(r){n=r[0];var h=r.index,p=h+n.length,d=h>0?t.substr(0,h).trim():"",v=p<t.length?t.substr(p):"";if("'"===(n=e.StripBracketsAndQuotesRegex.exec(n)[1]).charAt(0)&&v&&"'"===v.charAt(0)){n=n.slice(1);v=v.slice(1).trim()}c=""===d?v:d;this._email=n.trim()}(c=c.replace(/^\s*"\s*/,"").trim()).length>1&&"/"!==c.charAt(c.length-2)&&(c=c.replace(/\s*"$/,""));""!==(c=c.replace(/\//g,""))&&c!==n&&(this._name=c)}}e.isValidEmailSyntax=function(t,n){return!!t&&!!(n?e.ValidEmailRegex:e.EmailRegex).exec(t.trim())};e.parse=function(t){if(!t)return[];for(var n=e._splitAddresses(t),r=[],i=0,s=n.length;i<s;i++)r.push(new e(n[i]));return r};e.endsWithDelimiter=function(t){if(t){var n=t.split(e.DelimiterRegex);return!n[n.length-1].trim()}return!1};e._splitAddresses=function(t){for(var n=t.split(e.DelimiterRegex),r=n.length-1;r>=0;r--){n[r]=n[r].trim();0===n[r].length&&n.splice(r,1)}return n};e.prototype.getEmail=function(){return this._email};e.prototype.getName=function(){return this._name};e.prototype.getRaw=function(){return this._raw};e.EmailRegexPattern="(?:[<\"]\\s*)?[a-z0-9\\u0080-\\uFFFF!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9\\u0080-\\uFFFF!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9\\u0080-\\uFFFF](?:[a-z0-9\\u0080-\\uFFFF-]*[a-z0-9\\u0080-\\uFFFF])?\\.)+[a-z0-9\\u0080-\\uFFFF](?:[a-z0-9\\u0080-\\uFFFF-]*[a-z0-9\\u0080-\\uFFFF])?(?:\\s*[>\"])?";e.EmailRegex=new RegExp(e.EmailRegexPattern,"i");e.ValidEmailRegexPattern="[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@((?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?)";e.ValidEmailRegex=new RegExp(e.ValidEmailRegexPattern,"i");e.StripBracketsAndQuotesRegex=/^[<"]?([^<>"]*)[>"]?$/;e.DelimiterRegex=/[,;](?=(?:[^"]*"[^"]*")*(?![^"]*"))/;e.EmailMatchTypes={None:0,Quoted:1,Bare:2,Bracketed:3};return e})();t.e=r},2289:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r;(function(e){e[e.none=0]="none";e[e.right=1]="right";e[e.flip=2]="flip";e[e.left=3]="left"})(r||(r={}));var i=r},2293:function(e,t,n){"use strict";var r=n(75),i=n(305),s=(function(){function e(e){this.concurrency=e||1;this._running=0;this._queue=[];this._promiseComplete=this._promiseComplete.bind(this)}e.prototype.enqueue=function(e){var t;if(this._running<this.concurrency){this._running++;(t=e()).then(this._promiseComplete,this._promiseComplete)}else{var n={callback:e,signal:null,canceled:!1,result:null};n.signal=new i.e(function(){n.canceled=!0;r.n.is(n.result)&&n.result.cancel()});this._queue.push(n);t=n.signal.getPromise()}return r.n.resolve(t)};e.prototype._promiseComplete=function(){var e=this;this._running--;if(this._running<this.concurrency&&this._queue.length){for(var t=this._queue.shift();t&&t.canceled;)t=this._queue.length?this._queue.shift():null;if(t){this._running++;t.result=t.callback();t.result.then(function(n){t.signal.complete(n);e._promiseComplete()},function(n){t.signal.error(n);e._promiseComplete()})}}};return e})();t.e=s},2395:function(e,t,n){"use strict";var r=n("knockout-lib"),i=(function(){function e(){this._originalProvider=new r.bindingProvider;this._bindingHandlers={};this._bindingContexts=[]}e.getInstance=function(){return e._instance};e.prototype.nodeHasBindings=function(e){return this._originalProvider.nodeHasBindings(e)};e.prototype.getBindings=function(e,t){try{this._bindingContexts.push(t);var n=this._originalProvider.getBindings(e,t);return n&&this._remapKeys(n,t)}finally{this._bindingContexts.pop()}};e.prototype.getBindingAccessors=function(e,t){try{this._bindingContexts.push(t);var n=this._originalProvider.getBindingAccessors(e,t);return n&&this._remapKeys(n,t)}finally{this._bindingContexts.pop()}};e.prototype.getBindingHandler=function(e){var t=this._bindingContexts.slice(-1)[0];if(t){var n=this._getLocalBindingHandlers(t);if(n){var i=n[e];e=i&&this.getUniqueKeyForBindingHandler(i,e)||e}}return this._bindingHandlers[e]||r.bindingHandlers[e]};e.prototype.getUniqueKeyForBindingHandler=function(t,n){var i=e._BINDING_PROVIDER_UNIQUE_KEY,s=t[i]=t[i]||n+"-local-"+ ++e._lastUniqueKeyOrdinal;this._bindingHandlers[s]={init:t.init&&t.init.bind(t),update:t.update&&t.update.bind(t),options:t.options,preprocess:t.preprocess&&t.preprocess.bind(t)};this._bindingHandlers[s].after=t.after;t.supportsVirtualElements&&(r.virtualElements.allowedBindings[s]=!0);return s};e.prototype._remapKeys=function(e,t){var n=e,r=this._getLocalBindingHandlers(t);if(r){n={};for(var i in e){var s=r[i];n[s&&this.getUniqueKeyForBindingHandler(s,i)||i]=e[i]}}return n};e.prototype._getLocalBindingHandlers=function(e){for(var t;!(t="object"==typeof e.$data&&e.$data.bindingHandlers)&&e.$parentContext;)e=e.$parentContext;return t};e._instance=new e;e._BINDING_PROVIDER_UNIQUE_KEY="__localBindingProvider__uniqueKey";e._lastUniqueKeyOrdinal=0;return e})(),s=i.getInstance();r.getBindingHandler=s.getBindingHandler.bind(s);r.bindingProvider.instance=s},2533:function(e,t,n){"use strict";n("knockout-projections-lib")},2537:function(e,t,n){"use strict";n.d(t,"e",function(){return a});n.d(t,"n",function(){return f});n.d(t,"t",function(){return l});n.d(t,"r",function(){return b});n.d(t,"i",function(){return w});var r=n(0),i=n(2538),s=n(2764),o=n(36),u=!1;var a,f,l,c,h,p,d=function(){return u};(function(e){e[e.None=0]="None";e[e.InSync=1]="InSync";e[e.ChangesSaved=2]="ChangesSaved";e[e.Syncing=3]="Syncing";e[e.Attention=4]="Attention";e[e.SyncConflict=5]="SyncConflict";e[e.SettingUp=6]="SettingUp";e[e.Unsupported=7]="Unsupported";e[e.Removed=8]="Removed";e[e.Error=9]="Error";e[e.ListStatusConnectionLost=10]="ListStatusConnectionLost";e[e.ListStatusConnected=11]="ListStatusConnected"})(a||(a={}));(function(e){e[e.UnknownError=0]="UnknownError"})(f||(f={}));(function(e){e[e.SetupRequired=0]="SetupRequired";e[e.SignInRequired=1]="SignInRequired"})(l||(l={}));(function(e){e.Create="Create";e.Update="Update";e.Delete="Delete"})(c||(c={}));(function(e){e[e.List=1]="List";e[e.ListItem=2]="ListItem";e[e.ListView=3]="ListView";e[e.ListField=4]="ListField";e[e.ListItemAttachment=5]="ListItemAttachment"})(h||(h={}));(function(e){e[e.Guid=1]="Guid";e[e.Path=2]="Path"})(p||(p={}));var v={api:{recycle:{isLeaf:!0},ValidateUpdateListItem:{isLeaf:!0},AttachmentFiles:{api:{"%self%":{returns:h.ListItemAttachment,idType:p.Guid,api:{usingFilepath:{isLeaf:!0},RecycleObject:{isLeaf:!0,capabilityString:"DeleteAttachment"}}},addUsingPath:{isLeaf:!0,capabilityString:"AddAttachment"},RecycleObject:{isLeaf:!0,capabilityString:"DeleteAttachment"}}},GetComments:{isLeaf:!0,capabilityString:"Comments"},Comments:{isLeaf:!0,capabilityString:"Comments"}}},m={api:{"%self%":{isLeaf:!0,idType:p.Guid,returns:h.ListItem,api:{SetViewXml:{isLeaf:!0}},httpMethodCapabilityStrings:{MERGE:"ViewsApiHttpMerge"}},Add:{isLeaf:!0}}},g={api:{RenderListDataAsStream:{isLeaf:!0},RenderExtendedListFormData:{isLeaf:!0},RenderListFilterData:{isLeaf:!0,capabilityString:"RenderListFilterData"},AddValidateUpdateItemUsingPath:{isLeaf:!0},BulkValidateUpdateListItems:{isLeaf:!0},GetItemById:{returns:h.ListItem,idType:p.Guid,api:v.api},items:{idType:p.Guid,returns:h.ListItem,api:v.api},Views:{isLeaf:!0,api:m.api},Fields:{isLeaf:!0,api:{"%self%":{isLeaf:!0},GetByInternalNameOrTitle:{isLeaf:!0,returns:h.ListField,idType:p.Path,api:{DeleteObject:{isLeaf:!0}}},CreateFieldAsXml:{isLeaf:!0}}},contentTypes:{isLeaf:!0,capabilityString:"EnumerateContentTypes"}}},y={api:{web:{api:{api:{GetList:{returns:h.List,idType:p.Path,api:g.api},GetListUsingPath:{returns:h.List,idType:p.Path,api:g.api},Lists:{api:{"%self%":{returns:h.List,idType:p.Guid,api:g.api},GetListUsingPath:{returns:h.List,idType:p.Path,api:g.api},GetList:{returns:h.List,idType:p.Guid,api:g.api},GetById:{returns:h.List,idType:p.Guid,api:g.api}}}}}.api},"sp.ListHomeItemCollection.GetListHomePersonalLists":{isLeaf:!0,doNotBind:!0,offlineOnly:!0,typeOverrides:new Map([[s.e.ListHomeEnumeration,{offlineOnly:!1}]])},"SP.FavoriteLists.GetListsBy":{isLeaf:!0,doNotBind:!0,offlineOnly:!0,typeOverrides:new Map([[s.e.ListHomeEnumeration,{offlineOnly:!1}]])},"sp.RecentListCollection.GetRecentLists":{isLeaf:!0,doNotBind:!0,offlineOnly:!0,typeOverrides:new Map([[s.e.ListHomeEnumeration,{offlineOnly:!1}]])},$batch:{isLeaf:!0},"SP.List.GetListDataAsStream":{capabilityString:"StaticGetListDataAsStream",isLeaf:!0}}};function b(e,t,n,s,u){var a=new URL(e);Object(i.t)("getListOperationFromUrl called: "+Object(i.e)(e));var f=e.indexOf("InplaceSearchQuery");if(!n.offline&&f>0)Object(i.t)("Performing search online");else{var l=(function(e,t){var n=e.indexOf("/_api");if(-1!==n){Object(i.t)("server: "+Object(i.e)(t.hostname));var r=e.substring(0,n);Object(i.t)("site: "+Object(i.e)(r));var s=t.pathname.substring(t.pathname.indexOf("/_api")+"/_api".length);if(0!==s.length){Object(i.t)("api: "+s);return{siteUrl:r,api:s}}Object(i.t)("Did not find api, url unsupported")}else Object(i.t)("Did not find api marker, url unsupported")})(e,a);if(l){var c,v,m,g,b,E,S=l.api,x=l.siteUrl,T=S.split("/"),N=y,C="root",k=!1;if(!N.disabled||d()){for(var L=function(e){if(0===e.length)return"continue";if(!N.api){Object(i.t)("Node "+C+", no api, chunk: "+e);return{value:void 0}}var a=e.match(new RegExp("([^\\(]*)(\\((\\w+=)?(\\S*?)\\)|$)"));if(!a){Object(i.t)("Regex match failed, chunk: "+e);return{value:void 0}}var f=a[1],l=a[4],p=Object.getOwnPropertyNames(N.api).find(function(e){return e.toLowerCase()===f.toLowerCase()});if(!f||!N.api[f]&&!p){Object(i.t)("Node "+C+", no api matching '"+f+"' or '"+p+"', chunk '"+e+"'");return{value:void 0}}N=N.api[f]||p&&N.api[p];C=f;o.t.isActivated("c427417d-fe49-4f58-bcbe-43711e46d2a4","11/10/2021")||N.typeOverrides&&u&&(N=(function(e,t){var n,i,s,o,u,a,f=null===(n=e.typeOverrides)||void 0===n?void 0:n.get(t);if(!f)return e;var l=Object(r.__assign)({},e);l.flight=null!=(i=f.flight)?i:e.flight;l.capabilityString=null!=(s=f.capabilityString)?s:e.capabilityString;l.offlineOnly=null!=(o=f.offlineOnly)?o:e.offlineOnly;l.onlineCapability=null!=(u=f.onlineCapability)?u:e.onlineCapability;l.httpMethodCapabilityStrings=null!=(a=f.httpMethodCapabilityStrings)?a:e.httpMethodCapabilityStrings;return l})(N,u));l&&N.api&&N.api["%self%"]&&(N=N.api["%self%"]);if(N.flight&&!t(N.flight)||N.disabled&&!d()){Object(i.t)("Node "+C+" is disabled.");return{value:void 0}}if(N.offlineOnly&&!n.offline){Object(i.t)("Node "+C+" is offline-only.");return{value:void 0}}if(N.returns===h.List){g=N.returns;if(l){if(c)throw new Error("Found multiple identifiers in URL");c=l;v=N.idType;Object(i.t)("Found list param '"+c+"' in chunk "+e)}}if(N.isLeaf){m?m+="/"+C:m=C;b=N.capabilityString;s&&N.httpMethodCapabilityStrings&&s in N.httpMethodCapabilityStrings&&(b=N.httpMethodCapabilityStrings[s]);k=N.doNotBind;E=N.onlineCapability}},A=0,O=T;A<O.length;A++){var M=L(O[A]);if("object"==typeof M)return M.value}if(m){var _=null;if(g)if(c&&void 0!==v){if(c.startsWith("'%7B")&&c.endsWith("%7D'")&&44===c.length)_=c.substr(4,c.length-8);else if(!(_=a.searchParams.get(c))){Object(i.t)("Found operation but no ID. Param: "+c);return}}else if(!(_=a.searchParams.get("listFullUrl"))){Object(i.t)("Did not find a list or operation.");return}var D=v===p.Path&&_?a.protocol+"//"+a.host+decodeURIComponent(_).replace(/'/g,""):void 0;return{ids:{siteUrl:x,listId:v===p.Guid&&_?w(decodeURIComponent(_)):void 0,listUrl:D},rest:{api:S,method:m},capabilityString:b,onlineCapabilityString:E,doNotBind:k}}Object(i.t)("Did not find a list method.")}else Object(i.t)("All nodes are disabled.")}}}function w(e){return e&&e.replace(/guid/,"").replace(/'/g,"").replace(/}/g,"").replace(/{/g,"").toLowerCase()}},2538:function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"n",function(){return o});n.d(t,"i",function(){return u});n.d(t,"e",function(){return f});n.d(t,"r",function(){return l});var r,i,s=function(e){return r(e)},o=function(e){return r({msg:e,error:!0})},u="sharepoint.datasync.nucleus.logToConsole";try{i=window.localStorage.getItem(u)}catch(e){i=null}var a=!!i&&"TRUE"===i.toUpperCase();r=a?function(e){console.log("[nucleus] "+("string"==typeof e?e:e.msg))}:function(){};var f=a?function(e){return e?"function"==typeof e?e().toString():e.toString():"undefined"}:function(e){return"<PRIVATE>"};function l(e){return""+(e||new Date).toISOString()}},2546:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e.fromHexString=function(e,t){var n=t?{High:2147483647,Low:2147483647}:{High:0,Low:0},r=e&&e.match(/^(0x)?([0-9a-f]*)$/i);if(r){var i=void 0,s=void 0;if((e=(e=r[2]||"0").slice(-16)).length<=8){i=0;s=parseInt(e,16)}else{i=parseInt(e.slice(0,-8),16);s=parseInt(e.slice(-8),16)}if(!isNaN(i)&&!isNaN(s)){n.High=i;n.Low=s}}return n};e.or=function(e){return(e||[]).reduce(function(e,t){return{High:e.High|t.High,Low:e.Low|t.Low}},{High:0,Low:0})};e.and=function(e){return e&&e.length?e.reduce(function(e,t){return{High:e.High&t.High,Low:e.Low&t.Low}}):{High:0,Low:0}}})(r||(r={}));t.t=r},2549:function(e,t,n){"use strict";n.d(t,"i",function(){return i});n.d(t,"n",function(){return s});n.d(t,"r",function(){return o});n.d(t,"e",function(){return u});n.d(t,"t",function(){return a});var r=n(36);function i(){return r.t.isActivated("e5a15d49-4948-41c4-b28c-9a4803887c92","09/09/2021","avoid refresh of doc lib after template creation")}function s(){return r.t.isActivated("73f43293-8115-4fca-84f1-21064f342bf3","09/27/2021","latest fix in check for current site in _fetchSite")}function o(){return r.t.isActivated("64f58cc0-2238-4592-b36f-32b327f5916a","11/25/2021","adding focusin/focusout event listeners to every placeholder")}function u(){return r.t.isActivated("0d998722-29c9-4d0f-9086-97361c0fdc9a","12/03/2021","Delete Site CT when template is deleted from list")}function a(){return r.t.isActivated("143bb8f2-c1e9-4073-9071-44876e2e5e45","12/06/2021","Serialize createDocument call with get template metadata")}},2764:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e.Unspecified="Unspecified";e.ListQuickEdit="ListQuickEdit";e.ListHomeEnumeration="ListHomeEnumeration"})(r||(r={}))},2767:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=(function(){function e(){}e.startExitingQuickEditEventName="startExitingQuickEdit";e.quickEditWriteChangesToListEventName="quickEditWriteChangesToList";e.deleteCompletedEventName="quickEditDeleteCompleted";e.switchGridLayout="switchGridLayout";e.undoChangeEventName="quickEditUndoChange";e.redoChangeEventName="quickEditRedoChange";e.undoRealCmdCountChangeEventName="quickEditUndoRealCmdCountChange";e.redoRealCmdCountChangeEventName="quickEditRedoRealCmdCountChange";e.gridGlobalsInitialized="gridGlobalsInitialized";return e})();t.t=r},2788:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e[e.succeed=0]="succeed";e[e.unsupport=1]="unsupport";e[e.failed=2]="failed"})(r||(r={}))},2882:function(e,t,n){"use strict";n.d(t,"e",function(){return o});n.d(t,"t",function(){return u});var r=["htm","html","svg"],i=["eml","msg","md","mdown","markdown"];function s(e,t){return!!t&&e.indexOf(("."===t[0]?t.slice(1):t).toLowerCase())>=0}function o(e){return s(i,e)}function u(e){return s(r,e)}},2948:function(e,t,n){"use strict";var r;(function(e){e[e.none=0]="none";e[e.htmlFileUpload=1]="htmlFileUpload";e[e.folderUpload=2]="folderUpload";e[e.downlevelUpload=3]="downlevelUpload";e[e.silverlightUpload=4]="silverlightUpload"})(r||(r={}));t.e=r},2968:function(e,t,n){"use strict";n.d(t,"t",function(){return u});n.d(t,"e",function(){return a});var r=n(77),i=n(37),s=!1,o=!1;function u(){if(!o){o=!0;(function(){if(s||!o)return;s=!0;new r.e({name:"ItemAnalytics.PageFinishedLoading",startTimeOverride:window._itemAnalyticsStartTime}).end({resultType:i.e.Success});try{window.external.PageFinishedLoading()}catch(e){window.parent.postMessage(JSON.stringify({name:"item_analytics_ready"}),"*")}})()}}function a(e){try{window.external.PageError(e,e.message)}catch(n){var t={name:"item_analytics_error",error:e,errorMessage:e.message};window.parent.postMessage(JSON.stringify(t),"*")}}},3035:function(e,t,n){"use strict";function r(e){return void 0!==e.action}function i(e){return void 0!==e.activityDateTime}function s(e){var t=y(e).comment;return void 0!==t&&!t.isReply}function o(e){var t=y(e).comment;return void 0!==t&&t.isReply}function u(e){return void 0!==y(e).mention}function a(e){return void 0!==y(e).version}function f(e){return void 0!==y(e).pointInTimeRestore}function l(e){return void 0!==y(e).restoreVersion}function c(e){return void 0!==y(e).move}function h(e){return void 0!==y(e).rename}function p(e){return void 0!==y(e).delete}function d(e){return void 0!==y(e).share}function v(e){var t=y(e).addToOneDrive;return void 0!==t&&!t.removedDateTime}function m(e){var t=y(e).addToOneDrive;return void 0!==t&&!!t.removedDateTime}function g(e){return function(t){return u(t)?e.Mention(t):s(t)?e.Comment(t):o(t)?e.CommentResponse(t):(function(e){return void 0!==y(e).create})(t)?e.Create(t):p(t)?e.Delete(t):(function(e){return void 0!==y(e).edit})(t)?e.Edit(t):c(t)?e.Move(t):h(t)?e.Rename(t):(function(e){return void 0!==y(e).restore})(t)?e.Restore(t):l(t)?e.RestoreVersion(t):d(t)?e.Share(t):a(t)?e.Version(t):(function(e){return void 0!==y(e).copy})(t)?e.Copy(t):f(t)?e.PointInTimeRestore(t):v(t)?e.AddShortcutToOneDrive(t):m(t)?e.RemoveShortcutFromOneDrive(t):void 0}}function y(e){return r(e)?e.action:e}function b(e){return e.driveItem||e.listItem}var w=n(56),E=!n(36).t.isActivated("DC1B3A2B-2469-49B2-9230-7F6CD01BD84C","12/30/2020","Enable deeplinking for comment activities"),S=(function(){function e(){}e.prototype.processResponse=function(e){var t=this,n=e.item,r=e.response;return{isPlaceholder:!1,activities:r.value.map(function(e){if(i(e))if(s(e)||o(e)){var r=y(e).comment;(r.contentId||r.navigationId)&&(e.docDetails={contentId:r.contentId,navigationId:r.navigationId})}else if(u(e)){var a=y(e).mention;(a.contentId||a.navigationId)&&(e.docDetails={contentId:a.contentId,navigationId:a.navigationId})}return t._processActivityResponse(n,e)}),nextRequestToken:this._getNextRequestToken(r),success:!0}};e.prototype.processActivitiesByIntervalResponse=function(e){var t=this;return{activitiesByInterval:e.value.map(function(e){return t._processActivitySummaryResponse(e)}),success:!0}};e.prototype._processActivitySummaryResponse=function(e){return{totalCount:(void 0!==e.create?e.create.actionCount:0)+(void 0!==e.delete?e.delete.actionCount:0)+(void 0!==e.edit?e.edit.actionCount:0)+(void 0!==e.move?e.move.actionCount:0)+(void 0!==e.rename?e.rename.actionCount:0)+(void 0!==e.restore?e.restore.actionCount:0)+(void 0!==e.copy?e.copy.actionCount:0),startDateTime:new Date(e.startDateTime),endDateTime:new Date(e.endDateTime)}};e.prototype._getNextRequestToken=function(e){if(e.value&&!(e.value.length<1)){var t=e["@odata.nextLink"],n=t&&t.match(/skiptoken=([^&]+)/i);return n?n[1]:void 0}};e.prototype._processActivityResponse=function(e,t){var n=this._getItem(e,t),r=this._getParentItem(t),s=this._getAction(e,n,r,t);if(i(t)){var o=t.actor&&t.actor.user,u=o&&{displayName:o.displayName,id:o.id,email:o.email,self:o.self};return{id:t.id,type:this._getActivityType(t),actors:u?[u]:[],item:n,parentItem:r,time:new Date(t.activityDateTime),action:s}}var a=t.actor&&t.actor.user,f=a&&{displayName:a.displayName,email:a.email,self:a.self,userPrincipalName:a.userPrincipalName};return{id:t.id,type:this._getActivityType(t),actors:[f],item:n,parentItem:r,time:t.times.recordedTime?new Date(t.times.recordedTime):new Date(t.times.recordedDateTime),friendlyDisplayTime:t["@sharePoint.localizedRelativeTime"],action:s}};e.prototype._getActivityType=function(e){return g({Comment:function(){return 2},CommentResponse:function(){return 3},Create:function(){return 11},Delete:function(){return 10},Edit:function(){return 0},Mention:function(){return 4},Move:function(){return 1},Rename:function(){return 9},Restore:function(){return 6},RestoreVersion:function(){return 7},PointInTimeRestore:function(){return 8},Share:function(){return 12},Version:function(){return 5},Copy:function(){return 13},AddShortcutToOneDrive:function(){return 14},RemoveShortcutFromOneDrive:function(){return 15}})(e)};e.prototype._getItem=function(e,t){var n=b(t);if(c(t)){if(r(t)){var s=y(t).move;if(s&&s.to)return{name:this._getFileNameFromPath(s.to),isRoot:this._isRootItem(s.to),graphItemUrl:void 0,relativePath:void 0,absolutePath:s.to}}}else if(p(t)&&r(t)){var o=y(t).delete;if(o&&o.name){var u=(f=(a=n&&n.parentReference)&&this._getRelativePathFromVroomPath(a.path))&&n&&f+"/"+n.name+"/"+o.name;return{name:o.name,isRoot:this._isRootItem(o.name),graphItemUrl:void 0,relativePath:u,absolutePath:void 0,isFolder:"Folder"===o.objectType}}}if(n){t.docDetails&&(n.webUrl=this._getNavLink(n,t.docDetails));var a,f;u=(f=(a=n&&(n.parentReference||n.remoteItem&&n.remoteItem.parentReference))&&this._getRelativePathFromVroomPath(a.path))&&f+"/"+n.name;return p(t)?{name:n.name,isRoot:this._isRootItem(n.name),graphItemUrl:void 0,relativePath:u,absolutePath:void 0}:{name:n.name,isRoot:this._isRootItem(n.name),graphItemUrl:a&&"/drives/"+a.driveId+"/items/"+n.id,relativePath:u,absolutePath:void 0,driveItem:n,navigationId:this._getNavigationId(t)}}if(!i(t))return e};e.prototype._getParentItem=function(e){var t=b(e);if(c(e)){var n=y(e).move;if(n&&n.to){var i=this._getDirNameFromPath(n.to),s=t&&(t.parentReference||t.remoteItem&&t.remoteItem.parentReference);return{name:this._getFileNameFromPath(i),isRoot:this._isRootItem(i),graphItemUrl:s&&"/drives/"+s.driveId+"/items/"+s.id,relativePath:void 0,absolutePath:this._getDirNameFromPath(i),isFolder:!0,driveItem:s&&{id:s.id}}}}else if(p(e)&&t){if(r(e)){var o=(a=(s=t&&(t.parentReference||t.remoteItem&&t.remoteItem.parentReference))&&this._getRelativePathFromVroomPath(s.path))&&a+"/"+name;return{name:t.name,isRoot:this._isRootItem(t.name),graphItemUrl:s&&"/drives/"+s.driveId+"/items/"+t.id,relativePath:o,absolutePath:void 0,isFolder:!0,driveItem:t}}if(s=t&&t.parentReference){o=this._getRelativePathFromVroomPath(s.path);var u=s.name?s.name:o&&this._getFileNameFromPath(o);if(void 0===o||void 0===u||void 0===s.id)return;return{name:u,isRoot:this._isRootItem(u),graphItemUrl:"/drives/"+s.driveId+"/items/"+s.id,relativePath:o,absolutePath:void 0,isFolder:!0,driveItem:{id:s.id}}}}else{if(l(e)&&t){o=(a=(s=t&&(t.parentReference||t.remoteItem&&t.remoteItem.parentReference))&&this._getRelativePathFromVroomPath(s.path))&&a+"/"+name;return{name:t.name,isRoot:this._isRootItem(t.name),graphItemUrl:s&&"/drives/"+s.driveId+"/items/"+t.id,relativePath:o,absolutePath:void 0,isFolder:!1,driveItem:t}}if(f(e)&&t){var a;o=(a=(s=t&&(t.parentReference||t.remoteItem&&t.remoteItem.parentReference))&&this._getRelativePathFromVroomPath(s.path))&&a+"/"+name;return{name:t.name,isRoot:this._isRootItem(t.name),graphItemUrl:s&&"/drives/"+s.driveId+"/items/"+t.id,relativePath:o,absolutePath:void 0,isFolder:!0,driveItem:t}}if(t){if(s=t.parentReference&&t.parentReference){o=this._getRelativePathFromVroomPath(s.path);var h=s.name?s.name:o&&this._getFileNameFromPath(o);return{name:h,isRoot:this._isRootItem(h),graphItemUrl:"/drives/"+s.driveId+"/items/"+s.id,relativePath:o,absolutePath:void 0,isFolder:!0,driveItem:{id:s.id}}}}}};e.prototype._getNavLink=function(e,t){var n=e.webUrl,r=n&&new w.t(n),i=t.navigationId;r&&i&&r.setQueryParameter("nav",i);return r.toString()||n};e.prototype._getNavId=function(e){return e&&e.navigationId};e.prototype._getNavigationId=function(e){var t,n,r,i,o,u,a;if(null===(t=e)||void 0===t?void 0:t.docDetails)return this._getNavId(e.docDetails);if(E&&s(e)){var f=y(e);return(null===(r=null===(n=f)||void 0===n?void 0:n.comment)||void 0===r?void 0:r.navigationId)?null===(o=null===(i=f)||void 0===i?void 0:i.comment)||void 0===o?void 0:o.navigationId:null===(a=null===(u=f)||void 0===u?void 0:u.comment)||void 0===a?void 0:a.commentId}};e.prototype._getAction=function(e,t,n,r){var f={};a(r)&&(f.version={newVersion:y(r).version.newVersion});if(c(r)){var l=y(r).move;if(i(r)){var p=void 0,g=void 0;l.from&&(p=this._getDirNameFromPath(l.from));l.to&&(g=this._getDirNameFromPath(l.to));f.move={from:{name:this._getFileNameFromPath(p),isRoot:this._isRootItem(p),graphItemUrl:void 0,absolutePath:p},to:{name:this._getFileNameFromPath(g),isRoot:this._isRootItem(g),graphItemUrl:void 0,absolutePath:g}}}else if(l.From){var b=this._getDirNameFromPath(l.From);f.move={from:{name:this._getFileNameFromPath(b),isRoot:this._isRootItem(b),graphItemUrl:void 0,absolutePath:b},to:void 0}}else if(l.to){var w=this._getDirNameFromPath(l.to);f.move={from:void 0,to:{name:this._getFileNameFromPath(w),isRoot:this._isRootItem(w),graphItemUrl:void 0,absolutePath:w}}}}if(h(r)){var E=y(r).rename;f.rename={newItem:{name:E.newName,isRoot:this._isRootItem(E.newName),graphItemUrl:t?t.graphItemUrl:void 0,relativePath:t?t.relativePath:void 0,absolutePath:t?t.absolutePath:void 0,driveItem:t?t.driveItem:void 0},oldItem:{name:E.oldName,isRoot:this._isRootItem(E.oldName),graphItemUrl:t?t.graphItemUrl:void 0,relativePath:t?t.relativePath:void 0,absolutePath:t?t.absolutePath:void 0,driveItem:t?t.driveItem:void 0}}}if(o(r)){(S=y(r).comment).isReply&&(f.commentResponse={commentAuthor:S.parentAuthor&&S.parentAuthor.user})}if(s(r)){var S;(S=y(r).comment).isReply||(f.comment={commentId:S.commentId})}if(u(r)){var x=y(r).mention;f.mention={mentionees:x.mentionees&&x.mentionees.map(function(e){return e.user})||[],commentId:i(r)?x.navigationId:void 0}}if(d(r)){var T=y(r).share;f.share={recipients:T.recipients&&T.recipients.map(function(e){return e.user})||[]}}v(r)&&(f.addShortcutToOneDrive={});if(m(r)){var N=y(r).addToOneDrive;f.removeShortcutFromOneDrive={mountPointName:N.mountPointName}}return f};e.prototype._getRelativePathFromVroomPath=function(e){if(e){return e.split(":",2)[1]}};e.prototype._getDirNameFromPath=function(e){return e&&e.substring(0,e.lastIndexOf("/"))};e.prototype._getFileNameFromPath=function(e){return e&&e.substring(e.lastIndexOf("/")+1)};e.prototype._isRootItem=function(e){return e&&"/LiveFolders"===e};return e})();t.e=S},3069:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n("knockout-lib");function i(e,t){var n=document.createElement("div");n.innerHTML=t;r.applyBindings(e,n);var i=n.textContent;r.cleanNode(n);return i}},3070:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(7).t)({name:"MentionTeachingBubble",factory:{dependencies:{},create:function(){return{instance:{isPending:!1}}}}})},3074:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e[e.Click=1]="Click";e[e.Tap=2]="Tap";e[e.Keyboard=3]="Keyboard";e[e.Drop=4]="Drop"})(r||(r={}))},3091:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e[e.default=0]="default";e[e.firstRun=1]="firstRun";e[e.progressStarted=2]="progressStarted";e[e.progressFinished=3]="progressFinished"})(r||(r={}))},3387:function(e,t,n){"use strict";n.d(t,"e",function(){return r});n.d(t,"t",function(){return i});var r="Click";function i(e){return e.charAt(0).toUpperCase()+e.slice(1)}},3388:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(0);function i(e,t){var n=function(n){var i=e.peek(),s=t.peek();t.valueWillMutate();s.splice.apply(s,Object(r.__spreadArrays)([0,s.length],i));t.valueHasMutated()},i=e.subscribe(n,null,"arrayChange");n();return i}},3420:function(e,t,n){"use strict";n.d(t,"e",function(){return r});function r(e,t,n){var r=e&&e.toLowerCase(),i=t&&t.toLowerCase(),s=n&&n.toLowerCase();return!(r!==i&&r!==s)}},3462:function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n(1147),i=n(163),s=n(212),o=n(11);function u(e,t,n){if(e.type===i.t.OneNote)return!1;if(e.list||e.subsite)return!1;return!(!s.e.isFeatureEnabled({ODB:831,ODC:"UseDownloadMicroservice"})||n||!e.urls[r.e.downloadAsZip]||!e.urls[r.e.itemUrl]||0===e.childCount||e.type!==i.t.Folder)||!e.isRootFolder&&(!!t&&((!t||!t.list||t.list.templateType!==o.n.webPageLibrary)&&(e.type===i.t.File||e.type===i.t.Media||e.type===i.t.Unknown)))}},3502:function(e,t,n){"use strict";n.d(t,"e",function(){return y});n.d(t,"t",function(){return w});var r=n("react-lib"),i=n(1850),s=n(2405),o=n(2788),u=n(557),a=n(26),f=n(2501),l=n(16),c=n(1676),h=n(134),p=n(212),d={ODB:1306};var v=n(4582),m=n(39),g=new Date("0001-01-01T00:00:00-08:00"),y=function(e){var t,n,m,y,E=e.itemAnalytics,S=e.onClick,x=e.onLikeClick,T=(e.pageUrl,e.isLink),N=e.status,C=e.isCompact,k=e.disableViewerCount,L=void 0===k||k,A=e.ODBOptOutViewerList,O=void 0!==A&&A,M=e.itemKey,_=w();if(N===o.e.failed){var D=Object(a._)();t=_.apiError&&(n="ErrorBadge",m=_.apiError,y={color:D.palette.redDark},r.createElement(r.Fragment,null,r.createElement(u.e,{iconName:n,className:"fileHoverCardErrorIcon_86ea3a8a",styles:{root:Object(a.F)([{paddingRight:"8px",position:"relative"},y])}}),m))}if(t)return null;if(!E||!E.viewCount||!E.viewerCount)return r.createElement(s.e,{className:"analyticsStats_86ea3a8a",isCompact:!0});var P=E.viewCount,H=E.viewerCount,B=E.activities,j=E.commentCount,F=E.likeCount,I=E.incompleteData&&E.incompleteData.missingDataBeforeDateTime&&new Date(E.incompleteData.missingDataBeforeDateTime).getTime()!==g.getTime(),q=E.incompleteData&&E.incompleteData.wasThrottled,R=I?f.fe:q?f.Ae:"",U=L?O?f.be:"":f.Ce,z=R||U,W=P>1?_.views:_.view,X=H>1?_.viewers:_.viewer,V=j&&j>1?_.comments:_.comment,$=F&&F>1?_.likes:_.like,J=j?""+l.format(V,j):"",K=F?""+l.format($,F):"",Q=p.e.isFeatureEnabled(d)?x:void 0,G=K&&b(K,Q),Y=J&&b(J,void 0,void 0);return C?T?r.createElement("div",{className:"analyticsStatsContainer_86ea3a8a"},r.createElement(i.e,{className:"analyticsStatsLink_86ea3a8a",onClick:S},r.createElement(s.e,{activityPersonas:B&&0!==B.length?B.slice(0,3).map(function(e){return{imageUrl:e&&e.actor&&e.actor.user&&e.actor.user.image}}).reverse():void 0,activityDescription:r.createElement("div",{className:"analyticsStatsLabel_86ea3a8a"},P&&r.createElement("div",{className:"analyticsStatsCount_86ea3a8a"},P+" "+W)),isCompact:!0})),K&&M?r.createElement(v.e,{likeLabel:K,itemKey:M}):G,Y):r.createElement("div",{className:"analyticsStatsContainer_86ea3a8a"},b(P+" "+W,void 0),b(H+" "+X,void 0),z&&r.createElement(c.e,{content:z,directionalHint:h.e.bottomCenter},r.createElement(u.e,{className:"analyticsStatsTeachingMessage_86ea3a8a",iconName:"Info","aria-describedby":z})),G,Y):r.createElement("div",{className:"analyticsStatsViews_86ea3a8a"},H+" "+X,r.createElement("span",{className:"analyticsStatsViewsDivider_86ea3a8a"}),P+" "+W,R&&r.createElement(c.e,{content:R,directionalHint:h.e.bottomCenter},r.createElement(u.e,{className:"analyticsStatsInfo_86ea3a8a",iconName:"Info","aria-describedby":R})))};y.defaultProps={isLink:!1};function b(e,t,n){var o=r.createElement(s.e,{activityDescription:r.createElement("div",{className:Object(m.e)("analyticsStatsLabel_86ea3a8a","analyticsStatsCount_86ea3a8a")},e),isCompact:!0});return t||n?r.createElement(i.e,{className:"analyticsStatsLink_86ea3a8a",href:n+"#comments",target:"_blank",onClick:t},o):r.createElement("div",{className:"analyticsStatsNoLink_86ea3a8a"},o)}function w(){return{details:f.Ne,viewer:f.Fe,viewers:f.Ie,view:f.Be,views:f.qe,comment:f.Ee,comments:f.Se,like:f.xe,likes:f.Te,apiError:f.te,suggestion:f.ke,unsupportMessage:f.He,accessActivity:f.Y,modifiedActivity:f.ye,activityTemplate:f.Z,inCompleteDataMessage:f.ae,throttledMessage:f.Le,trendingItem:f.Pe,loginUserYou:f.Re}}},3509:function(e,t,n){"use strict";n.d(t,"r",function(){return S});n.d(t,"t",function(){return x});n.d(t,"e",function(){return T});n.d(t,"n",function(){return N});var r=n(0),i=n("react-lib"),s=n(2202),o=n(2592),u=n(1676),a=n(134),f=n(1657),l=n(557),c=n(39),h=n(16),p=n(3066),d=n(212),v=n(822),m=n(36),g=n(4245),y=d.e.isFeatureEnabled({ODC:"ToolTipEmailKillSwitch"})||m.e.isActivated("2f7a87f9150a4ef3b35a1ad82e402730","08/28/2021","ToolTipEmailKillSwitchActivated"),b={details:{paddingLeft:4,paddingRight:0}},w={icon:{fontSize:12,marginLeft:0,marginRight:0}};function E(e,t,n){var r="3rem";if(t)switch(t){case s.n.size24:r="1.5rem";break;case s.n.size32:r="2rem";break;case s.n.size40:r="2.5rem";break;case s.n.extraSmall:r="1.75rem";break;default:r="3rem"}var i={text:e.name?e.name:"",imageUrl:e.image?e.image:"",tertiaryText:e.email?e.email:"",secondaryText:e.job?e.job:"",imageInitials:"",imageAlt:e.imageAlt,coinProps:{styles:{coin:{width:r,height:r,maxWidth:"75px",maxHeight:"75px"},image:{width:r+"!important",height:r+"!important",maxWidth:"75px",maxHeight:"75px"},imageArea:{width:r,height:r,maxWidth:"75px",maxHeight:"75px"},initials:{width:r,height:r,fontSize:"0.625rem",lineHeight:r}}},styles:{root:{height:r},primaryText:{fontSize:"0.875rem"},secondaryText:{fontSize:"0.75rem"}}};return Object(g.n)(e)&&void 0!==n?Object(v.default)(i,Object(g.t)(n)):i}var S=function(e){var t=E(e,s.n.size40,g.e.standalone);return i.createElement("div",{className:"ms-PeoplePicker-personaContent"},i.createElement(o.e,Object(r.__assign)({},t,{presence:s.t.none,size:s.n.size40,className:"ms-PeoplePicker-pickerPersona"})),4===e.entityType&&i.createElement(l.e,{className:"od-PeoplePicker-linkedInLogo",iconName:"LinkedInLogo"}))},x=function(e){var t,n=e.item,l=e.onRemoveItem,h=e.index,p=e.selected,d=e.removeButtonAriaLabel,v=E(n,s.n.extraSmall,g.e.pill);y||(v.onRenderPrimaryText=function(){return i.createElement(u.e,{content:n.email||v.text,directionalHint:a.e.topLeftEdge},v.text)});return i.createElement("div",{className:Object(c.e)("ms-PickerPersona-container",(t={"is-selected":!!p},t.placeholderUser_b8ea1d3d=Object(g.n)(n),t)),"data-is-focusable":!0,"data-selection-index":h,key:h,role:"listitem"},i.createElement("div",{className:Object(c.e)("ms-PickerItem-content","itemContent_b8ea1d3d")},i.createElement(o.e,Object(r.__assign)({},v,{presence:s.t.none,size:s.n.extraSmall}))),i.createElement(f.e,{onClick:l,iconProps:{iconName:"Cancel"},className:"ms-PickerItem-content","data-is-focusable":!0,ariaLabel:d}))},T=function(e){var t=e.item,n=e.onRemoveItem,u=e.index,a=e.selected,l=E(t,s.n.size40),d="PickerPersonaId"+Math.floor(1e4*Math.random()),v=h.format(p.n,t.name);return i.createElement("div",{className:Object(c.e)("ms-PickerPersona-container is-listbelow",{"is-selected":!!a}),"data-is-focusable":!0,"data-selection-index":u,key:u,"aria-labelledby":d,role:"listitem"},i.createElement("div",{className:"ms-PickerPersona-content"},i.createElement(o.e,Object(r.__assign)({id:d},l,{presence:s.t.none,size:s.n.size40}))),i.createElement("div",{className:"ms-PickerItem-content"},i.createElement(f.e,{onClick:n,iconProps:{iconName:"Cancel"},className:"ms-PickerItem-content","data-is-focusable":!0,ariaLabel:v})))},N=function(e){var t,n=e.item,u=e.onRemoveItem,a=e.index,l=n.email?"/_layouts/15/userphoto.aspx?accountname="+n.email:"",c={text:n.name||"",imageUrl:n.image||l,styles:{primaryText:{fontSize:"0.875rem"},secondaryText:{fontSize:"0.75rem"}}},d="PickerPersonaId"+Math.floor(1e4*Math.random()),m=h.format(p.n,n.name),y=["peoplePickerPill_b8ea1d3d"];if(Object(g.n)(n)){t=Object(v.default)(c,Object(g.t)(g.e.pill));y.push("placeholderUser_b8ea1d3d")}else t=c;return i.createElement("div",{className:y.join(" "),"data-is-focusable":!1,"data-selection-index":a,key:a,"aria-labelledby":d},i.createElement(o.e,Object(r.__assign)({id:d},t,{presence:s.t.none,size:s.n.size24,styles:b})),i.createElement(f.e,{onClick:u,iconProps:{iconName:"Cancel"},className:"peoplePickerClose_b8ea1d3d","data-is-focusable":!0,ariaLabel:m,styles:w}))}},3526:function(e,t,n){"use strict";n(2533);var r=n(597),i=n("knockout-lib"),s=(function(){function e(e,t){var n=this;this._source=e;this._getKey=t;this._groupsByKeyId={};this.groups=i.observableArray();this._initializeGroups();Object(r.e)(this.groups,function(){n._mapping.dispose()})}e.group=function(t,n){return new e(t,n).groups};e.prototype._initializeGroups=function(){var e=this;this._mapping=this._source.map({mappingWithDisposeCallback:function(t){var n=e._getKey(t),r=JSON.stringify(n),s=e._groupsByKeyId[r];if(s)s.values.push(t);else{s={key:n,values:i.observableArray([t])};e._groupsByKeyId[r]=s;e.groups.push(s)}return{mappedValue:r,dispose:function(){if(s.values.peek().length>1)s.values.remove(t);else{delete e._groupsByKeyId[r];e.groups.remove(s)}}}}})};return e})();t.e=s},3527:function(e,t,n){"use strict";n.d(t,"e",function(){return i});n.d(t,"n",function(){return s});n.d(t,"t",function(){return o});var r=n(732),i=new r.n("Click",4),s=new r.n("KeyPress",4),o=new r.n("Drop",4)},3540:function(e,t,n){"use strict";n.d(t,"e",function(){return l});var r=n(0),i=n("react-lib"),s=n("react-dom-lib"),o=n(93),u=n(153),a=0,f=Object(o.e)(function(e){return""+ ++a});function l(){var e=i.useState(function(){return{}}),t=e[0],n=e[1],o=Object(u.e)(function(e,t){n(function(n){var i,o=f(t);return Object(r.__assign)(Object(r.__assign)({},n),((i={})[o]=s.createPortal(e,t),i))})}),a=Object(u.e)(function(e){n(function(t){var n=f(e);t[n];return Object(r.__rest)(t,["symbol"==typeof n?n:n+""])})}),l=i.useRef(),c=l.current||(l.current={render:o,unmount:a}),h=i.useMemo(function(){return i.createElement(i.Fragment,null,Object.keys(t).map(function(e){return i.createElement(i.Fragment,{key:e},t[e])}))},[t]);return i.useMemo(function(){return[c,h]},[c,h])}},3576:function(e,t,n){"use strict";var r=(function(){function e(){}e.prototype.getState=function(e){return this._getNormalizedWindowName()[e]};e.prototype.setState=function(e,t){var n=this._getNormalizedWindowName();n[e]=t;window.name=JSON.stringify(n)};e.prototype.removeState=function(e){var t=this._getNormalizedWindowName(),n=t[e];delete t[e];window.name=JSON.stringify(t);return n};e.prototype._getNormalizedWindowName=function(){var e,t;try{t=JSON.parse(name)||{}}catch(e){t={}}"object"!=typeof t&&(t=((e={}).value=t,e));return t};return e})();t.e=r},3598:function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(0),i=n(148);function s(e,t,n){t?i.e.logData({name:e,isIntentional:!0,extraData:Object(r.__assign)({itemId:t.itemId,driveId:t.graph&&t.graph.driveId,fileExtension:t.extension,fileType:t.appMap},n)}):i.e.logData(Object(r.__assign)({name:e},n))}},3866:function(e,t,n){"use strict";var r=0,i=(function(){function e(e){var t=this._viewModel=e.viewModel,n=t.__ResourceComponentLoader$componentId=""+ ++r;t.__ResourceComponentLoader$componentBindingElement=e.element;t.__ResourceComponentLoader$childComponents={};t.__ResourceComponentLoader$componentName=e.name;for(var i=e.bindingContext;i&&(!i.$data||i.$data===t||!i.$data.__ResourceComponentLoader$childComponents);)i=i.$parentContext;if(i){var s=this._parentViewModel=i.$data;s.__ResourceComponentLoader$childComponents[n]=t;t.__ResourceComponentLoader$parentComponentViewModel=s}}e.prototype.dispose=function(){var e=this._viewModel,t=this._parentViewModel,n=e.__ResourceComponentLoader$componentId,r=t&&t.__ResourceComponentLoader$childComponents;n&&r&&delete r[n];if(e){delete e.__ResourceComponentLoader$parentComponentViewModel;delete e.__ResourceComponentLoader$childComponents;delete e.__ResourceComponentLoader$componentBindingElement;delete e.__ResourceComponentLoader$componentName}};return e})();t.e=i},3920:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(4297),i=(r.P,r.l,r.B,r.j,r.H,r.i,r.p,r.O,r.N,r._,r.D,r.M,r.b,r.L,r.w,r.y,r.x,r.v,r.T,r.S,r.E,r.m,r.A,r.k,r.C,r.g,[r.s,r.r,r.a,r.e,r.f,r.u,r.o,r.t,r.d,r.h,r.c,r.n])},3931:function(e,t,n){"use strict";n.d(t,"e",function(){return r});function r(e){return e>0&&e<=52428800}},3932:function(e,t,n){"use strict";n.d(t,"t",function(){return r});n.d(t,"e",function(){return i});var r,i;(function(e){e[e.WebhookSubscription=0]="WebhookSubscription";e[e.Meta=1]="Meta";e[e.EventHub=2]="EventHub"})(r||(r={}));(function(e){e[e.Zip=0]="Zip"})(i||(i={}))},4031:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e.TipsNTricks="TipsNTricks";e.TeamifyBanner="TeamifyBanner"})(r||(r={}))},4166:function(e,t,n){"use strict";n.d(t,"e",function(){return E});var r=n("react-lib"),i=n(2),s=n(4304),o=n(62),u=n(0),a=n(41),f=n(22),l=n(29),c=n(14),h=n(5),p=n(18),d=n(80),v=n(1439),m=n(3931),g=Object(d.e)(function(){return Object(u.__awaiter)(void 0,void 0,void 0,function(){return Object(u.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([625,"ondemand.resx-ondemand"],4958)];case 1:return[2,e.sent().ImmersiveReaderLauncher]}})})}),y=new Set;y.add(".docx");y.add(".txt");y.add(".html");var b=Object(a.e)(function(e,t){var n,i=t.itemKey,s=e.demandItemFacet(h.d,i),o=e.demandItemFacet(h.v,i),a=null===(n=s)||void 0===n?void 0:n.extension,f=e.demandItemFacet(v.e,i),c=v.e.evaluate(f)(e,{isAvailable:!1,itemKey:i}).isAvailable&&!!a&&y.has(a)&&!!o&&Object(m.e)(o),d=Object(p.o)(function(e){return r.createElement(g,Object(u.__assign)({},e,{itemKey:i,fileExtension:a}))});return Object(u.__assign)({isAvailable:c,onExecute:d},Object(l.t)(e,{itemKey:i,engagement:{name:"OpenInImmersiveReader",isIntentional:!0,extraData:{fileExtension:a}}}))})(f.e),w=Object(c.s)()(Object(c.r)()(b)),E={key:new i.e("ImmersiveReader").id,name:s.e,title:s.e,automationId:"openInImmersiveReaderCommand",iconProps:{iconName:"ReadOutLoud"},action:r.createElement(o.t,null,r.createElement(w,null))}},4221:function(e,t,n){"use strict";n.d(t,"t",function(){return i});n.d(t,"e",function(){return s});n.d(t,"n",function(){return o});var r=n("knockout-lib");function i(e,t){var n,r=function(e){t(t.peek()+e)},i=e.subscribe(function(){n=e.peek()},null,"beforeChange"),s=e.subscribe(function(){r(e.peek()-n)});r(e.peek());return{dispose:function(){i.dispose();s.dispose();r(-e.peek())}}}function s(e,t){var n,r=function(e,n){var r=t.peek();void 0!==e&&r[e]--;void 0!==n&&(r[n]=(r[n]||0)+1);t.valueHasMutated()},i=e.subscribe(function(){n=e.peek()},null,"beforeChange"),s=e.subscribe(function(){r(n,e.peek())});r(void 0,e.peek());return{dispose:function(){i.dispose();s.dispose();r(e.peek(),void 0)}}}function o(e,t){var n=e.peek(),i=e.subscribe(function(){n=e.peek()},null,"beforeChange"),s=r.computed(function(){!t()&&e()&&t(e())}),o=e.subscribe(function(e){!e&&n&&t.peek()===n&&t(void 0)});return{dispose:function(){s.dispose();o.dispose();i.dispose()}}}},4245:function(e,t,n){"use strict";n.d(t,"r",function(){return c});n.d(t,"n",function(){return h});n.d(t,"e",function(){return r});n.d(t,"t",function(){return p});var r,i=n(212),s=n(36),o=n(557),u=n(2202),a=n(26),f=n("react-lib"),l={ODB:60596};function c(){return!s.e.isActivated("E453BAFB-1A08-4222-89F4-568CF37CA2B8","11/02/2021","Placeholder sharing")&&i.e.isFeatureEnabled(l)}function h(e){var t,n;return c()&&!(!e.invitationId&&!(null===(n=null===(t=e.rawData||e.rawPersonData)||void 0===t?void 0:t.EntityData)||void 0===n?void 0:n.invitation))}(function(e){e[e.standalone=0]="standalone";e[e.pill=1]="pill"})(r||(r={}));function p(e){var t=Object(a._)();return{coinProps:{styles:{initials:e===r.standalone?{border:"1px dashed "+t.palette.themePrimary,boxSizing:"border-box",fontSize:"16px",fontWeight:"normal",color:t.palette.themePrimary}:{border:"none",boxSizing:"border-box",fontSize:"12px",color:t.palette.themePrimary,paddingLeft:"4px",paddingRigh:"4px"}}},initialsColor:u.e.transparent,onRenderInitials:function(){return f.createElement(o.e,{iconName:"Contact",style:{fontWeight:"normal"}})}}}},4254:function(e,t,n){"use strict";n.d(t,"e",function(){return r});function r(e){return{regular:{fontWeight:400},semibold:{fontWeight:600},bold:{fontWeight:700}}}},4255:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(181);function i(){Object(r.n)(".o365cs-base .o365cs-nav-contextMenu {    background-color: '[theme:white, default:#ffffff]';}\n.o365cs-base-visibility{  visibility: visible;}\n.o365cs-base .ms-fcl-tdr,.o365cs-base .ms-fcl-tdr-h:hover,.o365cs-base .ms-fcl-tdr-f:focus{    color: '[theme:themeDarker, default:#104a7d]';}\n.o365cs-base .ms-bgc-tdr,.o365cs-base .ms-bgc-tdr-h:hover,.o365cs-base .ms-bgc-tdr-f:focus{    background-color: '[theme:themeDarker, default:#104a7d]';}\n.o365cs-base .ms-bcl-tdr,.o365cs-base .ms-bcl-tdr-h:hover,.o365cs-base .ms-bcl-tdr-f:focus{    border-color: '[theme:themeDarker, default:#104a7d]';}\n.o365cs-base .ms-fcl-td,.o365cs-base .ms-fcl-td-h:hover,.o365cs-base .ms-fcl-td-f:focus{    color: '[theme:themeDark, default:#0d62aa]';}\n.o365cs-base .ms-bgc-td,.o365cs-base .ms-bgc-td-h:hover,.o365cs-base .ms-bgc-td-f:focus{    background-color: '[theme:themeDark, default:#0d62aa]';}\n.o365cs-base .ms-bcl-td,.o365cs-base .ms-bcl-td-h:hover,.o365cs-base .ms-bcl-td-f:focus{    border-color: '[theme:themeDark, default:#0d62aa]';}\n.o365cs-base .ms-fcl-tda,.o365cs-base .ms-fcl-tda-h:hover,.o365cs-base .ms-fcl-tda-f:focus{    color: '[theme:themeDarkAlt, default:#106ebe]';}\n.o365cs-base .ms-bgc-tda,.o365cs-base .ms-bgc-tda-h:hover,.o365cs-base .ms-bgc-tda-f:focus{    background-color: '[theme:themeDarkAlt, default:#106ebe]';}\n.o365cs-base .ms-bcl-tda,.o365cs-base .ms-bcl-tda-h:hover,.o365cs-base .ms-bcl-tda-f:focus{    border-color: '[theme:themeDarkAlt, default:#106ebe]';}\n.o365cs-base .ms-fcl-tp,.o365cs-base .ms-fcl-tp-h:hover,.o365cs-base .ms-fcl-tp-f:focus{    color: '[theme:themePrimary, default:#0078d7]';}\n.o365cs-base .ms-bgc-tp,.o365cs-base .ms-bgc-tp-h:hover,.o365cs-base .ms-bgc-tp-f:focus,.o365cs-base.ms-bgc-tp{    background-color: '[theme:themePrimary, default:#0078d7]';}\n.o365cs-base .ms-bcl-tp,.o365cs-base .ms-bcl-tp-h:hover,.o365cs-base .ms-bcl-tp-f:focus{    border-color: '[theme:themePrimary, default:#0078d7]';}\n.o365cs-base .ms-fcl-ts,.o365cs-base .ms-fcl-ts-h:hover,.o365cs-base .ms-fcl-ts-f:focus{    color: '[theme:themeSecondary, default:#2b88d8]';}\n.o365cs-base .ms-bgc-ts,.o365cs-base .ms-bgc-ts-h:hover,.o365cs-base .ms-bgc-ts-f:focus{    background-color: '[theme:themeSecondary, default:#2b88d8]';}\n.o365cs-base .ms-bcl-ts,.o365cs-base .ms-bcl-ts-h:hover,.o365cs-base .ms-bcl-ts-f:focus{    border-color: '[theme:themeSecondary, default:#2b88d8]';}\n.o365cs-base .ms-fcl-tt,.o365cs-base .ms-fcl-tt-h:hover,.o365cs-base .ms-fcl-tt-f:focus{    color: '[theme:themeTertiary, default:#71afe5]';}\n.o365cs-base .ms-bgc-tt,.o365cs-base .ms-bgc-tt-h:hover,.o365cs-base .ms-bgc-tt-f:focus{    background-color: '[theme:themeTertiary, default:#71afe5]';}\n.o365cs-base .ms-bcl-tt,.o365cs-base .ms-bcl-tt-h:hover,.o365cs-base .ms-bcl-tt-f:focus{    border-color: '[theme:themeTertiary, default:#71afe5]';}\n.o365cs-base .ms-fcl-tl,.o365cs-base .ms-fcl-tl-h:hover,.o365cs-base .ms-fcl-tl-f:focus{    color: '[theme:themeLight, default:#c7e0f4]';}\n.o365cs-base .ms-bgc-tl,.o365cs-base .ms-bgc-tl-h:hover,.o365cs-base .ms-bgc-tl-f:focus{    background-color: '[theme:themeLight, default:#c7e0f4]';}\n.o365cs-base .ms-bcl-tl,.o365cs-base .ms-bcl-tl-h:hover,.o365cs-base .ms-bcl-tl-f:focus{    border-color: '[theme:themeLight, default:#c7e0f4]';}\n.o365cs-base .ms-fcl-tlr,.o365cs-base .ms-fcl-tlr-h:hover,.o365cs-base .ms-fcl-tlr-f:focus{    color: '[theme:themeLighter, default:#deecf9]';}\n.o365cs-base .ms-bgc-tlr,.o365cs-base .ms-bgc-tlr-h:hover,.o365cs-base .ms-bgc-tlr-f:focus{    background-color: '[theme:themeLighter, default:#deecf9]';}\n.o365cs-base .ms-bcl-tlr,.o365cs-base .ms-bcl-tlr-h:hover,.o365cs-base .ms-bcl-tlr-f:focus{    border-color: '[theme:themeLighter, default:#deecf9]';}\n.o365cs-base .ms-fcl-tlra,.o365cs-base .ms-fcl-tlra-h:hover,.o365cs-base .ms-fcl-tlra-f:focus{    color: '[theme:themeLighterAlt, default:#eff6fc]';}\n.o365cs-base .ms-bgc-tlra,.o365cs-base .ms-bgc-tlra-h:hover,.o365cs-base .ms-bgc-tlra-f:focus{    background-color: '[theme:themeLighterAlt, default:#eff6fc]';}\n.o365cs-base .ms-bcl-tlra,.o365cs-base .ms-bcl-tlra-h:hover,.o365cs-base .ms-bcl-tlra-f:focus{    border-color: '[theme:themeLighterAlt, default:#eff6fc]';}\n.o365cs-base .ms-fcl-w,.o365cs-base .ms-fcl-w-h:hover,.o365cs-base .ms-fcl-w-f:focus{    color: '[theme:white, default:#ffffff]';}\n.o365cs-base .ms-bgc-w,.o365cs-base .ms-bgc-w-h:hover,.o365cs-base .ms-bgc-w-f:focus,.o365cs-base.ms-bgc-w{    background-color: '[theme:white, default:#ffffff]';}\n.o365cs-base .ms-bcl-w,.o365cs-base .ms-bcl-w-h:hover,.o365cs-base .ms-bcl-w-f:focus{    border-color: '[theme:white, default:#ffffff]';}\n.o365cs-base .ms-fcl-b,.o365cs-base .ms-fcl-b-h:hover,.o365cs-base .ms-fcl-b-f:focus{    color: '[theme:black, default:#000000]';}\n.o365cs-base .ms-fcl-b.o365cs-nav-closeButton{    color: #000000;}\n.o365cs-base .ms-bgc-b,.o365cs-base .ms-bgc-b-h:hover,.o365cs-base .ms-bgc-b-f:focus,.o365cs-base.ms-bgc-b{    background-color: '[theme:black, default:#000000]';}\n.o365cs-base .ms-bcl-b,.o365cs-base .ms-bcl-b-h:hover,.o365cs-base .ms-bcl-b-f:focus{    border-color: '[theme:black, default:#000000]';}\n.o365cs-base .ms-fcl-nd,.o365cs-base .ms-fcl-nd-h:hover,.o365cs-base .ms-fcl-nd-f:focus{    color: '[theme:neutralDark, default:#212121]';}\n.o365cs-base .ms-bgc-nd,.o365cs-base .ms-bgc-nd-h:hover,.o365cs-base .ms-bgc-nd-f:focus{    background-color: '[theme:neutralDark, default:#212121]';}\n.o365cs-base .ms-bcl-nd,.o365cs-base .ms-bcl-nd-h:hover,.o365cs-base .ms-bcl-nd-f:focus{    border-color: '[theme:neutralDark, default:#212121]';}\n.o365cs-base .ms-fcl-np,.o365cs-base .ms-fcl-np-h:hover,.o365cs-base .ms-fcl-np-f:focus{    color: '[theme:neutralPrimary, default:#333333]';}\n.o365cs-base .ms-bgc-np,.o365cs-base .ms-bgc-np-h:hover,.o365cs-base .ms-bgc-np-f:focus{    background-color: '[theme:neutralPrimary, default:#333333]';}\n.o365cs-base .ms-bcl-np,.o365cs-base .ms-bcl-np-h:hover,.o365cs-base .ms-bcl-np-f:focus{    border-color: '[theme:neutralPrimary, default:#333333]';}\n.o365cs-base .ms-fcl-ns,.o365cs-base .ms-fcl-ns-h:hover,.o365cs-base .ms-fcl-ns-f:focus{    color: '[theme:neutralSecondary, default:#666666]';}\n.o365cs-base .ms-fcl-ns.o365cs-nav-moduleLabel{    color: #666666;}\n.o365cs-base .ms-bgc-ns,.o365cs-base .ms-bgc-ns-h:hover,.o365cs-base .ms-bgc-ns-f:focus{    background-color: '[theme:neutralSecondary, default:#666666]';}\n.o365cs-base .ms-bcl-ns,.o365cs-base .ms-bcl-ns-h:hover,.o365cs-base .ms-bcl-ns-f:focus{    border-color: '[theme:neutralSecondary, default:#666666]';}\n.o365cs-base .ms-fcl-nsa,.o365cs-base .ms-fcl-nsa-h:hover,.o365cs-base .ms-fcl-nsa-f:focus{    color: '[theme:neutralSecondaryAlt, default:#767676]';}\n.o365cs-base .ms-bgc-nsa,.o365cs-base .ms-bgc-nsa-h:hover,.o365cs-base .ms-bgc-nsa-f:focus{    background-color: '[theme:neutralSecondaryAlt, default:#767676]';}\n.o365cs-base .ms-bcl-nsa,.o365cs-base .ms-bcl-nsa-h:hover,.o365cs-base .ms-bcl-nsa-f:focus{    border-color: '[theme:neutralSecondaryAlt, default:#767676]';}\n.o365cs-base .ms-fcl-nt,.o365cs-base .ms-fcl-nt-h:hover,.o365cs-base .ms-fcl-nt-f:focus{    color: '[theme:neutralTertiary, default:#a6a6a6]';}\n.o365cs-base .ms-bgc-nt,.o365cs-base .ms-bgc-nt-h:hover,.o365cs-base .ms-bgc-nt-f:focus{    background-color: '[theme:neutralTertiary, default:#a6a6a6]';}\n.o365cs-base .ms-bcl-nt,.o365cs-base .ms-bcl-nt-h:hover,.o365cs-base .ms-bcl-nt-f:focus{    border-color: '[theme:neutralTertiary, default:#a6a6a6]';}\n.o365cs-base .ms-fcl-nta,.o365cs-base .ms-fcl-nta-h:hover,.o365cs-base .ms-fcl-nta-f:focus{    color: '[theme:neutralTertiaryAlt, default:#c8c8c8]';}\n.o365cs-base .ms-bgc-nta,.o365cs-base .ms-bgc-nta-h:hover,.o365cs-base .ms-bgc-nta-f:focus{    background-color: '[theme:neutralTertiaryAlt, default:#c8c8c8]';}\n.o365cs-base .ms-bcl-nta,.o365cs-base .ms-bcl-nta-h:hover,.o365cs-base .ms-bcl-nta-f:focus{    border-color: '[theme:neutralTertiaryAlt, default:#c8c8c8]';}\n.o365cs-base .ms-fcl-nl,.o365cs-base .ms-fcl-nl-h:hover,.o365cs-base .ms-fcl-nl-f:focus{    color: '[theme:neutralLight, default:#eaeaea]';}\n.o365cs-base .ms-bgc-nl,.o365cs-base .ms-bgc-nl-h:hover,.o365cs-base .ms-bgc-nl-f:focus{    background-color: '[theme:neutralLight, default:#eaeaea]';}\n.o365cs-base .ms-bcl-nl,.o365cs-base .ms-bcl-nl-h:hover,.o365cs-base .ms-bcl-nl-f:focus{    border-color: '[theme:neutralLight, default:#eaeaea]';}\n.o365cs-base .ms-fcl-nlr,.o365cs-base .ms-fcl-nlr-h:hover,.o365cs-base .ms-fcl-nlr-f:focus{    color: '[theme:neutralLighter, default:#f4f4f4]';}\n.o365cs-base .ms-bgc-nlr,.o365cs-base .ms-bgc-nlr-h:hover,.o365cs-base .ms-bgc-nlr-f:focus,.o365cs-base.ms-bgc-nlr{    background-color: '[theme:neutralLighter, default:#f4f4f4]';}\n.o365cs-base .ms-bcl-nlr,.o365cs-base .ms-bcl-nlr-h:hover,.o365cs-base .ms-bcl-nlr-f:focus{    border-color: '[theme:neutralLighter, default:#f4f4f4]';}\n.o365cs-base .ms-fcl-nlra,.o365cs-base .ms-fcl-nlra-h:hover,.o365cs-base .ms-fcl-nlra-f:focus{    color: '[theme:neutralLighterAlt, default:#f8f8f8]';}\n.o365cs-base .ms-bgc-nlra,.o365cs-base .ms-bgc-nlra-h:hover,.o365cs-base .ms-bgc-nlra-f:focus,.o365cs-base.ms-bgc-nlra{    background-color: '[theme:neutralLighterAlt, default:#f8f8f8]';}\n.o365cs-base .ms-bcl-nlra,.o365cs-base .ms-bcl-nlra-h:hover,.o365cs-base .ms-bcl-nlra-f:focus{    border-color: '[theme:neutralLighterAlt, default:#f8f8f8]';}\n.o365cs-base .o365cs-topnavLinkBackground-2{    background-color: transparent;}\n.o365cs-base .o365cs-topnavText,.o365cs-base .o365cs-topnavText:hover{    color: '[theme:suiteBarText, default:#ffffff]';}\n.o365cs-base .o365cs-appLauncherBackground{    background-color: '[theme:themeDarker, default:#104a7d]';}\n.o365cs-nav-header16 .o365cs-navMenuButton{    color: '[theme:white, default:#ffffff]';}\n.o365cs-base .o365cs-navMenuButton{    color: '[theme:suiteBarText, default:#ffffff]';}\n.o365cs-base.o365cs-topnavBGImage{    background-position: center top;    background-repeat: repeat-x;    background-image: none;}\n.o365cs-base.o365cs-topnavBGColor-2{    background-color: '[theme:suiteBarBackground, default:#000000]';}\n")}},4275:function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(98),i=n(75);function s(e,t,n){return(function(e){var t=new r.t(this);return new i.n(function(n,r){var i=new FileReader;t.on(i,"load",function(e){n(i.result);t.dispose()});t.on(i,"error",function(e){r(i.error);t.dispose()});i.readAsDataURL(e)})})(e).then(function(r){var i=document.createElement("img");i.src=r;var s=i.width,o=i.height;if(s>o){if(s>t){o*=t/s;s=t}}else if(o>n){s*=n/o;o=n}s=Math.floor(s);o=Math.floor(o);if(s===i.width&&o===i.height)return e;var u=document.createElement("canvas");u.width=s;u.height=o;u.getContext("2d").drawImage(i,0,0,s,o);return(function(e){for(var t=atob(e.split(",")[1]),n=new Uint8Array(t.length),r=e.split(",")[0].split(":")[1].split(";")[0],i=0,s=t.length;i<s;i++)n[i]=t.charCodeAt(i);return new Blob([n],{type:r})})("image/jpeg"===e.type?u.toDataURL(e.type,.92):u.toDataURL(e.type))})}},4306:function(e,t,n){"use strict";var r=n(0),i=n(189),s=n(212),o=n(77),u=n(37),a=n(3932),f=n(718),l=n(3589),c={ODB:819,ODC:"EnablePushChannelLogging"},h={ODB:459},p={ODB:!0},d=["Due to organizational policies, you can't access these resources from this network location","One of the provided arguments is not acceptable","Session has been revoked","The access token has expired","The caller does not have permission to perform the action","The caller is not authenticated","The request is malformed or incorrect","There has been an error authenticating the request"],v=(function(){function e(e,t){this._firedConnectQoSEvent=!1;this._getSubscriptionAttempts=0;this._socketIoReconnectAttempts=0;this._notificationHandlers={};this._connectionHandlers={};this._disableWebSockets=e.disableWebSockets;this._subscriptionService=t.subscriptionService;this._sessionTokenFetcher=t.sessionTokenFetcher;this._async=new i.e;this._socketIoReconnectAttempts=0}e.prototype.isConnected=function(){return!!this._socketIo&&this._socketIo.connected};e.prototype.getSocketIoSubscription=function(){return this._subscription};e.prototype.addConnectionHandler=function(e,t){this._connectionHandlers[e]=t};e.prototype.removeConnectionHandler=function(e){delete this._connectionHandlers[e]};e.prototype.setupNotificationHandler=function(e,t){var n=e.source,r=e.scenarios,i=e.id,s=void 0===i?"":i,o=a.t[n];if(o){if(r&&r.length)for(var u=0,f=r;u<f.length;u++){var l=f[u];this._notificationHandlers[o.toLowerCase()+a.e[l].toLowerCase()+s]=t}else this._notificationHandlers[o.toLowerCase()+s]=t;return!0}return!1};e.prototype.connect=function(e,t){return Object(r.__awaiter)(this,void 0,void 0,function(){var n,i,f,c,h=this;return Object(r.__generator)(this,function(d){switch(d.label){case 0:this.disconnect();if(void 0!==e)return[3,2];n=this;return[4,this._getSubscription("PushChannelService.Connect")];case 1:n._subscription=d.sent();return[3,3];case 2:this._subscription=e;d.label=3;case 3:this._log("Connecting to subscription",this._subscription);if(void 0===this._subscription){this._log("Invalid subscription");return[2,!1]}if(!this._firedConnectQoSEvent||s.e.isFeatureEnabled(p)){this._firedConnectQoSEvent=!0;i=new o.e({name:"PushChannelService.Connect",extraData:Object(r.__assign)({notificationUrl:this._subscription.notificationUrl},t||{})})}f={reconnectionAttempts:20};-1!==this._subscription.notificationUrl.indexOf("pushn")?f.transports=["websocket"]:this._disableWebSockets&&(f.transports=["polling"]);c=this._socketIo=Object(l.connect)(this._subscription.notificationUrl,f);this._socketIo.on("connect",function(){if(c===h._socketIo){h._log("Connected");i&&i.end({resultType:u.e.Success,extraData:Object(r.__assign)({notificationUrl:h._subscription.notificationUrl},t||{})});h._executeConnectionHandlers(!0)}else c.disconnect()});this._socketIo.on("disconnect",function(){if(c===h._socketIo){h._log("Disconnected");h._executeConnectionHandlers(!1)}});this._socketIo.on("reconnect_failed",function(){h._log("Reconnect failed");i&&i.end({resultType:u.e.Failure,extraData:Object(r.__assign)({notificationUrl:h._subscription.notificationUrl},t||{})});h._subscription=void 0;h._socketIoReconnectAttempts++;h._socketIoReconnectAttempts>3?h._log("Exceeded max reconnect attempts"):h._async.setTimeout(function(){h.connect(void 0,{methodInvoker:"reconnect_failed"})},0)});this._socketIo.on("notification",function(e){h._log("Notification",e);var t;try{t=JSON.parse(e)}catch(e){return}var n=t.source,r=t.scenario?t.scenario.toLowerCase():"";n||(n=a.t[a.t.WebhookSubscription]);n=n.toLowerCase();var i=!1;i=h._handleMessage(t,n);var s=n+r;for(var o in h._notificationHandlers)-1!==o.indexOf(s)&&o!==n&&(i=h._handleMessage(t,o,s)||i);i||h._log("Notification - missing handler for message")});return[2,!0]}})})};e.prototype.disconnect=function(){if(this._socketIo){this._socketIo.disconnect();this._socketIo=void 0}if(this._async){this._async.dispose();this._async=new i.e}this._subscription=void 0};e.prototype.refreshSubscription=function(){return Object(r.__awaiter)(this,void 0,void 0,function(){var e;return Object(r.__generator)(this,function(t){switch(t.label){case 0:return[4,this._getSubscription("PushChannelService.refreshSubscription")];case 1:if(void 0===(e=t.sent()))return[2,void 0];if(this.isConnected()&&this._subscription&&this._subscription.notificationUrl!==e.notificationUrl){this._log("Notification url changed. Reconnecting...");this.connect(e,{methodInvoker:"PushChannelService.refreshSubscription"});return[2,!1]}this._subscription=e;return[2,!0]}})})};e.prototype._getSubscription=function(e){void 0===e&&(e="unknown");return Object(r.__awaiter)(this,void 0,void 0,function(){var t,n,i,a,l,c,p,v,m=this;return Object(r.__generator)(this,function(r){switch(r.label){case 0:n=void 0;s.e.isFeatureEnabled(h)&&(n=new o.e({name:"PushChannelService.getSubscription",extraData:{methodInvoker:e,getSubscriptionAttempts:this._getSubscriptionAttempts,socketIoReconnectAttempts:this._socketIoReconnectAttempts}}));r.label=1;case 1:r.trys.push([1,6,,7]);a=(i=this._subscriptionService).getSocketIoSubscription;l={};return this._sessionTokenFetcher?[4,this._sessionTokenFetcher()]:[3,3];case 2:c=r.sent();return[3,4];case 3:c=void 0;r.label=4;case 4:return[4,a.apply(i,[(l.sessionToken=c,l.existingSubscription=this._subscription,l)])];case 5:t=r.sent();n&&n.end({resultType:u.e.Success,extraData:{methodInvoker:e,getSubscriptionAttempts:this._getSubscriptionAttempts,socketIoReconnectAttempts:this._socketIoReconnectAttempts}});return[3,7];case 6:p=r.sent();this._log("Failed to get socketIo subscription",p);v=!1;Object(f.s)(p)&&(403===p.status?v=!0:p.error&&p.error.message&&(v=d.some(function(e){return 0===p.error.message.indexOf(e)})));n&&n.end({resultType:u.e.Success,extraData:{methodInvoker:e,getSubscriptionAttempts:this._getSubscriptionAttempts,socketIoReconnectAttempts:this._socketIoReconnectAttempts}});if(v)return[2,void 0];this._getSubscriptionAttempts++;return this._getSubscriptionAttempts>10?[2,void 0]:[2,new Promise(function(e){var t=500*Math.pow(2,m._getSubscriptionAttempts);m._log("Retrying in "+t+" milliseconds");m._async.setTimeout(function(){return e(m._getSubscription("Retry_getSubscription"))},t)})];case 7:return[2,t]}})})};e.prototype._handleMessage=function(e,t,n){void 0===n&&(n=t);var r=this._notificationHandlers[t];if(r){r(e.payload?e.payload:e.value);return!0}return!1};e.prototype._executeConnectionHandlers=function(e){for(var t=0,n=Object.keys(this._connectionHandlers);t<n.length;t++){var r=n[t];this._connectionHandlers[r](e)}};e.prototype._log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];s.e.isFeatureEnabled(c)&&console.log.apply(console,Object(r.__spreadArrays)(["PushChannelService"],e))};return e})();t.e=v},4307:function(e,t,n){"use strict";var r=(function(){function e(e,t){this._dataRequestor=t.dataRequestor;this._listId=e.listId;this._webAbsoluteUrl=e.webAbsoluteUrl}e.prototype.getSocketIoSubscription=function(e){var t,n;if(this._listId&&this._webAbsoluteUrl){t=this._webAbsoluteUrl+"/_api/v2.0/sites/root/lists/"+this._listId;n=!1}else{if(!e.sessionToken)throw new Error("Invalid session token");t="/drive/root";n=!0}return this._dataRequestor.send({path:t+"/subscriptions/socketIo",apiName:"GetSocketIo",requestType:"GET",accessToken:e.sessionToken,useAuthorizationHeaders:n}).then(function(e){return e})};return e})();t.e=r},4357:function(e,t,n){"use strict";n.d(t,"e",function(){return l});var r=n("react-lib"),i=n(1858),s=n(1648),o=n(141),u=n(851),a=n(1219),f=n(1442);function l(e){var t=e.dragDropKey,n=e.dragType,l=e.acceptType,c=e.showDefaultDragPreview,h=e.hookCallback,p=e.handlers,d=!!p.canDragHandler,v=Object(u.r)({dragSourceKey:t,type:n,handlers:p,collectDragAvailability:!1}),m=Object(i.e)(v),g=m[0],y=m[1],b=m[2];Object(r.useEffect)(function(){d&&b&&!c&&b(Object(f.e)(),{captureDraggingState:!0})},[d,b,c]);var w=Object(a.r)({acceptType:l,dropTargetKey:t,handlers:p}),E=Object(s.e)(w),S=E[0],x=E[1];Object(r.useEffect)(function(){h({collectedDragProps:g,collectedDropProps:S,connectDragSource:y,connectDropTarget:x})},[g,S,y,b,x]);return Object(o.t)(e.children,{collectedDragProps:g,collectedDropProps:S,connectDragSource:y,connectDropTarget:x})}},4358:function(e,t,n){"use strict";n.d(t,"e",function(){return o});var r=n(188),i="STS",s=[{registration:{id:i,swPrefetchManifestName:"stsserviceworkerprefetch"}},{registration:{id:"SPHome"}},{featureIds:[1966],registration:{id:"SitePages"}},{registration:{id:"Embed"}},{odc:!0,featureIds:["EnableODCServiceWorker"],registration:{id:"ODC"}},{featureIds:[60579],registration:{id:"CreateGroup"}},{featureIds:[60155],registration:{id:"SingleWebPart"}}];function o(e){var t=r.n.isFeatureEnabled({ODC:!0}),n=s.filter(function(e){if(t===!e.odc)return!1;var n=!0;e.featureIds&&e.featureIds.forEach(function(e){n=n&&r.n.isFeatureEnabled(t?{ODC:e}:{ODB:e})});switch(e.registration.id){case i:return n&&!navigator.userAgent.match(/Version\/[\d\.]+.*Safari/)}return n}).map(function(e){return e.registration}),o=JSON.stringify(n),u=!t&&r.n.isFeatureEnabled({ODB:1966})&&-1!==document.cookie.indexOf("SPClientSideFrameworkDevCookie-9076A2B0-2161-43C6-8BEA-9FECB7EA459B=");return(t?"/odc":"/_layouts/15/odsp")+"serviceworkerproxy.aspx?swManifestName="+(t?"odc":"sp")+"serviceworker&debug="+(u?"true":"false")+"&bypass="+(e?"true":"false")+"&applications="+encodeURIComponent(o)+(r.n.isFeatureEnabled({ODB:60448})?"&list=v2":"")}},4359:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(432);function i(){return Object(r.e)({data:{url:location.href,type:1}})}},4360:function(e,t,n){"use strict";n.d(t,"t",function(){return i});n.d(t,"e",function(){return s});var r;function i(){r||"function"!=typeof BroadcastChannel||(r=new BroadcastChannel("sw_broadcast"));return r}var s={OfflineNotification:"OfflineNotification",CheckOffline:"CheckOffline"}},4549:function(e,t,n){"use strict";n.d(t,"e",function(){return b});var r=n(0),i=n("react-lib"),s=n(1825),o=n(1664),u=n(416),a=n(2405),f=n(2202),l=n(16),c=n(3502),h=n(2501),p=n(3420),d=function(e){var t=e.activity,n=e.loginUserEmail,r=e.userEmail,s=Object(c.t)(),o="";"Access"===t.activityType?o=s.accessActivity:"Modified"===t.activityType&&(o=s.modifiedActivity);var u=t&&t.actor&&t.actor.user,d=Object(p.e)(u&&u.email,n,r)?s.loginUserYou:u&&u.displayName||u&&u.email||h.oe,v=i.createElement("div",{className:"analyticsActivityUserName_f87f3312"},d),m=i.createElement("div",{className:"analyticsActivityUserAction_f87f3312"},o),g=s.activityTemplate&&l.formatToArray(s.activityTemplate,v,m),y=f.n.size24;return i.createElement(a.e,{activityPersonas:[{imageUrl:u.image,imageAlt:d,imageInitials:e.imageInitials,initialsColor:e.initialsColor,size:y}],activityDescription:i.createElement("div",{dir:"auto",className:"analyticsActivity_f87f3312"},g),timeStamp:t.activityDateTime,styles:{root:{alignItems:"center"},activityContent:{padding:"0 12px"},personaContainer:{width:"24px",height:"24px"}}})},v=n(2968),m=n(1714),g=n(85),y=(function(e){Object(r.__extends)(t,e);function t(t){return e.call(this,t)||this}t.prototype.componentDidMount=function(){this.props.onLoaded&&this.props.onLoaded()};t.prototype.render=function(){return i.createElement(o.e,{size:u.e.large})};return t})(i.Component),b=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._onRenderCell=function(e,t){return e&&e.activity&&i.createElement("div",{className:"analyticsActivityListActivity_603257bf"},i.createElement(d,{activity:e.activity,loginUserEmail:n.props.loginUserEmail,userEmail:n.props.userEmail,imageInitials:e.imageInitials,initialsColor:e.initialsColor}),n.props.moreActivities&&t===n.state.items.length-1?i.createElement(y,{onLoaded:n.props.onLoadMoreActivities}):void 0)};n.state={items:t.itemAnalytics&&t.itemAnalytics.activities.map(function(e){return{activity:e}}),itemAnalyticsData:t.itemAnalytics};return n}t.prototype.UNSAFE_componentWillReceiveProps=function(e){if(e.itemAnalytics){this._updateActivities(e.itemAnalytics);this.props.pageContext&&this._updateAcronyms(e.itemAnalytics)}};t.prototype.render=function(){var e,t=this,n=this.props.showAnalyticsStats,r=void 0===n||n,o=this.state.itemAnalyticsData,u=Object(c.t)();o&&o.incompleteData&&o.incompleteData.wasThrottled&&(e=u.throttledMessage);if(o){v.t();return i.createElement("div",null,r&&i.createElement(c.e,{itemAnalytics:o,inComplete:!!e}),this.state.items&&i.createElement(s.e,{items:this.state.items,onRenderCell:this._onRenderCell,onShouldVirtualize:function(){return t.state.items.length>30}}))}return i.createElement(y,null)};t.prototype._updateActivities=function(e){this.setState(function(){return{itemAnalyticsData:e,items:e.activities.map(function(e){return{activity:e}})}})};t.prototype._updateAcronyms=function(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t,n,i,s;return Object(r.__generator)(this,function(r){switch(r.label){case 0:r.trys.push([0,3,,4]);if(!this.props.pageContext)return[3,2];t=e.activities.map(function(e){return e.actor.user.displayName});return[4,new m.e(this.props.pageContext).getAcronyms(t,{qosName:"ItemAnalyticsListAcronyms"})];case 1:n=r.sent();i=n.reduce(function(e,t){t.text&&(e[t.text]=t);return e},{});this.setState(function(e){return{items:e.items.map(function(e){var t=i[e.activity.actor.user.displayName];return{activity:e.activity,imageInitials:t&&t.acronym,initialsColor:t&&t.color}})}});r.label=2;case 2:return[3,4];case 3:s=r.sent();g.e.logError(s);v.e(s);return[3,4];case 4:return[2]}})})};return t})(i.Component)},4561:function(e,t,n){"use strict";n.d(t,"e",function(){return h});n.d(t,"t",function(){return p});var r,i=n(0),s=n(75);(function(e){e[e.MalwareDetected=0]="MalwareDetected";e[e.ThisFileIsCheckedOut=1]="ThisFileIsCheckedOut";e[e.DLPBlocked=2]="DLPBlocked";e[e.MissingMetaData=3]="MissingMetaData";e[e.DLPWarning=4]="DLPWarning";e[e.AwaitingApproval=5]="AwaitingApproval";e[e.Trending=6]="Trending";e[e.New=7]="New";e[e.NeedsRepublishing=8]="NeedsRepublishing"})(r||(r={}));var o=n(1137),u=n(37),a=n(718),f=n(1133),l=n(4657);var c="/_layouts/15/userphoto.aspx?size=S&accountname=",h=(function(){function e(e,t){this._eTagMap={};this._dataRequestor=t.vroomDataRequestor;var n=t.getProfileImageUrl,r=void 0===n?function(e){return Object(o.getUserPhotoUrl)(e)}:n,i=t.caller,s=void 0===i?"hovercard":i,u=t.useSharePointApi,a=void 0!==u&&u;this._getProfileImageUrl=r;this._caller=s;this._useSharePointApi=a}e.prototype.getItemAnalytics=function(e,t){void 0===t&&(t={});var n=t.apiVersion,r=void 0===n?"v2.1":n,i=t.skipToken,o=void 0===i?"":i,u=t.headers,a=void 0===u?{Caller:this._caller}:u,f=o?";$skiptoken="+o:"",l="GetItemAnalytics"+r+(e.queryType?"_"+e.queryType:"")+"_WithGuestUser",c=this._getBaseUrl(e);if(!c)return s.n.resolve();var h=c+"/analytics/allTime?$expand=activities"+"($filter=access%20ne%20null)"+f;return this._getAnalytics(l,h,!1,e,a)};e.prototype.getAnalyticsSections=function(e,t){void 0===t&&(t={});if(this._useSharePointApi)return s.n.reject(void 0);var n=t.headers,r=void 0===n?{Caller:this._caller}:n,i=this._getBaseUrl(e);if(!i)return s.n.resolve();",id,reactions";"$expand=insights($expand=keyPoints)";",malware,metadataMissing,awaitingApproval,trending,retentionPolicy,publication,dataLossPrevention";var o="$select=*,id,reactions,malware,metadataMissing,awaitingApproval,trending,retentionPolicy,publication,dataLossPrevention",u=o+"&$expand=insights($expand=keyPoints)",a=this._useSharePointApi?i+"/driveItem?"+u:i+"?"+u;return this._getAnalytics("GetAnalyticsSections_WithReaction_WithKeyPoints_WithLifeCycle",a,!0,e,r)};e.prototype.getItemAnalyticsSections=function(e,t){void 0===t&&(t={});var n="$expand=analytics($expand=allTime($expand=activities($filter=access%20ne%20null)))",r=this._getBaseUrl(e);if(!r)return s.n.resolve();var i=t.apiVersion,o=void 0===i?"v2.1":i,u=t.headers,a=void 0===u?{Caller:this._caller}:u,f=e.queryType?"_"+e.queryType:"";if(this._useSharePointApi){var l="GetItemAnalyticsSharePoint"+o+f,c=r+"/driveItem?"+n;return this._getAnalytics(l,c,!0,e,a)}var h="GetItemAnalyticsSections"+o+f+"_WithGuestUser_WithReaction_WithKeyPoints_WithLifeCycle",p=r+"?$select=*,id,reactions,malware,metadataMissing,awaitingApproval,trending,retentionPolicy,publication,dataLossPrevention&$expand=analytics($expand=allTime($expand=activities($filter=access%20ne%20null))),insights($expand=keyPoints)";return this._getAnalytics(h,p,!0,e,a)};e.prototype.getLastSevenDaysItemAnalytics=function(e){var t=this._getBaseUrl(e),n={Caller:this._caller};if(!t)return s.n.resolve();var r=t+"/analytics/lastSevenDays?$expand=activities($filter=ActivityType%20eq%20%27Access%27)";return this._getAnalytics("GetLastSevenDaysItemAnalytics",r,!1,e,n)};e.prototype.getItemAnalyticsByInterval=function(e,t,n,r){var i=t.toISOString(),s=n.toISOString(),o=this._getBaseUrl(e)||"",u=this._getAnalyticsByIntervalPath(o,"v2.1",i,s,r);return this._getAnalyticsByInterval("GetDailyItemAnalytics",u,e.getAccessToken&&e.getAccessToken(),"v2.1")};e.prototype._getAnalytics=function(e,t,n,r,s,o){var u=this;return this._dataRequestor.send({apiName:e,path:t,accessToken:r.getAccessToken&&r.getAccessToken(),headers:s,timeout:6e3,qosExtraData:{Caller:this._caller}}).then(function(e){"string"==typeof e.isTrending&&"True"===e.isTrending||"boolean"==typeof e.isTrending&&!0===e.isTrending?e.isTrending=!0:e.isTrending=!1;e.eTag&&(u._eTagMap[r.itemId]=e.eTag);return n?p(e,u._getProfileImageUrl):(function(e,t){var n=e.activities,r=e.access,s=e.endDateTime,o=Object(i.__rest)(e,["activities","access","endDateTime"]);return{activities:v(n,t),incompleteData:o.incompleteData,startDateTime:o.startDateTime,skipToken:o.skipToken,isTrending:o.isTrending,viewCount:r&&r.actionCount,viewerCount:r&&r.actorCount,lastActivityDateTime:s}})(e,u._getProfileImageUrl)})};e.prototype.updateItemKeyPoints=function(e,t){var n=this,r=this._getBaseUrl(e)+"/insights/keyPoints";return this._dataRequestor.send({path:r,apiName:"UpdateKeyPoints",requestType:"POST",headers:{Caller:this._caller,"if-Match":this._eTagMap[e.itemId]},postData:JSON.stringify({value:t}),accessToken:e.getAccessToken&&e.getAccessToken(),timeout:6e3,qosExtraData:{Caller:this._caller},parseResponse:function(t){n._eTagMap[e.itemId]=t.getResponseHeader("eTag")||"";return JSON.parse(t.responseText)}}).then(function(e){return e.value})};e.prototype._getAnalyticsByInterval=function(e,t,n,r){return this._dataRequestor.send({apiName:e,path:t,accessToken:n,useAuthorizationHeaders:this._useSharePointApi,timeout:6e3,qosExtraData:{Caller:this._caller}}).then(function(e){var t;"v2.1"===r?(e=e)&&e.value&&(t=e.value.map(m)):t=(e=e).Items;return t})};e.prototype._getBaseUrl=function(e){return e&&e.graphItemUrl?""+e.graphItemUrl:null};e.prototype._getAnalyticsByIntervalPath=function(e,t,n,r,i){var s;i=i||"day";var o="v2.1"===t?"oneDrive.getActivitiesByInterval":"getanalyticsbyinterval";s=this._useSharePointApi?"interval='"+i+"',startDateTime='"+n+"',endDateTime='"+r+"'":"v2.1"===t?"startDateTime="+n+"&endDateTime="+r+"&interval="+i:"startDateTime='"+n+"'&endDateTime='"+r+"'&interval='"+i+"'";return this._useSharePointApi?e+"/oneDrive.getActivitiesByInterval("+s+")":e+"/"+o+"?"+s};e.prototype.getFilesAnalytics=function(e,t,n){var r=this;return e&&t?this._dataRequestor.send({apiName:"getFilesAnalytics.byItems",useAuthorizationHeaders:!0,accessToken:n,apiVersion:"v2.1",path:t+"/items?$expand=analytics($expand=lastSevenDays)&$filter=sharepointIds/listItemUniqueId eq '"+e.join("' or sharepointIds/listItemUniqueId eq '")+"'",postProcessQos:this._overrideFilesAnalyticsExpectedFailure}).then(function(e){return r._parseFilesAnalyticsResponse(e)}):s.n.resolve()};e.prototype.getRecommendedActions=function(e){var t=this._getBaseUrl(e)+"?$expand=recommendedActionSet($expand=nonAggregatedRecommendedActions,aggregatedEditRecommendedAction($expand=importantActorsAndActivities))";return this._dataRequestor.send({apiName:"RecommendedActions",path:t,accessToken:e.getAccessToken&&e.getAccessToken(),timeout:6e3,parseResponse:function(e){return JSON.parse(e.responseText).recommendedActionSet},headers:{Caller:this._caller},qosExtraData:{Caller:this._caller}})};e.prototype.getShareWith=function(e){var t=this._getBaseUrl(e)+"/recommendations/shareWith/users?$top=2&$filter=userType eq 'Internal'";return this._dataRequestor.send({apiName:"ShareWith",path:t,accessToken:e.getAccessToken&&e.getAccessToken(),timeout:6e3,parseResponse:function(e){return JSON.parse(e.responseText).value},headers:{Caller:this._caller},qosExtraData:{Caller:this._caller}})};e.prototype._overrideFilesAnalyticsExpectedFailure=function(e,t){var n=t?Object(a.t)(t,function(e){switch(e){case"notSupported":return{resultType:u.e.ExpectedFailure}}}):{};return Object(i.__assign)(Object(i.__assign)({},e),n)};e.prototype._parseFilesAnalyticsResponse=function(e){var t=this,n=(e.value,Object(i.__rest)(e,["value"])),r=e.value.map(function(e){var n=e.analytics,r=Object(i.__rest)(e,["analytics"]);return Object(i.__assign)(Object(i.__assign)({},r),{analytics:{lastSevenDays:d(n.lastSevenDays,t._getProfileImageUrl)}})});return Object(i.__assign)(Object(i.__assign)({},n),{value:r})};return e})();function p(e,t){var n=e&&e.analytics&&e.analytics.allTime,i=n&&n.access,s=n&&n.endDateTime,o=v(n&&n.activities,t),u=(function(e){var t=[];e.malware&&t.push({status:r.MalwareDetected});e.publication&&e.publication.level.indexOf("checkout")>-1&&t.push({status:r.ThisFileIsCheckedOut,userCheckedOutThis:e.publication.checkedOutBy&&e.publication.checkedOutBy.user});e.dataLossPrevention&&(e.dataLossPrevention.block?t.push({status:r.DLPBlocked}):e.dataLossPrevention.notify&&t.push({status:r.DLPWarning}));e.metadataMissing&&t.push({status:r.MissingMetaData});e.awaitingApproval&&t.push({status:r.AwaitingApproval});e.trending&&t.push({status:r.Trending});if(e.createdDateTime){var n=new Date(e.createdDateTime);(i=n,s=(new Date).getTime(),o=i&&i.valueOf(),!isNaN(o)&&s-o<1728e5)&&t.push({status:r.New,createdRelativeTime:Object(f.n)(Object(l.t)(e.createdDateTime)),creator:e.createdBy&&e.createdBy.user})}var i,s,o;return t})(e),a=(function(e){var t=e&&e.insights,n=t&&t.keyPoints;return t&&{readTime:t.readTime,keyPoints:n}})(e),c=e&&e.reactions;return{activities:o||[],incompleteData:n&&n.incompleteData,startDateTime:n&&n.startDateTime,skipToken:n&&n.skipToken,isTrending:n&&n.isTrending,viewCount:i&&i.actionCount,viewerCount:i&&i.actorCount,commentCount:c&&c.commentCount,likeCount:c&&c.likeCount,lifeCycleStatus:u,keyPointsData:a,lastActivityDateTime:s,createdBy:e.createdBy&&e.createdBy.user,createdDateTime:e.createdDateTime}}function d(e,t){e.activities;var n=Object(i.__rest)(e,["activities"]),r=e.activities&&e.activities.map(function(e){var n=Object(i.__rest)(e,[]),r=n.actor&&n.actor.user&&n.actor.user.email;n.activityDateTime=Object(f.n)(Object(l.t)(n.activityDateTime));n.actor.user.image=t&&t(n.actor.user.email)||""+c+r;return n});return Object(i.__assign)(Object(i.__assign)({},n),{activities:r})}function v(e,t){return e&&e.map(function(e){var n=Object(i.__rest)(e,[]),r=n.actor&&n.actor.user&&n.actor.user.email,s=Object(i.__assign)(Object(i.__assign)({},n.actor.user),{image:t?t(r):""+c+r,userType:n.actor.user.userType});return Object(i.__assign)(Object(i.__assign)({},n),{activityDateTime:Object(f.n)(Object(l.t)(n.activityDateTime)),actor:Object(i.__assign)(Object(i.__assign)({},n.actor),{location:n.location,user:s}),activityType:n.access?"Access":"Edit"})})}function m(e){return e&&{activity:{},incompleteData:{missingDataBeforeDateTime:e.endDateTime,wasThrottled:e.incompleteData&&e.incompleteData.wasThrottled},isTrending:e.isTrending,startDateTime:e.startDateTime,viewCount:e.access&&e.access.actionCount,viewerCount:e.access&&e.access.actorCount}}},4581:function(e,t,n){"use strict";n.d(t,"e",function(){return c});var r=n(0),i=n("react-lib"),s=n(1564),o=n(3502),u=n(1722),a=n(325),f=n(2788),l=n(1386),c=function(e){var t=e.items,n=e.farItems,c=e.analyticsStats,h=e.isLink,p=e.showActionBar,d=void 0===p||p,v=!(!c||!c.itemAnalytics&&!c.isNotSupported&&c.status!==f.e.unsupport&&c.status!==f.e.failed),m=e.itemKey?i.createElement(l.e,{className:"analyticsActionBar_43e4af34",commands:t,farCommands:n}):i.createElement(s.e,{className:"analyticsActionBar_43e4af34",items:t,farItems:n});return i.createElement("div",null,i.createElement("div",{className:"analyticsActionBarStats_43e4af34"},i.createElement(u.e,{width:"35%",isDataLoaded:v,shimmerElements:[{type:a.e.line,height:8}]},i.createElement(o.e,Object(r.__assign)({isLink:h,isCompact:!0},c)))),d&&(n.length>0||t.length>0)&&m)}},4657:function(e,t,n){"use strict";n.d(t,"t",function(){return i});n.d(t,"e",function(){return s});var r=n(16);function i(e){return new Date(e)}function s(e,t){void 0===t&&(t=!1);var n=new Date(e),i=n.getTimezoneOffset()<0,s=n.getFullYear()+"",o=Object(r.leftPad)(n.getMonth()+1+"",2),u=Object(r.leftPad)(n.getDate()+"",2),a=Object(r.leftPad)(n.getHours()+"",2),f=Object(r.leftPad)(n.getMinutes()+"",2),l=Object(r.leftPad)(n.getSeconds()+"",2),c=(i?"+":"-")+Object(r.leftPad)(i?(Math.ceil(n.getTimezoneOffset()/60)+"").replace("-",""):Math.floor(n.getTimezoneOffset()/60)+"",2)+Object(r.leftPad)((n.getTimezoneOffset()%60).toString().replace("-",""),2);return t?s+"-"+o+"-"+u+"T"+a+":"+f+":"+l+c:s+o+u+"T"+a+f+l+c}},4664:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(0),i=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this)||this;r._value=t;r._match=n;return r}t.prototype.apply=function(e){return this._match(e)?e:this._value};return t})(n(71).t)},4861:function(e,t,n){"use strict";n.r(t);n.d(t,"FileHoverCard",function(){return He});n.d(t,"CurrentFileHoverCard",function(){return Be});var r=n(0),i=n("react-lib"),s=n(4126),o=n(134),u=n(205),a=n(14),f=n(5),l=n(1177),c=n(26),h=n(508),p=n(1732),d=n(18),v=n(1042),m=n(371),g=n(28),y=n(160),b=n(39),w=n(4549),E=n(556),S=n(2969),x=n(557),T=n(1676),N=n(1825),C=n(1657),k=n(1571),L=n(2501),A=n(16),O=n(148),M=(function(){function e(e){this._engagementData={};this._engagement=e||O.e}Object.defineProperty(e.prototype,"engagementData",{set:function(e){this._engagementData=e},enumerable:!0,configurable:!0});e.prototype.logData=function(e,t){this._engagement.logData(Object(r.__assign)(Object(r.__assign)({name:e},this._engagementData),{extraData:Object(r.__assign)(Object(r.__assign)({},this._engagementData.extraData),t)}))};return e})(),_=i.createContext(new M),D=n(212),P=n(628),H={ODB:1588,OneDrive:!0},B={ODB:1883,OneDrive:!0},j={ODB:1020,OneDrive:!0},F={ODB:1015,OneDrive:!0},I=[P.u,P.n,P.s,".docx",".xlsx",".pptx",".doc",".xls",".ppt",".pdf"];function q(){return D.e.isFeatureEnabled(B)}function R(){return D.e.isFeatureEnabled(F)}var U=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._onClick=function(e){n.context.logData("FileHoverCard.KeyPoints.Click");n.props.onKeyPointsClick&&n.props.onKeyPointsClick(e)};n._onClickMoreIcon=function(e){n._moreIconElement=e.currentTarget;n.setState({showCallout:!0});n.context.logData("FileHoverCard.KeyPoints.ClickMoreIcon")};n.state={showCallout:!1};return n}t.prototype.render=function(){var e=this,t=L.ce,n=this.props.keyPointsData;return i.createElement("div",{className:"fileHoverCardInsideLook_2b6030ba",style:q()?{borderTop:0,paddingTop:0}:{}},!q()&&i.createElement("div",{className:"fileHoverCardInsideLookTitle_2b6030ba"},i.createElement("div",null,!q()&&L.le,i.createElement(T.e,{content:t,directionalHint:o.e.bottomCenter},i.createElement(x.e,{iconName:"Info",ariaLabel:t,role:"tooltip",tabIndex:0}))),this._ellipses()),this.state.showCallout&&i.createElement(k.e,{gapSpace:0,isBeakVisible:!0,shouldFocusOnMount:!0,target:this._moreIconElement,onDismiss:function(){return e.setState({showCallout:!1})},directionalHint:Object(E.e)()?o.e.bottomLeftEdge:o.e.bottomRightEdge,items:[{key:"sendFeedback",name:L.q,onClick:this.props.onSendFeedbackClick},{key:"editKeyPoints",name:L.h,onClick:this.props.onKeyPointsClick}]}),!(!n||!n.readTime||void 0===n.readTime.minutes)&&i.createElement("div",{className:"fileHoverCardReadTimeContainer_2b6030ba",style:q()?{justifyContent:"space-between"}:{}},i.createElement("div",{className:"fileHoverCardReadTime_2b6030ba"},i.createElement(x.e,{className:"fileHoverCardReadTimeIcon_2b6030ba",iconName:"Clock","aria-describedby":t}),this._timeToReadMessage(n.readTime.minutes)),q()&&this._ellipses()),n&&n.keyPoints&&n.keyPoints.length>0&&(this.props.onKeyPointsClick?i.createElement(S.e,{className:"fileHoverCardKeyPointsButton_2b6030ba",onClick:this._onClick,styles:{flexContainer:{flexWrap:"wrap"}}},this._keyPointsContent(n)):i.createElement("div",{className:"fileHoverCardKeyPointsNonButton_2b6030ba"},this._keyPointsContent(n))))};t.prototype._keyPointsContent=function(e){return i.createElement(i.Fragment,null,i.createElement("div",{className:"fileHoverCardKeyPointsAction_2b6030ba"},L.de),i.createElement(N.e,{renderCount:3,items:e.keyPoints,onRenderCell:this._onRenderCell,className:"fileHoverCardKeyPointsContent_2b6030ba"}))};t.prototype._onRenderCell=function(e){return e&&i.createElement("div",{className:"fileHoverCardKeyPointsCell_2b6030ba"},i.createElement("div",{className:"fileHoverCardKeyPointsBullet_2b6030ba"}),i.createElement("div",{dir:"auto",className:"fileHoverCardKeyPointsText_2b6030ba"},e.text))};t.prototype._ellipses=function(){return this.props.onSendFeedbackClick&&i.createElement(C.e,{iconProps:{iconName:"More"},onClick:this._onClickMoreIcon,ariaLabel:L.N,style:{marginTop:"2px"}})};t.prototype._timeToReadMessage=function(e){if(0===e)return L.De;if(e>60){var t=A.getLocalizedCountValue(L.Oe,L.Me,Math.floor(e/60));return t&&A.format(t,Math.floor(e/60))}return A.format(L._e,e)};return t})(i.Component);U.contextType=_;var z=n(1850),W=n(3420),X=n(858),V=n(1133),$=n(861);function J(e){var t,n,r,i,s,o,u=e.lifeCycleSignalData,a=e.loginUserEmail,f=e.userEmail,l=e.createdBy,c=e.createdDateTime,h=e.onRenderLifeCycleSignal,p=u.signal;switch(u.key){case X.o:t=L.me;n="https://go.microsoft.com/fwlink/?linkid=862871";s=L.ve;break;case X.c:t=L.ze;r=e.onCheckIn;i=e.onDiscardCheckOut;s=e.onCheckIn?L.ie:void 0;o=e.onDiscardCheckOut?L.se:void 0;break;case X.f:t=u.title;break;case X.e:t=L.a;r=e.onViewPolicyTip;s=L.je;break;case X.u:t=L.ge;r=e.onAddMetadataNow;s=L.ee;break;case X.t:t=L.f;r=e.onViewPolicyTip;s=L.je;break;case X.l:t=u.title;break;case X.a:var d=c&&Object(V.n)(new Date(c));t=l&&l.email&&Object(W.e)(l.email,a,f)?A.format(L.Ue,d):A.format(L.we,d,l&&l.displayName);break;default:p=null}return(h?Object($.e)(h,K):K)({signal:p,content:t,action:r,actionName:s,secondaryAction:i,secondaryActionName:o,link:n})}function K(e){return e&&e.signal?i.createElement("div",{className:"fileHoverCardLifeCycle_7b573ea9"},e.signal,i.createElement("div",{className:"fileHoverCardLifeCycleMessage_7b573ea9"},e.content&&i.createElement("div",{className:"fileHoverCardLifeCycleTitle_7b573ea9"},e.content),(e.action||e.link)&&i.createElement(z.e,{className:"fileHoverCardLifeCycleAction_7b573ea9",href:e.link,target:e.link&&"_blank",onClick:e.action},e.actionName),e.secondaryAction&&" "+L._+" ",e.secondaryAction&&i.createElement(z.e,{className:"fileHoverCardLifeCycleAction_7b573ea9",onClick:e.secondaryAction},e.secondaryActionName))):null}var Q=n(2405),G=n(4657),Y=n(56),Z=n(3598),ee=(function(e){Object(r.__extends)(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._handleClickShare=function(e){var n=t.props.shareWith&&t.props.shareWith.slice(0,2).map(function(e){return e.email});t.props.onShareWith(e,n);Object(Z.e)("FileHoverCard.RecommendedActions.ShareWith",t.props.item)};return t}t.prototype.render=function(){var e=this,t=this.props,n=t.editActivities,r=t.shareWith,s=this.props.shareWith&&this.props.shareWith.slice(0,2).map(function(e){return e.email});return r&&r.length>=2&&i.createElement(i.Fragment,null,i.createElement("div",{className:"fileHoverCardShareWith_598162d9"},A.formatToArray(L.U,this._userNameJSX(r[0].displayName),this._userNameJSX(r[1].displayName))),this.props.onRenderShareWithPeople?i.createElement("div",{className:"fileHoverCardShareWithLink_598162d9"},this.props.onRenderShareWithPeople(s)):i.createElement(z.e,{className:"fileHoverCardShareWithLink_598162d9",onClick:this._handleClickShare},L.z),n&&n.map(function(t,n){return n<2&&i.createElement(Q.e,{key:n,activityIcon:i.createElement(x.e,{iconName:"Edit",className:"fileHoverCardRecommendedIcon_598162d9"}),onRenderActivityDescription:function(){return e._onRenderActivityDescription(t)},timeStamp:t.activityDateTime})}))};t.prototype._onRenderActivityDescription=function(e){var t=e&&e.actor&&e.actor.user,n=Object(W.e)(t&&t.email,this.props.loginUserEmail,this.props.userEmail)?L.Re:e.actor.user.displayName;return i.createElement("div",{className:"fileHoverCardActivity_598162d9"},A.formatToArray(L.S,this._userNameJSX(n)))};t.prototype._userNameJSX=function(e){return i.createElement("div",{key:e,className:"fileHoverCardUserName_598162d9"},e)};return t})(i.Component),te=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._recommendedAction=function(e,t){var r=Object(V.n)(Object(G.t)(e.activityTimestamp)),s="",u="",a="";switch(e.recommendationEventType){case"Mentioned":s="Accounts";a=A.formatToArray(L.T,n._userNameJSX(e.actorDisplayName));u=L.H;break;case"Edited":s="Edit";a=L.p;u=L.M;var f=e.importantActorsAndActivities[0],l=f&&f.activityTimestamp;r=l&&Object(V.n)(Object(G.t)(l));var c=e.importantActorsAndActivities.map(function(e){return e.actorDisplayName});a=1===c.length?A.formatToArray(L.O,n._userNameJSX(c[0])):2===c.length?A.formatToArray(L.K,n._userNameJSX(c[0]),n._userNameJSX(c[1])):A.formatToArray(L.p,n._userNameJSX(c[0]),n._userNameJSX(c[1]),e.recentEditorCount-2);break;case"Commented":s="Chat";a=A.formatToArray(L.s,n._userNameJSX(e.actorDisplayName));u=L.Q}return i.createElement("div",{key:t},i.createElement("div",{className:"fileHoverCardRecommendedAction_598162d9"},i.createElement(Q.e,{activityIcon:i.createElement(x.e,{iconName:s,className:"fileHoverCardRecommendedIcon_598162d9"}),activityDescription:i.createElement("div",{className:"fileHoverCardRecommendedMessage_598162d9"},a),timeStamp:r}),i.createElement(T.e,{content:L.c,directionalHint:o.e.topCenter},i.createElement(C.e,{className:"fileHoverCardCancelIcon_598162d9",iconProps:{iconName:"Cancel"},onClick:function(){return n._handleClickDismiss(t)}}))),i.createElement(z.e,{className:"fileHoverCardRecommendedLink_598162d9",href:n._getNavLink(e.navigationId),target:"_blank",onClick:function(){n.context.logData("FileHoverCard.RecommendedActions."+e.recommendationEventType,{})}},u))};n._getNavLink=function(e){if(n.props.pageUrl&&e){var t=new Y.t(n.props.pageUrl);t.setQueryParameter("nav",e);t.setQueryParameter("commentId",e);return t.toString()}return n.props.pageUrl};n._recommendedActionRef=function(e){var t=n.state.recommendedActions;n.context.logData("FileHoverCard.RecommendedActions.Render",{activityType:t&&t.length>0?"HighActivities":"LowActivities"})};n.state={recommendedActions:n.props.actions.recommendedActions};return n}t.prototype.render=function(){var e=this.state.recommendedActions;return e&&e.length>0&&i.createElement("div",{ref:this._recommendedActionRef,className:"fileHoverCardRecommendedSection_598162d9",style:q()?{borderTop:0}:{}},!q()&&i.createElement("div",{className:"fileHoverCardRecommendedTitle_598162d9"},L.D),e&&e.length>0?e.slice(0,3).map(this._recommendedAction):i.createElement(ee,{item:this.props.item,shareWith:this.props.actions.shareWith,editActivities:this.props.actions.editActivities,loginUserEmail:this.props.loginUserEmail,userEmail:this.props.userEmail,onShareWith:this.props.onShareWith,onRenderShareWithPeople:this.props.onRenderShareWithPeople}))};t.prototype._userNameJSX=function(e){return i.createElement("span",{className:"fileHoverCardUserName_598162d9"},e)};t.prototype._handleClickDismiss=function(e){this.context.logData("FileHoverCard.RecommendedActions.Dismiss",{recommendedActionId:this.state.recommendedActions[e].recommendationId});this.props.onDismiss(this.state.recommendedActions[e].recommendationId,e);this.state.recommendedActions.splice(e,1);this.setState({recommendedActions:this.state.recommendedActions})};return t})(i.Component);te.contextType=_;var ne=n(867),re=n(1435),ie=n(3919),se=n(469),oe=(function(e){Object(r.__extends)(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._conversation=function(e,n){var r=t._context(e),s=e.deepLink,o=t._getIconName(e.conversationType),u=t._participants(e),a=e.referencePreview,f=Object(V.n)(new Date(e.activityTimestamp));return i.createElement("div",{key:n},i.createElement("div",{className:"fileHoverCardConversation_11349dc8",onClick:function(){var e=window.open(s,"_blank");e&&e.focus();t.context.logData("FileHoverCard.Conversations.ClickDeepLink",{})}},i.createElement(Q.e,{activityIcon:i.createElement(x.e,{iconName:o,className:"fileHoverCardConversationIcon_11349dc8"}),activityDescription:u,comments:i.createElement(i.Fragment,null,r,i.createElement("div",{className:"fileHoverCardConversationReferencePreview_11349dc8"},a)),timeStamp:f})))};return t}t.prototype.render=function(){var e=this.props.conversations;return i.createElement("div",{className:"fileHoverCardConversationsSection_11349dc8",style:q()?{borderTop:0}:{}},!q()&&i.createElement("div",{className:"fileHoverCardConversationsTitle_11349dc8"},L.o),e.slice(0,3).map(this._conversation))};t.prototype._context=function(e){var t=e.context,n=i.createElement(i.Fragment,null),r="fileHoverCardConversationContext_11349dc8";if(e.conversationType===ie.e.CalendarEvent){t=A.format(L.x,e.context);n=i.createElement(x.e,{iconName:"Event",className:"fileHoverCardConversationsMeetingIcon_11349dc8"});r="fileHoverCardMeetingConversationContext_11349dc8"}var s=0===t.length?i.createElement(i.Fragment,null):i.createElement("div",{className:r},t);return i.createElement(i.Fragment,null,n,s)};t.prototype._participants=function(e){var t,n=this;t=e.participants.filter(function(t){return t.identity.displayName&&!n._isSharedByUser(t.identity.email,e.sharedByUserEmail,t.identity.displayName,e.sharedByUserDisplayName)}).map(function(e){return Object(W.e)(e.identity.email,n.props.loginUserEmail,n.props.userEmail)?L.Re:e.identity.displayName}).join(", ");var r=e.isSharedByMe?L.Re:e.sharedByUserDisplayName;return i.createElement("div",{className:"fileHoverCardConversationParticipants_11349dc8"},i.createElement("span",{className:"fileHoverCardConversationSharedByUser_11349dc8"},0===t.length?r:r+", "),t)};t.prototype._isSharedByUser=function(e,t,n,r){return e.toLowerCase()===t.toLowerCase()||n.toLowerCase()===r.toLowerCase()};t.prototype._getIconName=function(e){var t=e===ie.e.CalendarEvent||e===ie.e.Mail?Object(se.n)({extension:"",brand:"outlook"}):Object(se.n)({extension:"",brand:"teams"});if(t)return t.iconName};return t})(i.PureComponent);oe.contextType=_;var ue=n(145),ae=n(198),fe=n(1161),le=n(129),ce=n(29),he=n(9),pe=n(1679),de=n(203),ve=n(531);function me(e){return i.createElement("div",{className:"fileHoverCardRelatedFilesSection_048e12ce",style:q()?{borderTop:0}:{}},!q()&&i.createElement("div",{className:"fileHoverCardRelatedFilesTitle_048e12ce"},L.P),e.relatedFilesKeys.slice(0,3).map(function(e,t){return(function(e,t){return i.createElement(u.e,{key:t},function(n){var r,s=n.itemCache,o=s.demandItemFacet(f.h,e),u=(function(e){if(!e)return;var t=Object(pe.n)({extension:e,size:16});return t?t.iconName:void 0})(null===(r=o)||void 0===r?void 0:r.split(".")[1]),a=Object(de.r)(s,i.createElement(ve.e,{itemKey:e,engagement:{name:"FileHoverCard.RelatedFiles.ClickDeepLink"}}));return i.createElement(d.n,{action:a},function(e){var n=e.execute;return i.createElement("div",{key:"relatedFile_"+t},i.createElement("div",{className:"fileHoverCardRelatedFile_048e12ce",onClick:function(){n()}},i.createElement(Q.e,{activityIcon:i.createElement(x.e,{iconName:u,className:"fileHoverCardRelatedFileIcon_048e12ce"}),activityDescription:i.createElement(i.Fragment,null,i.createElement("div",{className:"fileHoverCardRelatedFilesName_048e12ce"},o)),isCompact:!0})))})})})(e,t)}))}function ge(e){var t=e.itemKey,n=i.useContext(_),s=i.useRef(null),o=Object(i.useState)(!1),a=o[0],c=o[1],h=Object(i.useState)(!0),m=h[0],E=h[1],S=Object(i.useState)(!1),N=S[0],C=S[1],k=Object(i.useState)(!0),A=k[0],M=k[1],P=Object(i.useState)(!1),H=P[0],B=P[1],F=Object(i.useState)(!0),I=F[0],U=F[1],z=Object(i.useState)(!1),W=z[0],V=z[1],$=Object(i.useState)(!0),K=$[0],Q=$[1],G=Object(i.useState)(!1),Y=G[0],Z=G[1],ee=Object(i.useState)(!0),te=ee[0],ie=ee[1];i.useEffect(function(){s.current&&e.onCardExpand(s.current.clientHeight)});function se(e,t,r,i,s,o){i(!r);if(s){n.logData(e,t);o(!1)}}return i.createElement(u.e,null,function(n){var o=n.itemCache,u=(function(e,t){var n,r=e.demandItemFacet(f.n,t),i=r&&r.itemKey,s=e.demandItemFacet(l.h,i),o=e.demandItemFacet(l.p,i),u=e.demandItemFacet(l.o,i),a=e.demandItemFacet(l.e,i),c=e.demandItemFacet(l.s,i),h=e.demandItemFacet(l.u,i),p=e.demandItemFacet(g.C,y.e),d=e.demandItemFacet(f.d,t),v=a&&a.filter(function(e){return void 0!==e.access}),m=e.demandItemFacet(l.l,i),b=e.demandItemFacet(l.n,i);if(R()){var w=e.demandItemFacet(f.H,t),E=e.demandItemFacet(he.e,w&&w.itemKey);n=E&&E.itemKeys}return{analyticsKey:r,itemAnalyticsKey:i,viewCount:s,viewerCount:o,isTrending:u,activities:a,incompleteData:c,keyPointsData:h,loginUser:p,itemName:d,viewActivities:v,actions:m,conversations:b,relatedItemKeys:n}})(o,t),h=u.itemAnalyticsKey,S=u.viewCount,k=u.viewerCount,_=u.isTrending,P=u.incompleteData,F=u.keyPointsData,z=u.loginUser,$=u.itemName,G=u.viewActivities,ee=u.actions,pe=u.conversations,de=u.relatedItemKeys,ve=Object(X.r)(o,t,2,!0),ge=o.isItemFacetResolved(l.u,h)&&o.isItemFacetResolved(l.l,h)&&o.isItemFacetResolved(l.n,h)&&(!R()||o.isItemFacetResolved(f.H,t)),Ne=o.isItemFacetResolved(ue.e,h),Ce=ye(F),ke=$&&t&&be($.extension,ee),Le=we(pe),Ae=Ee(G),Oe=Se(de),Me={keyPoints:Ce,recommendedActions:!!ke,conversations:Le,viewers:!!Ae,relatedFiles:Oe};if(ge||Ne)return i.createElement("div",{ref:s,className:Object(b.e)("fileHoverCardExpandedCard_2526b7ce",{isFluent:!0})},!!(z&&t&&h)&&ve.map(function(e){return(function(e,t,n,s,o){var u,a=Object(r.__assign)({},v.e.pack(function(){return{itemKeys:[n]}})),c=o.demandItemFacet(ne.e,n),h=ne.e.evaluate(c)(o,{itemKey:n}),m=h.checkInAction,g=h.undoCheckOutAction,y=h.policyTipAction,b=h.addMetadataAction,w={checkIn:m,undoCheckOut:g,viewPolicyTip:y,addMetadata:b},E=o.demandItemFacet(l.r,s),S=o.demandItemFacet(l.i,s);if(E){var x=o.demandItem({displayName:f.h,email:ae.e,image:ae.r,id:ae.i},E.itemKey);u={email:x.email||"",displayName:x.displayName||"",image:x.image||"",id:x.id||""}}var T=o.demandItemFacet(re.e,n),N=re.e.evaluate(T)(o,{itemKey:n,signalData:e}).onRenderLifeCycleSignal,C=Object(le.n)(o).telemetry,k=Object(ce.n)(o,{itemKey:n,engagement:{isIntentional:!0}});return i.createElement(p.e,{controlHandlers:a},i.createElement(d.r,{actions:w},function(n){var s=n.actions,o=s.checkIn,a=s.undoCheckOut,f=s.viewPolicyTip,l=s.addMetadata;return i.createElement(J,{lifeCycleSignalData:e,createdBy:u,createdDateTime:S,loginUserEmail:t.userLoginName,userEmail:t.userEmail,onViewPolicyTip:function(){C(O.e).logData(Object(r.__assign)({name:"FileHoverCard.LifeCycle.ViewPolicyTip"},k));f&&f.execute()},onAddMetadataNow:function(){C(O.e).logData(Object(r.__assign)({name:"FileHoverCard.LifeCycle.AddMetadata"},k));l&&l.execute()},onCheckIn:o&&o.isAvailable?function(){C(O.e).logData(Object(r.__assign)({name:"FileHoverCard.LifeCycle.FileCheckIn"},k));o&&o.execute()}:void 0,onDiscardCheckOut:a&&a.isAvailable?function(){C(O.e).logData(Object(r.__assign)({name:"FileHoverCard.LifeCycle.DiscardCheckOut"},k));a&&a.execute()}:void 0,onRenderLifeCycleSignal:N})}))})(e,z,t,h,o)}),i.createElement("div",{className:"fileHoverCardExpandedCardScrollableSection_2526b7ce"},q()&&i.createElement("div",{className:"collapsedFileCardTooltip_2526b7ce"},i.createElement(T.e,{content:L.i},i.createElement(x.e,{iconName:"info"}))),!!(Ce&&F&&t)&&(q()?i.createElement("div",{className:"fileCardExpandSectionContainer_2526b7ce",style:{border:0}},i.createElement(fe.e,{className:"fileCardExpandSectionButton_2526b7ce",text:L.le,menuIconProps:{iconName:a?"ChevronUp":"ChevronDown"},onClick:function(){return se("FileHoverCard.KeyPointsExpanded",Me,a,c,m,E)}}),a&&xe(o,{keyPointsData:F,itemKey:t})):xe(o,{keyPointsData:F,itemKey:t})),ke&&h&&(q()?i.createElement("div",{className:"fileCardExpandSectionContainer_2526b7ce",style:Ce?{}:{border:0}},i.createElement(fe.e,{className:"fileCardExpandSectionButton_2526b7ce",text:L.D,menuIconProps:{iconName:N?"ChevronUp":"ChevronDown"},onClick:function(){return se("FileHoverCard.RecommendedActionsExpanded",Me,N,C,A,M)}}),N&&Te(o,{target:e.target,itemKey:t,itemAnalyticsKey:h})):Te(o,{target:e.target,itemKey:t,itemAnalyticsKey:h})),D.e.isFeatureEnabled(j)&&de&&Oe&&(q()?i.createElement("div",{className:"fileCardExpandSectionContainer_2526b7ce",style:Ce||Oe?{}:{border:0}},i.createElement(fe.e,{className:"fileCardExpandSectionButton_2526b7ce",text:L.P,menuIconProps:{iconName:Y?"ChevronUp":"ChevronDown"},onClick:function(){return se("FileHoverCard.RelatedFilesExpanded",Me,Y,Z,te,ie)}}),Y&&i.createElement(me,{relatedFilesKeys:de,itemKey:t})):i.createElement(me,{relatedFilesKeys:de,itemKey:t})),pe&&z&&Le&&(q()?i.createElement("div",{className:"fileCardExpandSectionContainer_2526b7ce",style:Ce||ke?{}:{border:0}},i.createElement(fe.e,{className:"fileCardExpandSectionButton_2526b7ce",text:L.o,menuIconProps:{iconName:H?"ChevronUp":"ChevronDown"},onClick:function(){return se("FileHoverCard.ConversationsExpanded",Me,H,B,I,U)}}),H&&i.createElement(oe,{conversations:pe,loginUserEmail:z.userLoginName,userEmail:z.userEmail})):i.createElement(oe,{conversations:pe,loginUserEmail:z.userLoginName,userEmail:z.userEmail})),!(!Ae||!z)&&(q()?i.createElement("div",{className:"fileCardExpandSectionContainer_2526b7ce",style:Ce||ke||Le?{}:{border:0}},i.createElement(fe.e,{className:"fileCardExpandSectionButton_2526b7ce",text:L.Ie,menuIconProps:{iconName:W?"ChevronUp":"ChevronDown"},onClick:function(){return se("FileHoverCard.ViewersExpanded",Me,W,V,K,Q)}}),W&&i.createElement("div",{className:"fileHoverCardActivitiesSection_2526b7ce",style:{borderTop:0}},i.createElement(w.e,{itemAnalytics:{activities:G||[],viewCount:S,viewerCount:k,isTrending:_,incompleteData:P},loginUserEmail:z.userLoginName,userEmail:z.userEmail}))):i.createElement("div",{className:"fileHoverCardActivitiesSection_2526b7ce"},i.createElement(w.e,{itemAnalytics:{activities:G||[],viewCount:S,viewerCount:k,isTrending:_,incompleteData:P},loginUserEmail:z.userLoginName,userEmail:z.userEmail})))))})}function ye(e){var t=e&&e.readTime&&e.readTime.minutes;return!!(e&&e.keyPoints&&e.keyPoints.length>0)||!!t}function be(e,t){return Boolean(t&&t.length>0)&&(function(e,t){var n=e||t;return!!n&&I.indexOf(n)>-1})(void 0,e)}function we(e){return Boolean(e&&e.length>0)}function Ee(e){return Boolean(e&&e.length>=1)}function Se(e){return Boolean(e&&e.length>0)}function xe(e,t){var n=t.keyPointsData,r=t.itemKey,s=e.demandItemFacet(ne.e,r),o=ne.e.evaluate(s)(e,{itemKey:r}),u={showKeyPoints:o.showKeyPointsPane,showFeedback:o.showFeedbackPane};return i.createElement(d.r,{actions:u},function(e){var t=e.actions,r=t.showKeyPoints,s=t.showFeedback,o=r&&r.isAvailable?r.execute:void 0,u=s&&s.isAvailable?s.execute:void 0;return i.createElement(U,{keyPointsData:n,onKeyPointsClick:o,onSendFeedbackClick:u})})}function Te(e,t){var n=t.target,r=t.itemKey,s=t.itemAnalyticsKey,o=e.demandItemFacet(l.l,s),u=[],a=e.demandItemFacet(f.O,r),c=e.demandItemFacet(l.e,s),v=e.demandItemFacet(g.C,y.e),b=c&&c.filter(function(e){return void 0!==e.edit}),w=e.demandItemFacet(ne.e,r),E=ne.e.evaluate(w)(e,{itemKey:r}).onDismiss;return i.createElement(p.e,{controlHandlers:m.e.pack(function(){return{defaultRecipients:u?u.map(function(e){return e.email}):[]}})},i.createElement(d.n,{action:i.createElement(h.ItemShareAction,{itemKeys:[r]})},function(e){var t=e.execute;return o&&E&&i.createElement(te,{actions:{recommendedActions:o,shareWith:u,editActivities:b},loginUserEmail:v&&v.userLoginName,userEmail:v&&v.userEmail,pageUrl:a,onDismiss:E,onShareWith:function(e,r){e.target=n;e.persist();t({event:e})}})}))}var Ne=n(1256),Ce=n(1105),ke=n(4581);function Le(e){var t=e.itemKey,n=i.useRef(null);i.useEffect(function(){n.current&&e.updateCardHeight(n.current.clientHeight)});return i.createElement(u.e,null,function(s){var o,u=s.itemCache,a=u.demandItemFacet(f.d,t),c=a&&a.name,m=a&&a.extension,g=u.demandItemFacet(f.n,t),y=g&&g.itemKey,w=i.createElement("div",{className:Object(b.e)("fileHoverCardCompactCardTitle_2526b7ce",(o={},o.titleNotExpanded_2526b7ce=!n.current,o)),id:"ms-FileHoverCard-title","aria-label":A.format(L.ue,c)},c),E=i.createElement("div",{className:"fileHoverCardCompactCardTitleRegion_2526b7ce"},i.createElement(Ce.e,{className:"fileHoverCardCompactCardFileIcon_2526b7ce",extension:m,size:32}),w);return i.createElement("div",{ref:n,className:Object(b.e)("fileHoverCardCompactCard_2526b7ce",{isFluent:!0})},E,!(!t||!y)&&(function(e,t,n,s){var o=e.demandItemFacet(l.h,n),u=e.demandItemFacet(l.p,n),a=e.demandItemFacet(l.f,n),c=e.demandItemFacet(l.t,n),m=e.demandItemFacet(f.O,t),g=e.demandItemFacet(l.e,n),y=g&&g.filter(function(e){return void 0!==e.access}),b=Object(le.n)(e).telemetry,w=Object(ce.n)(e,{itemKey:t,engagement:{isIntentional:!0}}),E=e.isItemFacetResolved(l.h,n)||e.isItemFacetResolved(ue.e,n)?{activities:y||[],viewCount:o,viewerCount:u,likeCount:a,commentCount:c}:void 0,S=e.demandItemFacet(ne.e,t),x=ne.e.evaluate(S)(e,{itemKey:t}),T=x.showDetailsPane,N=x.showFileAnalytics,C={showDetails:T,showItemAnalytics:N,shareAction:i.createElement(h.ItemShareAction,{itemKeys:[t]})},k=Object(r.__assign)({},v.e.pack(function(){return{itemKeys:[t]}}));return i.createElement(p.e,{controlHandlers:k},i.createElement(d.r,{actions:C},function(e){var n=e.actions,o=n.showDetails,u=n.showItemAnalytics,a=n.shareAction,f=o&&o.execute?function(){b(O.e).logData(Object(r.__assign)({name:"FileHoverCard.SeeDetailsClick"},w));o.execute().catch(function(){})}:void 0,l=u&&u.execute?function(){b(O.e).logData(Object(r.__assign)({name:"FileHoverCard.ViewCountClick"},w));u.execute().catch(function(){})}:void 0,c=a&&a.isAvailable?function(e){if(e&&s){e.target=s;e.persist();a.execute({event:e});b(O.e).logData(Object(r.__assign)({name:"FileHoverCard.CommandBar.ShareClick"},w))}}:void 0,h=Object(r.__spreadArrays)(o&&o.isAvailable?[{key:"details",title:L.Ne,name:L.Ne,ariaLabel:L.Ne,onClick:f}]:[]),p={key:"share",iconProps:{iconName:"share"},title:L.R,onClick:c},d={itemAnalytics:E,isCompact:!0,isLink:u&&u.isAvailable,pageUrl:m,onClick:l,itemKey:t},v=[];c&&v.push(p);D.e.isFeatureEnabled(H)&&Ne.e.action&&Ne.e.onClick&&v.unshift(Object(r.__assign)(Object(r.__assign)({},Ne.e),{iconOnly:!0,name:void 0}));return i.createElement(ke.e,{itemKey:t,analyticsStats:d,items:v,withFacePile:!0,farItems:h})}))})(u,t,y,e.target))})}var Ae=n(37),Oe=n(77),Me=n(1597),_e=n(490),De=n(41),Pe=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._dynamicCompactCardHeight=function(e){n.state.compactCardHeight!==e&&n.setState({compactCardHeight:e})};n._dynamicExpandedCardHeight=function(e){var t=n.state.expandedCardHeight;e&&t!==e&&n.setState({expandedCardHeight:e})};n.state={visible:!1,expandedCardHeight:1,compactCardHeight:131};n._isFirstTimeOpenCard=!0;return n}t.prototype.componentDidCatch=function(e,t){this._hoverCardRenderQos&&this._hoverCardRenderQos.end({error:e.name+"_"+e.message,extraData:{stack:e.stack,errorInfo:JSON.stringify(t)},resultCode:e.name,resultType:Ae.e.Failure})};t.prototype.render=function(){var e=this,t=this.props,n=t.itemKey,a=t.cardDismissDelay,f=void 0===a?300:a,h=t.directionalHint,p=void 0===h?o.e.rightTopEdge:h,d=t.gapSpace,v=void 0===d?8:d,m=t.target;if(!n||!m)return null;var g,y,b,w,E,S={expandedCardScroll:"fileHoverCardExpandedCardHostScroll_2526b7ce"},x=Object(r.__assign)({root:{boxShadow:Object(c._)().effects.elevation16,borderRadius:"2px",width:"320px",selectors:{".ms-Callout-main":{borderRadius:"2px"}}},expandedCard:[{selectors:{":before":{display:"none"}}}]},S),T=new M(this.props.telemetry(O.e));return i.createElement(u.e,null,function(t){var r=t.itemCache;if(e.state.visible){var o=e._demandFacets(r),u=o.itemAnalyticsKey,a=o.keyPointsData,c=o.itemName,h=o.recommendedActions,d=o.conversations,S=o.viewActivities,N=o.relatedItemKeys,C=r.isItemFacetResolved(l.h,u),k=r.isItemFacetResolved(ue.e,u),L=k?r.demandItemFacet(ue.e,u):void 0;e._errorMessage=L&&L.message;e._isViewCountDataError=k&&!C;g=ye(a);y=!!c&&be(c.extension,h);b=we(d);w=Ee(S);E=Se(N);if(r.demandItemFacet(ue.e,n,{suppressGetItems:!0}))return null}var A=Object(ce.n)(r,{itemKey:n,engagement:{isIntentional:!0}});T.engagementData=A;var O={onRenderCompactCard:function(){return i.createElement(Le,{itemKey:n,target:m,updateCardHeight:e._dynamicCompactCardHeight})},onRenderExpandedCard:function(){return i.createElement(ge,{itemKey:n,target:m,onCardExpand:function(t){return e._onCardExpand(t,A)}})},compactCardHeight:e.state.compactCardHeight,expandedCardHeight:e.state.expandedCardHeight,directionalHint:p,directionalHintFixed:!1,gapSpace:v,styles:x};return i.createElement(le.e,{withContext:{component:"FileHoverCard"}},i.createElement(_.Provider,{value:T},i.createElement(s.e,{expandingCardProps:O,cardDismissDelay:f,expandedCardOpenDelay:500,target:e.props.target,onCardVisible:function(){return e._onCardOpen(A)},onCardHide:function(){return e._onCardHide(A,g,y,b,w,E)},trapFocus:!0})))})};t.prototype._demandFacets=function(e){var t,n=e.demandItemFacet(f.n,this.props.itemKey),r=n&&n.itemKey,i=e.demandItemFacet(l.u,r),s=e.demandItemFacet(f.d,this.props.itemKey),o=e.demandItemFacet(l.l,r),u=e.demandItemFacet(l.n,r),a=e.demandItemFacet(l.e,r),c=a&&a.filter(function(e){return void 0!==e.access});if(R()){var h=e.demandItemFacet(f.H,this.props.itemKey),p=e.demandItemFacet(he.e,h&&h.itemKey);t=p&&p.itemKeys}return{analyticsKey:n,itemAnalyticsKey:r,keyPointsData:i,itemName:s,recommendedActions:o,conversations:u,activities:a,viewActivities:c,relatedItemKeys:t}};t.prototype._onCardOpen=function(e){var t=this,n=this.props.itemCacheDispatch;n(Object(Me.e)(function(e){return t._demandFacets(e)},{flushOperationQueue:!0}));n(Object(_e.e)());this.props.telemetry(O.e).logData(Object(r.__assign)({name:"FileHoverCard.CompactCardOpen"},e));this._cardOpenTimeStamp=Date.now();this.setState({visible:!0});this._isFirstTimeOpenCard&&(this._hoverCardRenderQos=new(this.props.telemetry(Oe.e))({name:"ItemScope_FileHoverCardRender"}))};t.prototype._onCardHide=function(e,t,n,i,s,o){var u=Date.now()-this._cardOpenTimeStamp,a=this.state.expandedCardHeight>1,f=a&&u>2500?"FileHoverCard.DwellTimeLong":"FileHoverCard.DwellTime";this.props.telemetry(O.e).logData(Object(r.__assign)(Object(r.__assign)({name:f},e),{extraData:Object(r.__assign)(Object(r.__assign)({},e.extraData),{time:u,compactCardOpen:1===this.state.expandedCardHeight,expandedCardOpen:a,keyPoints:t,recommendedActions:n,conversations:i,viewers:s,relatedFiles:o})}));if(this._isFirstTimeOpenCard){this._hoverCardRenderQos.end({resultType:Ae.e.Success});this._isFirstTimeOpenCard=!1}this.setState({visible:!1})};t.prototype._onCardExpand=function(e,t){this._dynamicExpandedCardHeight(e);if(!this._isCardExpanded&&e>1){this.props.telemetry(O.e).logData(Object(r.__assign)({name:"FileHoverCard.ExpandedCardOpen"},t));this._isCardExpanded=!0}if(this._isFirstTimeOpenCard){this._isViewCountDataError?this._hoverCardRenderQos.end({resultType:Ae.e.Failure,resultCode:"NoViewCount",error:this._errorMessage}):this._hoverCardRenderQos.end({resultType:Ae.e.Success});this._isFirstTimeOpenCard=!1}};t.defaultProps={itemKey:""};return t})(i.Component),He=Object(De.e)()(Object(le.r)()(Pe)),Be=Object(a.e)()(He)},5038:function(e,t,n){"use strict";n.d(t,"e",function(){return m});var r=n(0),i=n("react-lib"),s=n(2592),o=n(2202),u=n(39),a=n(1030),f=n(557),l=n(1657),c=n(1571),h=n(134),p=n(1673),d=n(16),v=n(3066),m=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._onClick=function(){n.setState({isContextualMenuVisible:!n.state.isContextualMenuVisible})};n._onDismiss=function(e){n.setState({isContextualMenuVisible:!1});e.stopPropagation();e.preventDefault()};n.state={isContextualMenuVisible:!1};return n}t.prototype.render=function(){var e=this.props,t=e.item,n=e.onRemoveItem,a=e.index,m=e.selected,g=this._convertIPersonToIPersonaProps(t),y="PickerPersonaId"+Math.floor(1e4*Math.random()),b=d.format(v.n,t.name);return i.createElement("div",{className:Object(u.e)("ms-PickerPersonaMenu-container",{"is-selected":!!m}),"data-selection-index":a,key:a,"data-is-focusable":!0,"aria-labelledby":y},i.createElement(p.e,{className:"ms-PickerPersona-item"},i.createElement("div",{className:"ms-PickerPersona-content"},i.createElement(s.e,Object(r.__assign)({id:y},g,{presence:o.t.none,size:o.n.small,secondaryText:this.props.menuTitle&&!this.props.menuItems?this.props.menuTitle:void 0,"aria-label":v.e}),this.props.menuTitle&&this.props.menuItems&&i.createElement("div",{className:"ms-sitePerm-ContextMenu"},i.createElement("div",{className:"ms-sitePerm-buttonArea",ref:this._resolveRef("_buttonTarget")},i.createElement("span",{className:"ms-sitePerm-linkText",onClick:this._onClick,"data-is-focusable":!0,role:"button","aria-haspopup":!0},this.props.menuTitle,i.createElement(f.e,{iconName:"ChevronDown",className:"ms-sitePermMenu-chevron"}))),this.state.isContextualMenuVisible&&i.createElement(c.e,{items:this.props.menuItems,isBeakVisible:!1,target:this._buttonTarget,directionalHint:h.e.bottomLeftEdge,onDismiss:this._onDismiss,gapSpace:0})))),i.createElement("div",{className:"ms-PickerItem-sideContent"},i.createElement(l.e,{onClick:n,iconProps:{iconName:"Cancel"},className:"ms-PickerItem-content",ariaLabel:b}))))};t.prototype._convertIPersonToIPersonaProps=function(e){return{text:e.name?e.name:"",imageUrl:e.image?e.image:"",tertiaryText:e.email?e.email:"",secondaryText:e.job?e.job:"",imageInitials:""}};return t})(a.e)}}]);