(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[561],{1993:function(e,t,n){"use strict";n.d(t,"u",function(){return i});n.d(t,"o",function(){return s});n.d(t,"s",function(){return o});n.d(t,"d",function(){return u});n.d(t,"c",function(){return a});n.d(t,"l",function(){return f});n.d(t,"r",function(){return l});n.d(t,"n",function(){return c});n.d(t,"i",function(){return h});n.d(t,"t",function(){return p});n.d(t,"p",function(){return d});n.d(t,"h",function(){return v});n.d(t,"f",function(){return m});n.d(t,"v",function(){return g});n.d(t,"a",function(){return y});n.d(t,"e",function(){return b});var r=n(36);function i(){return r.t.isActivated("ec0bac60-d625-4fce-8869-83e862963f2c")}function s(){return r.t.isActivated("c92e40dc-3388-4078-a457-9b15495593d2","8/12/2021","window event listener mem leak fix")}function o(){return r.t.isActivated("51a8f759-b128-40d0-b421-9ce4b0c17463","9/27/2021","Use error boundary for app bar callout")}function u(){return r.t.isActivated("05b7fa9c-b894-4890-baa4-8276069fb1a0","8/26/2021","error states on token fetch error")}function a(){return r.t.isActivated("bfe78ae3-ed54-4f77-b63b-e91d3ae8c0ff","11/17/2020","Only send data to parent if exists")}function f(){return r.t.isActivated("6d98e7d7-9872-469a-86fa-97ed77f8db33","9/23/2021","disable clicks on appbar global nav linkless header")}function l(){return r.t.isActivated("85f74448-45a0-4763-ab02-25799ac4dd4d","8/30/2021","enable create list button")}function c(){return r.t.isActivated("9bdd4af2-7e33-4677-ba61-0af00a414830","9/5/2021","enable create doc (word/excel/powerpoint/onenote) button")}function h(){return r.t.isActivated("BBE926AA-5F1F-46BB-AB13-3F4B316CB6E7","11/01/2021","enable create onenote button")}function p(){return r.t.isActivated("9c21d0b8-517c-441e-b485-214c11b4e84a","10/22/2021","appbar panel render() cleanup")}function d(){return r.t.isActivated("0195F261-6BBC-4FB9-B76A-0879F694C13F","11/10/2021","teams componentData variable init fix")}function v(){return r.t.isActivated("12CAD4FC-9A1B-4B23-BB68-29EA398076DB","11/18/2021","populate followed sites from recent")}function m(){return r.t.isActivated("5D01CC3F-3248-4A6E-8E7C-409700620DC2","12/01/2021","global nav header text overflow fix")}function g(){return r.t.isActivated("346D6308-19E9-4818-8115-BEEA8BF0F2B3","11/18/2021","use FirstPublishedDate in getNewsFeed response")}function y(){return r.t.isActivated("775798BB-FA1B-42F0-94C4-87DAF8C5D1D7","01/05/2022","use lang param and orderby in getNewsFeed request")}function b(){return r.t.isActivated("5643629B-9946-480C-8350-1A5F94F83451","01/06/2022","appbar data-interception off")}},2205:function(e,t,n){"use strict";n.d(t,"f",function(){return f});n.d(t,"e",function(){return l});n.d(t,"l",function(){return h});n.d(t,"h",function(){return p});n.d(t,"r",function(){return d});n.d(t,"o",function(){return v});n.d(t,"u",function(){return m});n.d(t,"t",function(){return g});n.d(t,"a",function(){return y});n.d(t,"s",function(){return b});n.d(t,"i",function(){return w});n.d(t,"c",function(){return E});n.d(t,"n",function(){return S});n.d(t,"v",function(){return T});n.d(t,"y",function(){return N});n.d(t,"m",function(){return C});n.d(t,"g",function(){return k});n.d(t,"S",function(){return L});n.d(t,"d",function(){return A});n.d(t,"b",function(){return O});n.d(t,"w",function(){return M});n.d(t,"p",function(){return _});n.d(t,"E",function(){return D});var r=n(1048),i=n(1993),s=n(50),o=n(148),u=n(556),a=n(120),f="_spAppBarNewsSitesCachedData",l="_spAppBarHomeClientContext",c=36e5,h=1*c,p=4*c,d=9e5,v=1*c,m=4*c,g=4*c,y="SPHomeWeb:news",b="SPHomeWeb:sites/feed",w="SPHomeWeb:sites/followed",E="SPHomeWeb:sites/recent",S=30,x=function(e){var t;switch(e){case"STS":t=s.t.teamSite;break;case"SPSPERS":t=s.t.mySite;break;case"GROUP":t=s.t.group;break;case"SITEPAGEPUBLISHING":t=s.t.sitePagePublishing;break;default:t=s.t.invalid}return t},T=function(e,t,n,r,s,o,u,a,f){if(e)return t({cachingStrategy:2,spHomeCachedItem:{cacheContext:null,cacheValue:""},spHomeClientContext:{Urls:[""],Token:{AccessToken:"",ExpiresOn:""}},returnStatistics:!0}).then(function(e){var t,s;if(e){if(i.c()||(null===(s=null===(t=e)||void 0===t?void 0:t.data)||void 0===s?void 0:s.Items)&&e.data.Items.length>0){f(e,r);return C(e.cacheStats.lastModified,n)?{data:a(e.data),stale:!1,date:e.cacheStats.lastModified}:{data:a(e.data),stale:!0,date:e.cacheStats.lastModified}}return{data:[],stale:!0,date:0}}return{data:[],stale:!0,date:0}});var l=o&&o.find(function(e){return e.Key===u}),c=null;l&&s?c=t({cachingStrategy:1,spHomeCachedItem:l.Value,spHomeClientContext:s,returnStatistics:!0,cacheTimeoutTime:n}):s&&s.Token&&(c=t({cachingStrategy:1,spHomeCachedItem:{cacheContext:null,cacheValue:""},spHomeClientContext:s,returnStatistics:!0,cacheTimeoutTime:n}));return c?c.then(function(e){var t,n;if(i.c()){f(e,r);return{data:a(e.data),stale:!1,date:Date.now()}}if((null===(n=null===(t=e)||void 0===t?void 0:t.data)||void 0===n?void 0:n.Items)&&e.data.Items.length>0){f(e,r);return{data:a(e.data),stale:!1,date:Date.now()}}return{data:[],stale:!0,date:0}}):Promise.resolve({data:[],stale:!0,date:0})},N=function(e,t){try{if(e){var n=JSON.parse(e);if(n)return t(n)}}catch(e){}},C=function(e,t){return Date.now()-e<=t},k=function(e){return function(t){1!==t.button&&2!==t.button||o.e.logData({name:e})}},L=function(e){return e.which===Object(u.t)(a.e.right)},A=function(e){return function(t){var n;if(t.which===a.e.enter){null===(n=document.getElementById(e))||void 0===n||n.click()}}},O=function(e){if(r.r()){var t=e.map(function(e){return{author:e.createdBy,description:e.description,publishDate:new Date(i.v()?e.createdDateTime:e.firstPublishedDate),title:e.title,url:e.webUrl,isAuthoritative:!1,site:{id:e.sharepointIds.siteId,serverRelativeUrl:e.parentReference.path,title:e.parentReference.siteTitle,webTemplateId:0},image:e.thumbnails[0].source.url}});return i.a()?t.sort(function(e,t){return t.publishDate.getTime()-e.publishDate.getTime()}):t}return e.Items.map(function(e){var t=e.Author,n=e.Description,r=e.ImageUrl,i=e.Title,s=e.IsAuthoritativeNews,o=e.OriginalUrl||e.Url,u=new Date(e.FirstPublishedDate),a=e.Site,f=a.ItemReference;return{author:t,description:n,isAuthoritative:s,publishDate:u,site:{id:f.WebId,siteCollectionId:f.SiteId,title:a.Title,isExternal:a.IsExternalContent,serverRelativeUrl:a.OriginalUrl||a.Url,icon:a.BannerImageUrl,color:a.BannerColor,acronym:a.Acronym,indexId:f.IndexId,itemReference:f,weight:a.Weight||0,pinOrder:a.PinOrder,webTemplateId:x(a.WebTemplate),WebTemplate:a.WebTemplate,allowPinning:!!f&&!!f.SiteId&&!!f.WebId},title:i,url:o,image:r}})},M=function(e){return e.Items.map(function(e){var t=e.ItemReference,n=t.WebId,r=t.SiteId,i=t.IndexId,s=e.Title,o=e.IsExternalContent,u=e.ItemReference,a=e.BannerImageUrl,f=e.BannerColor,l=e.Acronym,c=e.Weight,h=e.PinOrder,p=e.WebTemplate;return{id:n,siteCollectionId:r,title:s,isExternal:o,serverRelativeUrl:e.OriginalUrl||e.Url,icon:a,color:f,acronym:l,indexId:i,itemReference:u,weight:c||0,pinOrder:h,allowPinning:!!u&&!!u.SiteId&&!!u.WebId,webTemplateId:x(p),WebTemplate:p}})},_=function(e,t,n,r){var i=(r?t.filter(function(e){return e.serverRelativeUrl!==r}):t).slice(0,n);return[e.filter(function(e){return r?e.serverRelativeUrl!==r:i.reduce(function(t,n){return t&&n.serverRelativeUrl!==e.serverRelativeUrl},!0)}),i]};function D(e,t){var n,r;if(e&&t){if(e.name)this.componentData[t]=e;else{var i=this.componentData[t];if(null===(r=null===(n=i)||void 0===n?void 0:n.cacheStats)||void 0===r?void 0:r.lastModified){if(e.cacheStats.lastModified>i.cacheStats.lastModified)this.componentData[t]=e;else if(isNaN(e.cacheStats.lastModified)){e.cacheStats.lastModified=Date.now();this.componentData[t]=e}}else this.componentData[t]=e}}}},2447:function(e,t,n){"use strict";n.d(t,"t",function(){return r});n.d(t,"n",function(){return i});n.d(t,"e",function(){return s});var r=function(e,t){return e.replace("spappbarwebpack/spappbarwebpack.js","odsp-media/images/spappbar/"+t)},i=function(e,t){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var n=new RegExp(e+"=([^&]*)").exec(t);return null===n?"":decodeURIComponent(n[1].replace(/\+/g," "))},s=function(e,t,n){return e<768?"lists"===n?3:t?10:5:e<1024?"lists"===n?9:t?15:10:"lists"===n?14:t?20:15}},2870:function(e,t,n){"use strict";n.d(t,"e",function(){return o});var r=n(0),i=n(496),s=n(75),o=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,{dataSourceName:"SPHomeDataSource",id:"SPHomeDataSource"},{pageContext:t})||this;n.isMicroserviceToken=function(e){return!!e.access_token};n._isDataSourceParam=function(e){return!!e.spHomeClientContext};n._spHomeCacheKey="spHome_"+t.aadUserId;return n}t.prototype.getFrequentSites=function(e,t,n,r,i,s,o,u){void 0===n&&(n=!0);var a,f,l;if(this._isDataSourceParam(e)){var c=e;f=c.spHomeClientContext;t=c.spHomeCachedItem;s=c.returnStatistics;o=c.cachingStrategy;u=c.cacheTimeoutTime}else{f=e;o=0;r?o=3:i&&(o=2)}l=(null===(a=f)||void 0===a?void 0:a.Urls)&&f.Urls[0]?f.Urls[0]+"/api/v1/sites/feed?start=0&count=30&acronyms=true":"";return this.getSPHomeData({spHomeClientContext:f,spHomeSitesCachedData:t,url:l,qosName:"spAppBarGetFrequentSites",cacheRequestKey:this._spHomeCacheKey+"frequentSites",returnStatistics:!!s,cachingStrategy:o,cacheTimeoutTime:u})};t.prototype.getFollowedSites=function(e,t,n,r,i,s,o,u){void 0===n&&(n=!0);var a,f,l;if(this._isDataSourceParam(e)){var c=e;f=c.spHomeClientContext;t=c.spHomeCachedItem;s=c.returnStatistics;o=c.cachingStrategy;u=c.cacheTimeoutTime}else{f=e;o=0;r?o=3:i&&(o=2)}l=(null===(a=f)||void 0===a?void 0:a.Urls)&&f.Urls[0]?f.Urls[0]+"/api/v1/sites/followed?mostRecentFirst=true&start=0&count=30&fillSiteData=true&fillSiteCount=10":"";return this.getSPHomeData({spHomeClientContext:f,spHomeSitesCachedData:t,url:l,qosName:"spAppBarGetFollowedSites",cacheRequestKey:this._spHomeCacheKey+"followedSites",returnStatistics:!!s,cachingStrategy:o,cacheTimeoutTime:u})};t.prototype.getRecentSites=function(e,t,n,r,i,s,o,u){void 0===n&&(n=!0);var a,f,l;if(this._isDataSourceParam(e)){var c=e;f=c.spHomeClientContext;t=c.spHomeCachedItem;s=c.returnStatistics;o=c.cachingStrategy;u=c.cacheTimeoutTime}else{f=e;o=0;r?o=3:i&&(o=2)}l=(null===(a=f)||void 0===a?void 0:a.Urls)&&f.Urls[0]?f.Urls[0]+"/api/v1/sites/recent?mostRecentFirst=true&start=0&count=30&fillSiteData=true&fillSiteCount=10":"";return this.getSPHomeData({spHomeClientContext:f,spHomeSitesCachedData:t,url:l,qosName:"spAppBarGetRecentSites",cacheRequestKey:this._spHomeCacheKey+"recentSites",returnStatistics:!!s,cachingStrategy:o,cacheTimeoutTime:u})};t.prototype.getNews=function(e,t,n,r,i,s,o,u){void 0===n&&(n=!0);var a,f,l;if(this._isDataSourceParam(e)){var c=e;f=c.spHomeClientContext;t=c.spHomeCachedItem;s=c.returnStatistics;o=c.cachingStrategy;u=c.cacheTimeoutTime}else{f=e;o=0;r?o=3:i&&(o=2)}l=(null===(a=f)||void 0===a?void 0:a.Urls)&&f.Urls[0]?f.Urls[0]+"/api/v1/news?start=0&count=30":"";return this.getSPHomeData({spHomeClientContext:f,spHomeSitesCachedData:t,url:l,qosName:"spAppBarGetNews",cacheRequestKey:this._spHomeCacheKey+"news",returnStatistics:!!s,cachingStrategy:o,cacheTimeoutTime:u})};t.prototype.getHomeContext=function(){var e={url:this._pageContext.webAbsoluteUrl+"/_api/sphomeservice/context?$expand=Token,Payload",qosName:"spAppBarGetSPHomeToken",method:"GET",additionalHeaders:{accept:"application/json","SPHome-ClientType":"WebAppBar","Service-Worker-Navigation-Preload":"true"},cachingStrategy:3,cacheRequestKey:this._spHomeCacheKey+"token"};return this.getDataUtilizingPersistentCache(e)};t.prototype.shouldShowPostNewsTip=function(){return this.getDataUtilizingPersistentCache({url:this._pageContext.webAbsoluteUrl+"/_api/sitepages/pages/feed?promotedstate=2&published=true&$top=3",qosName:"GetFeedCount",method:"GET",cachingStrategy:3,parseResponse:function(e){var t,n,r;try{return(null===(r=null===(n=null===(t=JSON.parse(e))||void 0===t?void 0:t.d)||void 0===n?void 0:n.results)||void 0===r?void 0:r.length)<2}catch(e){return!0}}})};t.prototype.getSPHomeData=function(e){var t=e.cachingStrategy,n={url:e.url,qosName:e.qosName,method:"GET",additionalHeaders:{"sphome-apicontext":e.spHomeClientContext.Payload,"sphome-cachecontext":e.spHomeSitesCachedData.cacheContext,"sphome-clienttype":"WebAppBar"},cacheRequestKey:e.cacheRequestKey,cachingStrategy:t,returnStatistics:e.returnStatistics},r=e.spHomeClientContext.Token;r&&(this.isMicroserviceToken(r)?n.authToken=r.access_token:n.authToken=r.AccessToken);e.url&&0!==e.url.length||(n.getData=function(){return s.n.resolve()});e.cacheTimeoutTime&&(n.cacheTimeoutTime=e.cacheTimeoutTime);return this.getDataUtilizingPersistentCache(n)};return t})(i.e)},3082:function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n(0),i=n(496),s=n(328),o=n(36),u=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,{dataSourceName:"SharePointDataSource",id:"SharePointDataSource"},{pageContext:t})||this;n._isCachedResultWithStatistic=function(e){return!!e.cacheStats};n._parseResponse=function(e,t){var i,s=!1;if(n._isCachedResultWithStatistic(e)){i=e.data;s=!0}else i=e;var o=t(i);return s?Object(r.__assign)(Object(r.__assign)({},e),{data:o}):o};n._cacheKey="sharepointAppBar_"+t.aadUserId;n.pageContext=t;return n}t.prototype.canCreatePage=function(e){var t=this;return this.getDataUtilizingPersistentCache({getUrl:function(){return e.siteUrl+"/_api/sitepages/cancreatepage"},qosName:"spAppBarCanCreatePage",method:"GET",noRedirect:!0,cacheRequestKey:this._cacheKey+"_canCreatePage_"+e.siteCache,cachingStrategy:e.cachingStrategy,cacheTimeoutTime:e.cacheTimeoutTime,returnStatistics:e.returnStatistics}).then(function(e){return t._parseResponse(e,function(e){return!(!e||!e.d)&&e.d.CanCreatePage})})};t.prototype.canCreatePromotedPage=function(e){var t=this;return this.getDataUtilizingPersistentCache({getUrl:function(){return e.siteUrl+"/_api/sitepages/cancreatepromotedpage"},qosName:"spAppBarCanCreatePromotedPage",method:"GET",noRedirect:!0,cacheRequestKey:this._cacheKey+"_canCreatePromotedPage_"+e.siteCache,cachingStrategy:e.cachingStrategy,cacheTimeoutTime:e.cacheTimeoutTime,returnStatistics:e.returnStatistics}).then(function(e){return t._parseResponse(e,function(e){return!(!e||!e.d)&&e.d.CanCreatePromotedPage})})};t.prototype.getRecentLists=function(e){var t=this;return this.getDataUtilizingPersistentCache({url:this.pageContext.webAbsoluteUrl+"/_api/sp.RecentListProxy.GetRecentListsProxy/",qosName:"spAppBarGetRecentLists",method:"GET",noRedirect:!0,cacheRequestKey:this._cacheKey+"_getRecentLists",cachingStrategy:e.cachingStrategy,cacheTimeoutTime:e.cacheTimeoutTime,returnStatistics:e.returnStatistics}).then(function(e){return e?t._parseResponse(e,function(e){var t,n;return(null===(n=null===(t=e)||void 0===t?void 0:t.value)||void 0===n?void 0:n.length)>0?e.value.map(function(e){var t=e.color,n=e.icon,r=e.listId,i=e.listUrl,s=e.listTitle,o=e.siteId,u=e.siteTitle,a=e.siteUrl;return{listColor:Number(t),listIcon:Number(n),listId:r,listUrl:i,listTitle:s,siteId:o,siteTitle:u,siteUrl:a}}):[]}):[]})};t.prototype.getFavoriteLists=function(e){var t=this;return this.getDataUtilizingPersistentCache({url:this.pageContext.webAbsoluteUrl+"/_api/SP.FavoriteLists.GetListsBy",qosName:"spAppBarGetFavoriteLists",method:"GET",noRedirect:!0,cacheRequestKey:this._cacheKey+"_getFavoriteLists",cachingStrategy:e.cachingStrategy,cacheTimeoutTime:e.cacheTimeoutTime,returnStatistics:e.returnStatistics}).then(function(e){return e?t._parseResponse(e,function(e){var t,n,r,i;return(null===(i=null===(r=null===(n=null===(t=e)||void 0===t?void 0:t.d)||void 0===n?void 0:n.GetListsBy)||void 0===r?void 0:r.results)||void 0===i?void 0:i.length)>0?e.d.GetListsBy.results.map(function(e){var t=e.color,n=e.icon,r=e.listId,i=e.listUrl,s=e.title,o=e.siteId,u=e.siteTitle,a=e.siteUrl;return{listColor:Number(t),listIcon:Number(n),listId:r,listUrl:i,listTitle:s,siteId:o,siteTitle:u,siteUrl:a}}):[]}):[]}).catch(function(e){var t;if(e&&"-1, System.NotSupportedException"===(null===(t=e)||void 0===t?void 0:t.code))return[]})};t.prototype.getNewsFeed=function(e){var t=this,n=o.t.isActivated("775798BB-FA1B-42F0-94C4-87DAF8C5D1D7","01/05/2022","use lang param and orderby in getNewsFeed request")?this.pageContext.webAbsoluteUrl+"/_api/v2.1/getNewsFeed?section=SharePointNewsFeedTargeted&$expand=analytics($expand=allTime),thumbnails":this.pageContext.webAbsoluteUrl+"/_api/v2.1/getNewsFeed?section=SharePointNewsFeedTargeted&preferredLanguage="+s.e.language+"&$expand=analytics($expand=allTime),thumbnails&$orderby=FirstPublishedDate desc";return this.getDataUtilizingPersistentCache({url:n,additionalHeaders:{scenario:"SharePointAppBar"},qosName:"spAppBarGetNewsFeed",method:"GET",noRedirect:!0,cacheRequestKey:this._cacheKey+"_getNewsFeed",cachingStrategy:e.cachingStrategy,cacheTimeoutTime:e.cacheTimeoutTime,returnStatistics:e.returnStatistics}).then(function(e){return e?t._parseResponse(e,function(e){var t;return(null===(t=e)||void 0===t?void 0:t.value)?e.value:[]}):{value:[]}})};t.prototype.getMySiteUrl=function(e){var t=this;return this._pageContext.isAnonymousGuestUser||this._pageContext.isEmailAuthenticationGuestUser||this._pageContext.isExternalGuestUser?Promise.resolve(void 0):this.getDataUtilizingPersistentCache({url:this.pageContext.webAbsoluteUrl+"/_api/SP.Directory.DirectorySession/me?$select=mySite",qosName:"spAppBarGetMySiteUrl",method:"GET",noRedirect:!0,cacheRequestKey:this._cacheKey+"_getMySiteUrl",cachingStrategy:e.cachingStrategy,cacheTimeoutTime:e.cacheTimeoutTime,returnStatistics:e.returnStatistics}).then(function(e){if(e)return t._parseResponse(e,function(e){var t;return(null===(t=e)||void 0===t?void 0:t.d)?e.d.mySite&&e.d.mySite.replace(/\/$/,""):void 0})})};t.prototype.getDefaultDocumentLibraryName=function(e){var t=e.webAbsoluteUrl,n=e.authToken,i=e.cacheTimeoutTime,s=e.cachingStrategy;return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(e){return[2,this.getDataUtilizingPersistentCache({url:t+"/_api/web/DefaultDocumentLibrary/RootFolder/Name",authToken:n,method:"GET",qosName:"spAppBarGetDefaultDocumentLibrary",noRedirect:!0,parseResponse:function(e){return JSON.parse(e).d.Name},cachingStrategy:s,cacheRequestKey:this._cacheKey+"_getDefaultDocumentLibrary",cacheTimeoutTime:i})]})})};t.prototype.createDocumentAndGetEditLink=function(e){var t=e.apiUrl,n=e.authToken;return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,this.dataRequestor.getData({method:"POST",url:t,qosName:"spAppBarCreateDocumentAndGetEditLink",authToken:n,parseResponse:function(e){return JSON.parse(e)},noRedirect:!0})];case 1:return[2,e.sent()]}})})};return t})(i.e)},3886:function(e,t,n){"use strict";n.d(t,"e",function(){return o});var r=n(0),i=n(36),s=n(496),o=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,{dataSourceName:"RecentFilesGraphDataSource",id:"RecentFilesGraphDataSource"},{pageContext:t})||this;n._parseFilesResponse=function(e,t){var s,o,u,a;if(e){var f,l=!1;if(n._isCachedResultWithStatistic(e)){f=e.data;l=!0}else f=e;var c=null===(u=null===(o=null===(s=f)||void 0===s?void 0:s.data)||void 0===o?void 0:o.me)||void 0===u?void 0:u.recent;if(null!=c){if(!c||0===c.length)return t?{data:[],cacheStats:{lastModified:Date.now(),lastRead:Date.now(),reads:0}}:[];var h=null===(a=c=n._sortByAccessTime(c.filter(function(e){var t,n=e.remoteItem;return n.name&&(null===(t=n.sharepointIds)||void 0===t?void 0:t.siteUrl)&&(i.t.isActivated("7c90522e-4460-4492-9407-5e098008f98c","5/17/2021","switch to oneup view")?n.webUrl:n.webDavUrl)})))||void 0===a?void 0:a.slice(0,n._maxNumber).map(function(e){var t,n,s,o,u,a,f=e.remoteItem,l=null,c=f.name;if("oneNote"===(null===(t=f.package)||void 0===t?void 0:t.type)){u="one";a=c}else{var h=c.lastIndexOf(".");u=c.substr(h+1);a=c.substr(0,h)}var p=f.sharepointIds.siteUrl,d=document.createElement("a");d.href=f.webDavUrl;if("documentLibrary"===f.parentReference.driveType){var v=p.substr(p.lastIndexOf("/")+1);p=null===(n=f.webDavUrl)||void 0===n?void 0:n.substr(0,f.webDavUrl.lastIndexOf("/"));var m=d.pathname,g=m.substr(m.indexOf(v)+v.length+1),y=decodeURI(g).split("/");y.pop();l=y.length>=3?v+" > ... > "+y[y.length-1]:Object(r.__spreadArrays)([v],y).join(" > ")}else{var b=null===(o=null===(s=f.createdBy)||void 0===s?void 0:s.user)||void 0===o?void 0:o.displayName;l=b&&b.length>0?"OneDrive > "+b:"OneDrive > Documents"}return{name:a,url:i.t.isActivated("7c90522e-4460-4492-9407-5e098008f98c","5/17/2021","switch to oneup view")?f.webUrl:f.webDavUrl+"?web=1",path:l,extension:u,siteurl:p}});return l?Object(r.__assign)(Object(r.__assign)({},e),{data:h}):h}}};n._sortByAccessTime=function(e){if(!e||e.length<=1)return e;var t=e.length,n={},r=-1;n[t-1]=new Date(e[t-1].remoteItem.fileSystemInfo.lastAccessedDateTime);for(var i=t-2;i>=0;i--){var s=new Date(e[i].remoteItem.fileSystemInfo.lastAccessedDateTime);n[i]=s;s<n[i+1]&&i+1>r&&(r=i+1)}var o=function(t,n,r){if(t===n)return t;if(new Date(e[t].remoteItem.fileSystemInfo.lastAccessedDateTime)<r)return t;if(new Date(e[n].remoteItem.fileSystemInfo.lastAccessedDateTime)>r)return n+1;if(t===n-1)return n;var i=Math.floor((t+n)/2);return new Date(e[i].remoteItem.fileSystemInfo.lastAccessedDateTime)>r?u(i,n,r):u(t,i,r)},u=function(t,n,r){if(t===n)return t;if(t===n-1)return new Date(e[t].remoteItem.fileSystemInfo.lastAccessedDateTime)<r?t:new Date(e[n].remoteItem.fileSystemInfo.lastAccessedDateTime)>r?n+1:n;var i=Math.floor((t+n)/2);return new Date(e[i].remoteItem.fileSystemInfo.lastAccessedDateTime)>r?u(i,n,r):u(t,i,r)},a=[];for(i=0;i<r;i++)a.push(e.shift());for(i=0;i<a.length;i++){var f=o(0,t-r-1+i,new Date(a[i].remoteItem.fileSystemInfo.lastAccessedDateTime));e.splice(f,0,a[i])}return e};n._isCachedResultWithStatistic=function(e){return!!e.cacheStats};n._recentFilesGraphCacheKey="recentFiles_"+t.aadUserId;n.pageContext=t;return n}t.prototype.getRecentFiles=function(e){var t=this;this._maxNumber=e.maxItems;return this.getDataUtilizingPersistentCache({url:this.pageContext.webAbsoluteUrl+"/_api/v2.1/graphql",qosName:"RecentFilesGraph",method:"POST",contentType:"application/graphql",additionalPostData:"{ me { recent { remoteItem { name webUrl webDavUrl parentReference { driveType } package { type } sharepointIds { siteUrl } fileSystemInfo { lastAccessedDateTime } createdBy { user { displayName } } } } } }",cachingStrategy:e.cachingStrategy,cacheRequestKey:this._recentFilesGraphCacheKey+"recent",cacheTimeoutTime:e.cacheTimeoutTime?e.cacheTimeoutTime:864e5,returnStatistics:e.returnStatistics}).then(function(n){return t._parseFilesResponse(n,e.returnStatistics)})};return t})(s.e)},4946:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n("react-lib"),s=n(1993),o=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.state={hasError:!1};return n}t.getDerivedStateFromError=function(){return{hasError:!0}};t.prototype.componentDidCatch=function(e,t){this.props.onError(e,JSON.stringify(t))};t.prototype.render=function(){return this.state.hasError?i.createElement(i.Fragment,null):i.createElement(i.Fragment,null,this.props.children)};return t})(i.Component),u=n(1048),a=n(2205),f=n(2447),l=n(1598),c=n(3082),h=n(3886),p=n(2870),d=n(189),v=n(287),m=i.lazy(function(){return n.ee([489,"deferred.odsp-datasources","deferred.office-ui-fabric-react","ondemand.resx-ondemand"],4900)}),g=i.lazy(function(){return n.ee([490,"deferred.office-ui-fabric-react","ondemand.resx-ondemand"],4725)}),y=i.lazy(function(){return n.ee([491,"deferred.office-ui-fabric-react","ondemand.resx-ondemand"],4024)}),b=i.lazy(function(){return n.ee([492,"deferred.office-ui-fabric-react","ondemand.resx-ondemand"],4026)}),w=i.lazy(function(){return n.ee([493,"deferred.office-ui-fabric-react","ondemand.resx-ondemand"],3328)}),E=i.lazy(function(){return n.ee([494,"deferred.office-ui-fabric-react","ondemand.resx-ondemand"],4726)}),S=i.lazy(function(){return n.ee([495,"deferred.office-ui-fabric-react","ondemand.resx-ondemand"],4140)}),x=i.lazy(function(){return n.ee([496,"deferred.office-ui-fabric-react","ondemand.resx-ondemand"],4029)}),T=i.lazy(function(){return n.ee([497,"deferred.office-ui-fabric-react","ondemand.resx-ondemand"],3349)}),N=i.lazy(function(){return n.ee([499,"deferred.office-ui-fabric-react","ondemand.resx-ondemand"],4030)}),C=i.lazy(function(){return n.ee([500,"deferred.office-ui-fabric-react","ondemand.resx-ondemand"],3350)}),k=i.lazy(function(){return n.ee([498],4727)}),L=i.lazy(function(){return n.ee([501,"deferred.office-ui-fabric-react","ondemand.resx-ondemand"],4728)}),A=(function(e){Object(r.__extends)(t,e);function t(t){var r,i=e.call(this,t)||this;i.tokenRefreshTimer=0;i.tokenRefreshAsync=new d.e;i._eventListenerKSActivated=s.o();i._isTokenErrorKSActivated=s.d();i._isAppBarPanelRenderCleanupKSActivated=s.t();i._isMyListsFeatureEnabled=u.e();i._isNewNewsDataSourceFeatureEnabled=u.r();i.componentData={};i._initializeFileTypeIcons=function(){n.ee([617],1025).then(v.e).then(function(e){i.initializedIcons=!0;e.initializeFileTypeIcons()})};i._isTokenExpired=function(e){var t;return!(null===(t=e)||void 0===t?void 0:t.Token)||i._getExpirationTimeLeft(e.Token)<=0};i._getExpirationTimeLeft=function(e){return i.spHomeDataSource.isMicroserviceToken(e)?1e3*parseInt(e.expires_on,10)-Date.now():1e3*parseInt(e.ExpiresOn,10)-Date.now()};i._clearClientContext=function(){i._isTokenErrorKSActivated||i.state.clientContext||null===i.state.clientContext||i.setState({clientContext:null})};i._setTimeoutAndGetHomeContext=function(e){(i._isTokenErrorKSActivated||e>0)&&(i.tokenRefreshTimer=i.tokenRefreshAsync.setTimeout(function(){i.spHomeDataSource.getHomeContext().then(function(e){i._checkAndSetContext(e)}).catch(function(){i._clearClientContext()})},e))};i._checkAndSetContext=function(e,t){if(e.Token){var n=e.Token,r=i._getExpirationTimeLeft(n);if(r>=3e4){t||i.setState({clientContext:e});i._setTimeoutAndGetHomeContext(r-3e4)}}else i._clearClientContext()};i._shouldPrewarm=function(e){return!i.hasGottenFreshData&&("blank"===e.workload&&"blank"!==i.state.workload||"teams"===i.state.workload)};i._handleWorkloadMessages=function(e){if(e.origin===i.windowOrigin&&e.data&&e.data.type)if("spAppBarWorkload"===e.data.type){var t=Object(f.n)("workload",e.data.payload);i.setState({workload:t})}else if("setRTL"===e.data.type){var n=e.data.isRTL?"rtl":"ltr";document.documentElement.setAttribute("dir",n)}else"spAppBarWorkloadBlank"===e.data.type&&i.setState({workload:"blank"})};i._messageParentAppStarted=function(){window.postMessage({type:"spAppBarPanelStarted"},i.windowOrigin)};i._setUpAndPrewarm=function(e){i._fetchTokenIfExpired();i.hasGottenFreshData=!0;i.filesDataSource=new h.e(i.pageContext);i.globalnavDataSource=new l.e(i.pageContext);i.sharePointDataSource=new c.e(i.pageContext);i._prewarmDataClick(e)};i._fetchTokenIfExpired=function(){i._isTokenExpired(i.state.clientContext)&&i.spHomeDataSource.getHomeContext().then(function(e){i.tokenRefreshTimer&&i.tokenRefreshAsync.clearTimeout(i.tokenRefreshTimer);i._checkAndSetContext(e)}).catch(function(){i._clearClientContext()})};i._prewarmDataClick=function(e){n.ee([562],285).then(v.e).then(function(t){var n,r;if("files"!==e){t.logData({name:"SPAppBar.Files.DataClick"});i._getFilesNetwork()}if("globalnav"!==e&&(null===(n=i.pageContext.appBarParams)||void 0===n?void 0:n.isGlobalNavEnabled)&&(null===(r=i.pageContext.companyPortalReference)||void 0===r?void 0:r.SiteId)){t.logData({name:"SPAppBar.GlobalNav.DataClick"});i.globalnavDataSource.getGlobalNav(!1).catch()}if("news"!==e){t.logData({name:"SPAppBar.News.DataClick"});i._isNewNewsDataSourceFeatureEnabled?i.sharePointDataSource.getNewsFeed({cachingStrategy:0,cacheTimeoutTime:a.l,returnStatistics:!0}).then(function(e){i.receivedNewData(e,"news")}).catch():i._getSPHomeNetwork(i.spHomeDataSource.getNews.bind(i.spHomeDataSource),a.l,a.a,"news")}if("sites"!==e){t.logData({name:"SPAppBar.Frequent.DataClick"});i._getSPHomeNetwork(i.spHomeDataSource.getFrequentSites.bind(i.spHomeDataSource),a.h,a.s,"frequentSites");t.logData({name:"SPAppBar.Followed.DataClick"});i._getSPHomeNetwork(i.spHomeDataSource.getFollowedSites.bind(i.spHomeDataSource),a.h,a.i,"followedSites");t.logData({name:"SPAppBar.Recent.DataClick"});i._getSPHomeNetwork(i.spHomeDataSource.getRecentSites.bind(i.spHomeDataSource),a.h,a.c,"recentSites")}if("lists"!==e&&i._isMyListsFeatureEnabled){t.logData({name:"SPAppBar.Lists.Recent.DataClick"});i._getRecentListsNetwork();t.logData({name:"SPAppBar.Lists.Favorite.DataClick"});i._getFavoriteListsNetwork()}})};i._getFilesNetwork=function(){i.filesDataSource.getRecentFiles({cachingStrategy:1,returnStatistics:!0,maxItems:a.n}).then(function(e){i.receivedNewData(e,"files")}).catch()};i._getRecentListsNetwork=function(){i.sharePointDataSource.getRecentLists({cachingStrategy:0,cacheTimeoutTime:a.o,returnStatistics:!0}).then(function(e){i.receivedNewData(e,"recentLists")}).catch()};i._getFavoriteListsNetwork=function(){i.sharePointDataSource.getFavoriteLists({cachingStrategy:0,cacheTimeoutTime:a.o,returnStatistics:!0}).then(function(e){i.receivedNewData(e,"favoriteLists")}).catch()};i._getSPHomeNetwork=function(e,t,n,r){var s=i.state.cachedData&&i.state.cachedData.find(function(e){return e.Key===n}),o=null;s&&i.state.clientContext?o=e({cachingStrategy:1,spHomeCachedItem:s.Value,spHomeClientContext:i.state.clientContext,returnStatistics:!0,cacheTimeoutTime:t}):i.state.clientContext&&i.state.clientContext.Token&&(o=e({cachingStrategy:1,spHomeCachedItem:{cacheContext:null,cacheValue:""},spHomeClientContext:i.state.clientContext,returnStatistics:!0,cacheTimeoutTime:t}));if(o){switch(r){case"news":i.needsNewsData=!1;break;case"frequentSites":i.needsFrequentSitesData=!1;break;case"followedSites":i.needsFollowedSitesData=!1;break;case"recentSites":i.needsRecentSitesData=!1}o.then(function(e){i.receivedNewData(e,r)}).catch()}else switch(r){case"news":i.needsNewsData=!0;break;case"frequentSites":i.needsFrequentSitesData=!1;break;case"followedSites":i.needsFollowedSitesData=!1;break;case"recentSites":i.needsRecentSitesData=!1}};var o=Object(f.n)("workload",t.query);i.state={workload:o,cachedData:void 0,clientContext:void 0};i.pageContext=null!=(r=i.props.spPageContextInfo)?r:window._spPageContextInfo;i.windowOrigin=window.location.origin;i.spHomeDataSource=new p.e(i.pageContext);if(i._eventListenerKSActivated){window.addEventListener("message",i._handleWorkloadMessages.bind(i));i._messageParentAppStarted()}i.receivedNewData=a.E.bind(i);return i}t.prototype.componentDidUpdate=function(e,t){if(!t.clientContext&&this.state.clientContext){this.needsNewsData&&this._getSPHomeNetwork(this.spHomeDataSource.getNews.bind(this.spHomeDataSource),a.l,a.a,"news");this.needsFrequentSitesData&&this._getSPHomeNetwork(this.spHomeDataSource.getFrequentSites.bind(this.spHomeDataSource),a.h,a.s,"frequentSites");this.needsFollowedSitesData&&this._getSPHomeNetwork(this.spHomeDataSource.getFollowedSites.bind(this.spHomeDataSource),a.h,a.i,"followedSites");this.needsRecentSitesData&&this._getSPHomeNetwork(this.spHomeDataSource.getRecentSites.bind(this.spHomeDataSource),a.h,a.c,"recentSites")}this._fetchTokenIfExpired();this._shouldPrewarm(t)&&this._setUpAndPrewarm(this.state.workload)};t.prototype.componentDidMount=function(){if(!this._eventListenerKSActivated){window.addEventListener("message",this._handleWorkloadMessages);this._messageParentAppStarted()}"blank"!==this.state.workload&&this._setUpAndPrewarm(this.state.workload)};t.prototype.componentWillUnmount=function(){this._eventListenerKSActivated||window.removeEventListener("message",this._handleWorkloadMessages)};t.prototype.render=function(){var e=this;return this._isAppBarPanelRenderCleanupKSActivated?(function(){var t;switch(e.state.workload){case"globalnav":if(e.componentData.globalnav){var n=e.componentData.globalnav;t=i.createElement(i.Suspense,{fallback:i.createElement("div",null)},i.createElement(w,{rawNavData:n,useRouterNavigation:!1,pageContext:e.pageContext,onDismissAppBarPanel:e.props.onDismissAppBarPanel}))}else t=i.createElement(i.Suspense,{fallback:i.createElement("div",null)},i.createElement(b,{useRouterNavigation:!1,sendUpdatedDataToParent:e.receivedNewData,onDismissAppBarPanel:e.props.onDismissAppBarPanel,pageContext:e.pageContext}));break;case"sites":if(e.componentData.frequentSites&&e.componentData.followedSites&&e.componentData.recentSites){var r=e.componentData.frequentSites,s=e.componentData.followedSites,o=e.componentData.recentSites;if(Object(a.m)(r.cacheStats.lastModified,a.h)&&Object(a.m)(s.cacheStats.lastModified,a.h)&&Object(a.m)(o.cacheStats.lastModified,a.h)){t=i.createElement(i.Suspense,{fallback:i.createElement("div",null)},i.createElement(C,{frequentSites:Object(a.w)(r.data),followedSites:Object(a.w)(s.data),recentSites:Object(a.w)(o.data),useRouterNavigation:!1,hideFrequentSites:!1,onDismissAppBarPanel:e.props.onDismissAppBarPanel,pageContext:e.pageContext,countToRender:Object(f.e)(window.innerHeight,!1)}))}else t=i.createElement(i.Suspense,{fallback:i.createElement("div",null)},i.createElement(N,{useRouterNavigation:!1,sendUpdatedDataToParent:e.receivedNewData,clientContext:e.state.clientContext,cachedData:e.state.cachedData,onDismissAppBarPanel:e.props.onDismissAppBarPanel,pageContext:e.pageContext,countToRender:Object(f.e)(window.innerHeight,!1)}))}else t=i.createElement(i.Suspense,{fallback:i.createElement("div",null)},i.createElement(N,{useRouterNavigation:!1,sendUpdatedDataToParent:e.receivedNewData,clientContext:e.state.clientContext,cachedData:e.state.cachedData,onDismissAppBarPanel:e.props.onDismissAppBarPanel,pageContext:e.pageContext,countToRender:Object(f.e)(window.innerHeight,!1)}));break;case"news":if(e.componentData.news){var u=e.componentData.news;t=Object(a.m)(u.cacheStats.lastModified,a.l)?i.createElement(i.Suspense,{fallback:i.createElement("div",null)},i.createElement(T,{news:Object(a.b)(u.data),useRouterNavigation:!1,onDismissAppBarPanel:e.props.onDismissAppBarPanel,pageContext:e.pageContext,countToRender:Object(f.e)(window.innerHeight,!0)})):i.createElement(i.Suspense,{fallback:i.createElement("div",null)},i.createElement(x,{useRouterNavigation:!1,sendUpdatedDataToParent:e.receivedNewData,clientContext:e.state.clientContext,cachedData:e.state.cachedData,onDismissAppBarPanel:e.props.onDismissAppBarPanel,pageContext:e.pageContext,countToRender:Object(f.e)(window.innerHeight,!0)}))}else t=i.createElement(i.Suspense,{fallback:i.createElement("div",null)},i.createElement(x,{useRouterNavigation:!1,sendUpdatedDataToParent:e.receivedNewData,clientContext:e.state.clientContext,cachedData:e.state.cachedData,onDismissAppBarPanel:e.props.onDismissAppBarPanel,pageContext:e.pageContext,countToRender:Object(f.e)(window.innerHeight,!0)}));break;case"files":if(e.componentData.files){e.initializedIcons||e._initializeFileTypeIcons();var l=e.componentData.files;t=Object(a.m)(l.cacheStats.lastModified,a.r)?i.createElement(i.Suspense,{fallback:i.createElement("div",null)},i.createElement(y,{files:l.data,useRouterNavigation:!1,onDismissAppBarPanel:e.props.onDismissAppBarPanel,pageContext:e.pageContext,countToRender:Object(f.e)(window.innerHeight,!0)})):i.createElement(i.Suspense,{fallback:i.createElement("div",null)},i.createElement(g,{useRouterNavigation:!1,sendUpdatedDataToParent:e.receivedNewData,onDismissAppBarPanel:e.props.onDismissAppBarPanel,pageContext:e.pageContext,countToRender:Object(f.e)(window.innerHeight,!0)}))}else{e.initializedIcons||e._initializeFileTypeIcons();t=i.createElement(i.Suspense,{fallback:i.createElement("div",null)},i.createElement(g,{useRouterNavigation:!1,sendUpdatedDataToParent:e.receivedNewData,onDismissAppBarPanel:e.props.onDismissAppBarPanel,pageContext:e.pageContext,countToRender:Object(f.e)(window.innerHeight,!0)}))}break;case"teams":t=i.createElement(i.Suspense,{fallback:i.createElement("div",null)},i.createElement(L,{useRouterNavigation:!0,clientContext:e.state.clientContext,cachedData:e.state.cachedData,pageContext:e.pageContext}));break;case"create":e.initializedIcons||e._initializeFileTypeIcons();if(e.componentData.frequentSites&&e.componentData.followedSites){r=e.componentData.frequentSites,s=e.componentData.followedSites;t=i.createElement(i.Suspense,{fallback:i.createElement("div",null)},i.createElement(m,{clientContext:e.state.clientContext,pageContext:e.pageContext,useRouterNavigation:!1,onDismissAppBarPanel:e.props.onDismissAppBarPanel,frequentSites:Object(a.w)(r.data),followedSites:Object(a.w)(s.data),countToRender:Object(f.e)(window.innerHeight,!1)}))}else t=i.createElement(i.Suspense,{fallback:i.createElement("div",null)},i.createElement(m,{clientContext:e.state.clientContext,pageContext:e.pageContext,useRouterNavigation:!1,onDismissAppBarPanel:e.props.onDismissAppBarPanel}));break;case"lists":if(e.componentData.recentLists&&e.componentData.favoriteLists){var c=e.componentData.recentLists,h=e.componentData.favoriteLists;t=Object(a.m)(c.cacheStats.lastModified,a.o)&&Object(a.m)(h.cacheStats.lastModified,a.o)?i.createElement(i.Suspense,{fallback:i.createElement("div",null)},i.createElement(S,{recentLists:c.data,favoriteLists:h.data,useRouterNavigation:!1,onDismissAppBarPanel:e.props.onDismissAppBarPanel,pageContext:e.pageContext,countToRender:Object(f.e)(window.innerHeight,!1,"lists")})):i.createElement(i.Suspense,{fallback:i.createElement("div",null)},i.createElement(E,{useRouterNavigation:!1,sendUpdatedDataToParent:e.receivedNewData,clientContext:e.state.clientContext,cachedData:e.state.cachedData,onDismissAppBarPanel:e.props.onDismissAppBarPanel,pageContext:e.pageContext,countToRender:Object(f.e)(window.innerHeight,!1,"lists")}))}else t=i.createElement(i.Suspense,{fallback:i.createElement("div",null)},i.createElement(E,{useRouterNavigation:!1,sendUpdatedDataToParent:e.receivedNewData,clientContext:e.state.clientContext,cachedData:e.state.cachedData,onDismissAppBarPanel:e.props.onDismissAppBarPanel,pageContext:e.pageContext,countToRender:Object(f.e)(window.innerHeight,!1,"lists")}));break;case"blank":default:t=null}return t?i.createElement(i.Suspense,{fallback:i.createElement("div",null)},i.createElement(k,{content:t})):null})():(function(){var t=null,n={useRouterNavigation:!1,pageContext:e.pageContext,onDismissAppBarPanel:e.props.onDismissAppBarPanel},s=Object(r.__assign)(Object(r.__assign)({},n),{sendUpdatedDataToParent:e.receivedNewData,clientContext:e.state.clientContext,cachedData:e.state.cachedData});switch(e.state.workload){case"globalnav":t=e.componentData.globalnav?i.createElement(w,Object(r.__assign)({rawNavData:e.componentData.globalnav},n)):i.createElement(b,Object(r.__assign)({},s));break;case"sites":if(e.componentData.frequentSites&&e.componentData.followedSites&&e.componentData.recentSites){var o=e.componentData.frequentSites,u=e.componentData.followedSites,l=e.componentData.recentSites;if(Object(a.m)(o.cacheStats.lastModified,a.h)&&Object(a.m)(u.cacheStats.lastModified,a.h)){t=i.createElement(C,Object(r.__assign)({},n,{frequentSites:Object(a.w)(o.data),followedSites:Object(a.w)(u.data),recentSites:Object(a.w)(l.data),hideFrequentSites:!1,countToRender:Object(f.e)(window.innerHeight,!1)}))}else t=i.createElement(N,Object(r.__assign)({},s,{countToRender:Object(f.e)(window.innerHeight,!1)}))}else t=i.createElement(N,Object(r.__assign)({},s,{countToRender:Object(f.e)(window.innerHeight,!1)}));break;case"news":if(e.componentData.news){var c=e.componentData.news;t=Object(a.m)(c.cacheStats.lastModified,a.l)?i.createElement(T,Object(r.__assign)({},n,{news:Object(a.b)(c.data),countToRender:Object(f.e)(window.innerHeight,!0)})):i.createElement(x,Object(r.__assign)({},s,{countToRender:Object(f.e)(window.innerHeight,!0)}))}else t=i.createElement(x,Object(r.__assign)({},s,{countToRender:Object(f.e)(window.innerHeight,!0)}));break;case"files":if(e.componentData.files){e.initializedIcons||e._initializeFileTypeIcons();var h=e.componentData.files;t=Object(a.m)(h.cacheStats.lastModified,a.r)?i.createElement(y,Object(r.__assign)({},n,{files:h.data,countToRender:Object(f.e)(window.innerHeight,!0)})):i.createElement(g,Object(r.__assign)({},s,{countToRender:Object(f.e)(window.innerHeight,!0)}))}else{e.initializedIcons||e._initializeFileTypeIcons();t=i.createElement(g,Object(r.__assign)({},s,{countToRender:Object(f.e)(window.innerHeight,!0)}))}break;case"teams":t=i.createElement(L,{useRouterNavigation:!0,clientContext:e.state.clientContext,cachedData:e.state.cachedData,pageContext:e.pageContext});break;case"create":e.initializedIcons||e._initializeFileTypeIcons();if(e.componentData.frequentSites&&e.componentData.followedSites){o=e.componentData.frequentSites,u=e.componentData.followedSites;t=i.createElement(m,Object(r.__assign)({},n,{clientContext:e.state.clientContext,frequentSites:Object(a.w)(o.data),followedSites:Object(a.w)(u.data),countToRender:Object(f.e)(window.innerHeight,!1)}))}else t=i.createElement(m,Object(r.__assign)({},n,{clientContext:e.state.clientContext}));break;case"lists":if(e.componentData.recentLists&&e.componentData.favoriteLists){var p=e.componentData.recentLists,d=e.componentData.favoriteLists;t=Object(a.m)(p.cacheStats.lastModified,a.o)&&Object(a.m)(d.cacheStats.lastModified,a.o)?i.createElement(S,Object(r.__assign)({},n,{recentLists:p.data,favoriteLists:d.data,countToRender:Object(f.e)(window.innerHeight,!1,"lists")})):i.createElement(E,Object(r.__assign)({},s,{countToRender:Object(f.e)(window.innerHeight,!1,"lists")}))}else t=i.createElement(E,Object(r.__assign)({},s,{countToRender:Object(f.e)(window.innerHeight,!1,"lists")}));break;case"blank":default:t=null}return t?i.createElement(i.Suspense,{fallback:i.createElement("div",null)},i.createElement(k,{content:i.createElement(i.Suspense,{fallback:i.createElement("div",null)},t)})):i.createElement(i.Fragment,null)})()};return t})(i.PureComponent),O=n(37),M=n(77),_=n(1340),D=n(134),P=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._errorBoundaryKSActivated=s.s();n._onErrorBoundary=function(e,t){e&&n._qos.end({resultType:O.e.Failure,error:e.message,extraData:{errorInfo:t}})};n._handleEventFromAppBar=function(e){e.origin===window.location.origin&&e.data&&e.data.type&&("spAppBarWorkload"===e.data.type?e.data.payload!==n.state.appbarQueryString?n.setState({showAppBarCallout:!0,appbarQueryString:e.data.payload}):n.state.showAppBarCallout||(n.state.firstClose?n.setState({firstClose:!1}):n.setState({showAppBarCallout:!0,appbarQueryString:e.data.payload})):"CLOSE_CALLOUT"!==e.data.type&&"spAppBarCreateSite"!==e.data.type||n.state.showAppBarCallout&&n.setState({showAppBarCallout:!1}))};n._dismissAppBarPanel=function(e){var t;if(n.state.showAppBarCallout&&(!e||!e.target||"sp-appBar-link"!==e.target.className)){if("focus"===(null===(t=e)||void 0===t?void 0:t.type))return;n.setState({showAppBarCallout:!1});window.postMessage({type:"CLOSE_CALLOUT"},window.location.origin);window.postMessage({type:"spAppBarWorkloadBlank"},window.location.origin)}};window.addEventListener("message",n._handleEventFromAppBar);n.state={showAppBarCallout:!1,appbarQueryString:"/_layouts/15/spappbar.aspx?workload=blank",firstClose:!1};return n}t.prototype.componentDidMount=function(){this._qos=new M.e({name:"SPAppBar.Callout.Render"})};t.prototype.render=function(){var e,t=null===(e=document.getElementById("sp-appBar"))||void 0===e?void 0:e.classList.contains("sp-appBar-mobile"),n={root:{height:"100%",display:"flex",flexDirection:"column",minWidth:t?"100vw":"320px",maxWidth:t?"unset":"320px",borderRadius:0,boxShadow:"10px 5.4px 14.4px -10px rgb(0 0 0 / 13%), 10px 0.2px 3.6px -10px rgb(0 0 0 / 11%)",animation:"none",bottom:"0px !important"},container:{height:"100%",zIndex:10},calloutMain:{display:"flex",flexDirection:"column",height:"100%",borderRadius:0},beak:{height:"97%"},beakCurtain:{height:"96%"}},r=i.createElement(_.e,{className:"spappbar-callout",id:"sp-appBar-callout",gapSpace:0,target:".sp-appBar",isBeakVisible:!1,directionalHint:D.e.topCenter,setInitialFocus:!0,styles:n,doNotLayer:!0,minPagePadding:-1,hidden:!this.state.showAppBarCallout,onDismiss:this._dismissAppBarPanel,shouldUpdateWhenHidden:!0,dismissOnTargetClick:!0},i.createElement(A,{query:this.state.appbarQueryString,onDismissAppBarPanel:this._dismissAppBarPanel,spPageContextInfo:this.props.spPageContextInfo}));return this._errorBoundaryKSActivated?r:i.createElement(o,{onError:this._onErrorBoundary},r)};return t})(i.Component);t.default=P}}]);